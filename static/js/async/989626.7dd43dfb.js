"use strict";(self.webpackChunk_flowgram_ai_docs=self.webpackChunk_flowgram_ai_docs||[]).push([["989626"],{92430:function(s,n,e){e.r(n),e.d(n,{default:()=>a});var r=e(110239),o=e(437562),i=e(420188);function l(s){let n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",span:"span",strong:"strong",ul:"ul",...(0,o.a)(),...s.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.h1,{id:"flowgramaifree-stack-plugin",children:[(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#flowgramaifree-stack-plugin",children:"#"}),"@flowgram.ai/free-stack-plugin"]}),"\n",(0,r.jsx)(n.p,{children:"层级管理插件，为自由布局画布提供节点和连线的 z-index 层级控制功能。"}),"\n",(0,r.jsxs)(n.h2,{id:"功能",children:[(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#功能",children:"#"}),"功能"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"智能计算节点和连线的层级关系，避免遮挡问题"}),"\n",(0,r.jsx)(n.li,{children:"支持选中节点自动置顶显示"}),"\n",(0,r.jsx)(n.li,{children:"支持悬停节点和连线的高亮显示"}),"\n",(0,r.jsx)(n.li,{children:"可自定义节点排序规则，控制同层级节点的渲染顺序"}),"\n",(0,r.jsx)(n.li,{children:"自动处理父子节点的层级关系"}),"\n",(0,r.jsx)(n.li,{children:"支持连线的智能层级管理，确保连线可见性"}),"\n",(0,r.jsx)(n.li,{children:"实时响应节点选择、悬停和实体变化事件"}),"\n"]}),"\n",(0,r.jsxs)(n.h2,{id:"快速开始",children:[(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#快速开始",children:"#"}),"快速开始"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"安装"}),"\n"]}),"\n",(0,r.jsx)(i.SU,{command:"install @flowgram.ai/free-stack-plugin"}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"注册插件"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"插件的注册方法和 flowgram 的其他插件基本相同，只需要保证不要重复创建以及最终传入到对应的 FreeLayoutEditorProvider 即可"}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables has-highlighted",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",children:(0,r.jsxs)(n.code,{className:"language-tsx",children:[(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" { createFreeStackPlugin } "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:" '@flowgram.ai/free-stack-plugin'"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" editorProps"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" useMemo"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(() "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" ({"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"  plugins"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" () "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" ["})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"    createFreeStackPlugin"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"()"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"  ]"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"})"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" []);"})]}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" ("})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"  <"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"FreeLayoutEditorProvider"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"..."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"editorProps}>"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    <"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"EditorRenderer"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" />"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"  </"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"FreeLayoutEditorProvider"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:">"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:")"})})]})})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:"自定义节点排序"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["可以通过 ",(0,r.jsx)(n.code,{children:"sortNodes"})," 函数自定义同层级节点的排序规则："]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables has-highlighted",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",children:(0,r.jsxs)(n.code,{className:"language-tsx",children:[(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" { createFreeStackPlugin } "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:" '@flowgram.ai/free-stack-plugin'"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" { WorkflowNodeType } "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:" './nodes/constants'"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" editorProps"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" useMemo"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(() "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" ({"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"  plugins"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" () "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" ["})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"    createFreeStackPlugin"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"({"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"      sortNodes"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" (nodes) "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"        const"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" commentNodes"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" [];"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"        const"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" otherNodes"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" [];"})]}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"        // 将注释节点和其他节点分开"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"        nodes"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".forEach"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"((node) "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"          if"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" ("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"node"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:".flowNodeType "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"==="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" WorkflowNodeType"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:".Comment) {"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"            commentNodes"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".push"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(node);"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"          } "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"else"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"            otherNodes"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".push"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(node);"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"          }"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"        });"})}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"        // 注释节点渲染在底层，其他节点在上层"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"        return"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" ["}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"..."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"commentNodes"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ..."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"otherNodes];"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"      }"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    })"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"  ]"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"})"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" []);"})]})]})})}),"\n",(0,r.jsxs)(n.h2,{id:"配置选项",children:[(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#配置选项",children:"#"}),"配置选项"]}),"\n",(0,r.jsxs)(n.h3,{id:"freestackpluginoptions",children:[(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#freestackpluginoptions",children:"#"}),"FreeStackPluginOptions"]}),"\n",(0,r.jsx)(n.p,{children:"插件的配置选项："}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables has-highlighted",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",children:(0,r.jsxs)(n.code,{className:"language-typescript",children:[(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"interface"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" FreeStackPluginOptions"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"  /** 自定义节点排序函数 */"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"  sortNodes"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" (nodes"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" WorkflowNodeEntity"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"[]) "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" WorkflowNodeEntity"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"[];"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"}"})})]})})}),"\n",(0,r.jsxs)(n.h3,{id:"sortnodes-函数",children:[(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#sortnodes-函数",children:"#"}),"sortNodes 函数"]}),"\n",(0,r.jsx)(n.p,{children:"用于自定义同层级节点的排序规则："}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables has-highlighted",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",children:(0,r.jsx)(n.code,{className:"language-typescript",children:(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"type"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" SortNodesFunction"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" (nodes"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" WorkflowNodeEntity"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"[]) "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" WorkflowNodeEntity"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"[];"})]})})})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"参数说明："})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"nodes"}),": 需要排序的节点数组"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"返回值"}),": 排序后的节点数组"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"使用场景："})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"将特定类型的节点（如注释）放在底层"}),"\n",(0,r.jsx)(n.li,{children:"按照业务优先级排序节点"}),"\n",(0,r.jsx)(n.li,{children:"按照创建时间或其他属性排序"}),"\n"]}),"\n",(0,r.jsxs)(n.h2,{id:"层级管理算法",children:[(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#层级管理算法",children:"#"}),"层级管理算法"]}),"\n",(0,r.jsxs)(n.h3,{id:"基础层级计算",children:[(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#基础层级计算",children:"#"}),"基础层级计算"]}),"\n",(0,r.jsx)(n.p,{children:"插件使用智能算法计算每个节点和连线的层级："}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"基础层级"}),"：从 ",(0,r.jsx)(n.code,{children:"BASE_Z_INDEX"}),"（默认为 8）开始计算"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"节点层级"}),"：根据节点的嵌套关系和排序规则计算"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"连线层级"}),"：确保连线不被节点遮挡，同时处理特殊情况"]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"层级提升规则",children:[(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#层级提升规则",children:"#"}),"层级提升规则"]}),"\n",(0,r.jsx)(n.p,{children:"以下情况会触发层级提升："}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"选中节点"}),"：选中的节点会被提升到顶层"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"悬停元素"}),"：悬停的节点或连线会被高亮显示"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"正在绘制的连线"}),"：绘制中的连线会置于顶层"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"父子关系连线"}),"：父子节点间的连线会优先显示"]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"层级计算流程",children:[(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#层级计算流程",children:"#"}),"层级计算流程"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"初始化"}),"：清除缓存，计算基础参数"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"节点索引"}),"：建立节点索引映射"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"选中节点处理"}),"：标记选中节点的父级关系"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"层级分配"}),"：递归处理节点层级"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"连线处理"}),"：计算连线层级，确保可见性"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"样式应用"}),"：将计算结果应用到 DOM 元素"]}),"\n"]}),"\n",(0,r.jsxs)(n.h2,{id:"高级用法",children:[(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#高级用法",children:"#"}),"高级用法"]}),"\n",(0,r.jsxs)(n.h3,{id:"复杂排序规则",children:[(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#复杂排序规则",children:"#"}),"复杂排序规则"]}),"\n",(0,r.jsx)(n.p,{children:"可以实现复杂的节点排序逻辑："}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables has-highlighted",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",children:(0,r.jsxs)(n.code,{className:"language-typescript",children:[(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" sortNodes"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" (nodes"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" WorkflowNodeEntity"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"[]) "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"  return"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" nodes"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".sort"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"((a"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" b) "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    // 1. 按节点类型优先级排序"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"    const"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" typeOrder"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"      ["}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"WorkflowNodeType"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:".Comment]"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" 0"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"      ["}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"WorkflowNodeType"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:".Start]"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" 1"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"      ["}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"WorkflowNodeType"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:".End]"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" 2"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"      // ... 其他类型"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    };"})}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"    const"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" aOrder"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" typeOrder["}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"a"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:".flowNodeType] "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"??"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" 999"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"    const"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" bOrder"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" typeOrder["}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"b"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:".flowNodeType] "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"??"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" 999"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"    if"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" (aOrder "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"!=="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" bOrder) {"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"      return"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" aOrder "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" bOrder;"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    }"})}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    // 2. 按创建时间排序"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"    return"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" a"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:".createTime "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" b"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:".createTime;"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"  });"})}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"};"})})]})})}),"\n",(0,r.jsxs)(n.h2,{id:"常见问题",children:[(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#常见问题",children:"#"}),"常见问题"]}),"\n",(0,r.jsxs)(n.h3,{id:"q-如何让特定类型的节点始终在底层",children:[(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#q-如何让特定类型的节点始终在底层",children:"#"}),"Q: 如何让特定类型的节点始终在底层？"]}),"\n",(0,r.jsxs)(n.p,{children:["A: 通过 ",(0,r.jsx)(n.code,{children:"sortNodes"})," 函数将这些节点排在数组前面："]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.pre,{className:"shiki css-variables has-highlighted",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",children:(0,r.jsxs)(n.code,{className:"language-typescript",children:[(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" sortNodes"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" (nodes) "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"  const"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" backgroundNodes"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" nodes"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".filter"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(node "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"    node"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:".flowNodeType "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"==="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" WorkflowNodeType"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:".Comment"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"  );"})}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"  const"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" foregroundNodes"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" nodes"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".filter"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(node "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"})]}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"    node"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:".flowNodeType "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"!=="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" WorkflowNodeType"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:".Comment"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"  );"})}),"\n",(0,r.jsx)(n.span,{className:"line"}),"\n",(0,r.jsxs)(n.span,{className:"line",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"  return"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" ["}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"..."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"backgroundNodes"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ..."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"foregroundNodes];"})]}),"\n",(0,r.jsx)(n.span,{className:"line",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"};"})})]})})}),"\n",(0,r.jsxs)(n.h3,{id:"q-如何禁用自动层级管理",children:[(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#q-如何禁用自动层级管理",children:"#"}),"Q: 如何禁用自动层级管理？"]}),"\n",(0,r.jsx)(n.p,{children:"A: 目前插件没有提供禁用选项，如果需要完全自定义层级管理，建议不使用此插件，直接在节点组件中设置 z-index。"}),"\n",(0,r.jsxs)(n.h3,{id:"q-性能优化建议",children:[(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#q-性能优化建议",children:"#"}),"Q: 性能优化建议？"]}),"\n",(0,r.jsx)(n.p,{children:"A: 插件已经内置了性能优化："}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"使用防抖机制减少计算频率"}),"\n",(0,r.jsx)(n.li,{children:"只在必要时重新计算层级"}),"\n",(0,r.jsx)(n.li,{children:"使用 Map 数据结构提高查找效率"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"对于大型画布（超过 1000 个节点），建议："}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["简化 ",(0,r.jsx)(n.code,{children:"sortNodes"})," 函数的逻辑"]}),"\n",(0,r.jsx)(n.li,{children:"避免在排序函数中进行复杂计算"}),"\n"]})]})}function a(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}={...(0,o.a)(),...s.components};return n?(0,r.jsx)(n,{...s,children:(0,r.jsx)(l,{...s})}):l(s)}a.__RSPRESS_PAGE_META={},a.__RSPRESS_PAGE_META["zh%2Fguide%2Fplugin%2Ffree-stack-plugin.mdx"]={toc:[{id:"功能",text:"功能",depth:2},{id:"快速开始",text:"快速开始",depth:2},{id:"配置选项",text:"配置选项",depth:2},{id:"freestackpluginoptions",text:"FreeStackPluginOptions",depth:3},{id:"sortnodes-函数",text:"sortNodes 函数",depth:3},{id:"层级管理算法",text:"层级管理算法",depth:2},{id:"基础层级计算",text:"基础层级计算",depth:3},{id:"层级提升规则",text:"层级提升规则",depth:3},{id:"层级计算流程",text:"层级计算流程",depth:3},{id:"高级用法",text:"高级用法",depth:2},{id:"复杂排序规则",text:"复杂排序规则",depth:3},{id:"常见问题",text:"常见问题",depth:2},{id:"q-如何让特定类型的节点始终在底层",text:"Q: 如何让特定类型的节点始终在底层？",depth:3},{id:"q-如何禁用自动层级管理",text:"Q: 如何禁用自动层级管理？",depth:3},{id:"q-性能优化建议",text:"Q: 性能优化建议？",depth:3}],title:"@flowgram.ai/free-stack-plugin",headingTitle:"@flowgram.ai/free-stack-plugin",frontmatter:{}}}}]);