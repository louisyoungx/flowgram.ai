"use strict";(self.webpackChunk_flowgram_ai_docs=self.webpackChunk_flowgram_ai_docs||[]).push([["572521"],{916530:function(e,t,n){n.d(t,{f3M:()=>r.f3M,Dcz:()=>r.Dcz,qRT:()=>r.qRT,QUv:()=>r.QUv,fin:()=>r.fin,xFV:()=>r.xFV,Vro:()=>eJ,R6T:()=>r.R6T,kDE:()=>r.kDE,GAy:()=>r.GAy,pQ4:()=>r.pQ4,EU3:()=>r.EU3,eGM:()=>r.eGM,XDS:()=>r.XDS,gNt:()=>r.gNt,C$T:()=>r.C$T,rQR:()=>r.rQR,Rf1:()=>r.Rf1,OTb:()=>r.OTb,G2Z:()=>r.G2Z,g5f:()=>eq,M1y:()=>r.M1y,PVB:()=>eW,XM6:()=>eF,z2R:()=>r.z2R,SyX:()=>r.SyX,HoL:()=>r.HoL,sX$:()=>e2,cmt:()=>ey,Odm:()=>r.Odm,JAk:()=>r.JAk,LzJ:()=>r.LzJ,XPE:()=>r.XPE,XQj:()=>r.XQj,cc3:()=>r.cc3,b2C:()=>r.b2C,oC4:()=>r.oC4,mh4:()=>r.mh4,gw0:()=>r.gw0,erw:()=>e0}),n(543789);var o,i,r=n(950454),l=n(9163),d=n(438024),a=n(579962),s=n(893740),u=n(832176);let p=function(e,t){for(var n,o=-1,i=e.length;++o<i;){var r=t(e[o]);void 0!==r&&(n=void 0===n?r:n+r)}return n};var y=0/0;let c=function(e,t){var n=null==e?0:e.length;return n?p(e,t)/n:y};var g=n(299367);let h=function(e){return c(e,g.Z)};var f=Object.defineProperty,L=Object.getOwnPropertyDescriptor,N={type:a.Sy.END,meta:{draggable:!1,isNodeEnd:!0,selectable:!1,copyDisable:!0},getLines:()=>[],getLabels:()=>[]},I={type:a.OT.DYNAMIC_SPLIT,meta:{hidden:!0,inlineSpacingAfter:e=>e.collapsed&&e.entity.collapsedChildren.length>1?21:0,spacing:e=>{let t=(0,a.yI)(e.entity,a.cc.NODE_SPACING);return 1===e.children.length?t:t/2}},getLabels:e=>e.isNodeEnd?[]:[{type:a.nx.ADDER_LABEL,offset:e.transform.outputPoint}],onCreate:(e,t)=>e.document.addInlineBlocks(e,t.blocks||[]),getInputPoint(e){var t;return(null==(t=e.firstChild)?void 0:t.inputPoint)||e.defaultInputPoint},getOutputPoint(e,t){var n;let o=a.XP.isVertical(t),i=1===e.children.length,r=null==(n=e.lastChild)?void 0:n.outputPoint,l=(0,a.yI)(e.entity,a.cc.NODE_SPACING);return o?{x:r?r.x:e.bounds.center.x,y:e.bounds.bottom+(i?l/2:0)}:{x:e.bounds.right+(i?l/2:0),y:r?r.y:e.bounds.center.y}},addChild(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{index:o}=n,i=e.document,r=`$inlineBlocks$${e.id}`,l=i.getNode(r);return l||(l=i.addNode({id:r,type:"inlineBlocks",originParent:e,parent:e})),i.addBlock(e,t,void 0,void 0,o)}},C={extend:a.OT.DYNAMIC_SPLIT,type:a.OT.STATIC_SPLIT,extendChildRegistries:[{type:a.Sy.INLINE_BLOCKS,getLabels:()=>[]}]},v={type:a.Sy.BLOCK,meta:{spacing:a.Lu.NULL,inlineSpacingAfter:a.Lu.INLINE_BLOCK_PADDING_BOTTOM,hidden:!0},getLines(e){let t=e.transform,{isVertical:n}=e.entity,o=[{type:a.IG.DIVERGE_LINE,from:t.parent.inputPoint,to:t.inputPoint,side:a.VH.NORMAL_BRANCH}];if(t&&t.entity.isInlineBlock&&e.renderData.draggable){var i,r,l,d,s,u,p,y,c,g;if(n){let e=t.firstChild?t.firstChild.bounds.right:t.bounds.right,n=((null==(i=t.next)?void 0:i.firstChild)?null==(l=t.next)||null==(r=l.firstChild.bounds)?void 0:r.left:null==(s=t.next)||null==(d=s.bounds)?void 0:d.left)||0,u=t.inputPoint.y;(null==t?void 0:t.next)&&o.push({type:a.IG.DRAGGING_LINE,from:t.parent.inputPoint,to:{x:(e+n)/2,y:u},side:a.VH.NORMAL_BRANCH})}else{let e=t.firstChild?t.firstChild.bounds.bottom:t.bounds.bottom,n=((null==(u=t.next)?void 0:u.firstChild)?null==(y=t.next)||null==(p=y.firstChild.bounds)?void 0:p.top:null==(g=t.next)||null==(c=g.bounds)?void 0:c.top)||0,i=t.inputPoint.x;(null==t?void 0:t.next)&&o.push({type:a.IG.DRAGGING_LINE,from:t.parent.inputPoint,to:{x:i,y:(e+n)/2},side:a.VH.NORMAL_BRANCH})}}return e.isNodeEnd||o.push({type:a.IG.MERGE_LINE,from:t.outputPoint,to:t.parent.outputPoint,side:a.VH.NORMAL_BRANCH}),o},getInputPoint(e){let t=e.firstChild;return t?t.inputPoint:e.defaultInputPoint},getOutputPoint(e,t){let n=a.XP.isVertical(t),o=e.lastChild;return n?{x:o?o.outputPoint.x:e.bounds.bottomCenter.x,y:e.bounds.bottom}:{x:e.bounds.right,y:o?o.outputPoint.y:e.bounds.rightCenter.y}},getLabels(e){let t=e.transform,{isVertical:n}=e.entity,o=[];if(t&&t.entity.isInlineBlock&&e.renderData.draggable){var i,r,l,d,s,u,p,y;if(n){let e=t.firstChild?t.firstChild.bounds.right:t.bounds.right,n=((null==(i=t.next)?void 0:i.firstChild)?null==(r=t.next.firstChild.bounds)?void 0:r.left:null==(d=t.next)||null==(l=d.bounds)?void 0:l.left)||0,s=t.inputPoint.y;(null==t?void 0:t.next)&&o.push({offset:{x:(e+n)/2,y:s},type:a.nx.BRANCH_DRAGGING_LABEL,width:n-e,props:{side:a.VH.NORMAL_BRANCH}})}else{let e=t.firstChild?t.firstChild.bounds.bottom:t.bounds.bottom,n=((null==(s=t.next)?void 0:s.firstChild)?null==(u=t.next.firstChild.bounds)?void 0:u.top:null==(y=t.next)||null==(p=y.bounds)?void 0:p.top)||0,i=t.inputPoint.x;(null==t?void 0:t.next)&&o.push({offset:{x:i,y:(e+n)/2},type:a.nx.BRANCH_DRAGGING_LABEL,width:n-e,props:{side:a.VH.NORMAL_BRANCH}})}}return[...o]},addChild(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{index:o}=n;return e.document.addNode({...t,...n,parent:e,index:"number"==typeof o?o+1:void 0})}},m={type:a.Sy.INLINE_BLOCKS,meta:{hidden:!0,spacing:e=>(0,a.yI)(e.entity,a.cc.NODE_SPACING),isInlineBlocks:!0,inlineSpacingPre:e=>(0,a.yI)(e.entity,a.cc.INLINE_BLOCKS_PADDING_TOP)||a.Lu.INLINE_BLOCKS_PADDING_TOP,inlineSpacingAfter:e=>(0,a.yI)(e.entity,a.cc.INLINE_BLOCKS_PADDING_BOTTOM)},getChildDelta(e,t){var n;let o=a.XP.isVertical(t),i=null==(n=e.entity.pre)?void 0:n.getData(a.eG);if(i){let{localBounds:t}=i;if(o){let n=i.size.width+i.originDeltaX,o=Math.max(e.parent.minInlineBlockSpacing-n,(0,a.yI)(e.entity,a.cc.BRANCH_SPACING)-e.originDeltaX);return{x:t.right+o,y:0}}{let n=i.size.height+i.originDeltaY,o=Math.max(e.parent.minInlineBlockSpacing-n,(0,a.yI)(e.entity,a.cc.BRANCH_SPACING)-e.originDeltaY);return{x:0,y:t.bottom+o}}}return{x:0,y:0}},getDelta(e,t){var n,o,i,r;let l=a.XP.isVertical(t),{pre:d,collapsed:s}=e;if(s)return{x:0,y:0};if(l){let t=d.localBounds.center.x,n=(null==(i=e.firstChild)?void 0:i.transform.position.x)||0;return{x:t-(((null==(r=e.lastChild)?void 0:r.transform.position.x)||0)-n)/2,y:0}}let u=d.localBounds.center.y,p=(null==(n=e.firstChild)?void 0:n.transform.position.y)||0;return{x:0,y:u-(((null==(o=e.lastChild)?void 0:o.transform.position.y)||0)-p)/2}},getLabels:e=>(function(e){var t;let{isVertical:n}=e.entity,o=e.transform;return o.collapsed?[{type:a.nx.COLLAPSE_LABEL,offset:u.E9.move(o.inputPoint,n?{y:10}:{x:10}),props:{activateNode:e.entity.pre}}]:[{type:a.nx.CUSTOM_LABEL,renderKey:d.kD.BRANCH_ADDER,offset:u.E9.move(o.inputPoint,n?{y:10}:{x:10}),props:{activated:e.entity.getData(a.Lz).activated,transform:o,node:null==(t=o.originParent)?void 0:t.entity}}]})(e),getLines:()=>[],getInputPoint(e,t){var n,o;return a.XP.isVertical(t)?{x:(null==(o=e.pre)?void 0:o.outputPoint.x)||0,y:e.bounds.top}:{x:e.bounds.left,y:(null==(n=e.pre)?void 0:n.outputPoint.y)||0}},getOutputPoint(e,t){var n,o;let i=a.XP.isVertical(t);return e.collapsed?e.inputPoint:i?{x:(null==(o=e.pre)?void 0:o.outputPoint.x)||0,y:e.bounds.bottom}:{x:e.bounds.right,y:(null==(n=e.pre)?void 0:n.outputPoint.y)||0}}},x={type:a.Sy.BLOCK_ICON,meta:{spacing:20,size:{width:250,height:84}},getLabels(e){let t=e.transform,{isVertical:n}=e.entity;if(e.entity.parent.collapsedChildren.length<=1)return[];let o=(0,a.yI)(e.entity,a.T4.COLLAPSED_SPACING);return[{type:a.nx.COLLAPSE_LABEL,offset:u.E9.move(t.outputPoint,n?{y:o}:{x:o}),props:{collapseNode:e.entity.parent,activateNode:e.entity}}]}},b={type:a.Sy.BLOCK_ORDER_ICON,meta:{spacing:40},getLabels(e){let t=e.transform,{isVertical:n}=e.entity,o=t.outputPoint,i=t.next,r=t.parent;if(e.entity.parent.collapsedChildren.length<=1)return[{offset:null==r?void 0:r.outputPoint,type:a.nx.ADDER_LABEL}];let l=(0,a.yI)(e.entity,a.T4.COLLAPSED_SPACING);return[{offset:i?u.E9.getMiddlePoint(o,i.inputPoint):u.E9.move(o,n?{y:l}:{x:l}),type:a.nx.COLLAPSE_ADDER_LABEL,props:{activateNode:e.entity,collapseNode:e.entity.parent}}]}},P={type:a.Sy.START,meta:{isStart:!0,draggable:!1,selectable:!1,deleteDisable:!0,copyDisable:!0,addDisable:!0}},S={extend:a.Sy.BLOCK,type:"catchBlock",meta:{hidden:!0,spacing:a.Lu.NULL},getLines(e){let t,{transform:n}=e,{isVertical:o}=e.entity,i=n.parent,{inputPoint:r,outputPoint:l}=n;t=o?{x:i.inputPoint.x,y:i.inputPoint.y-20}:{x:i.inputPoint.x-20,y:i.inputPoint.y};let d=[{type:a.IG.DIVERGE_LINE,from:t,to:r}];if(!e.isNodeEnd){let e;e=o?{x:i.outputPoint.x,y:i.bounds.bottom}:{x:i.bounds.right,y:i.outputPoint.y},d.push({type:a.IG.MERGE_LINE,from:l,to:e})}return d},getLabels:()=>[]},E={extend:a.Sy.INLINE_BLOCKS,type:"catchInlineBlocks",meta:{spacing:a.Lu.NULL,inlineSpacingPre:a.Lu.NULL},getDelta(){},getLines(e){let{transform:t}=e,n=t.parent,o=[{type:a.IG.DIVERGE_LINE,from:n.pre.outputPoint,to:t.inputPoint}];return t.entity.isNodeEnd||o.push({type:a.IG.MERGE_LINE,from:t.outputPoint,to:n.outputPoint}),o},getOriginDeltaX(e){let{firstChild:t}=e;return t?t.originDeltaX:0},getLabels(e){var t;let{inputPoint:n}=e.transform,{isVertical:o}=e.entity,i=e.transform,r={x:o?n.x:n.x-20,y:o?n.y-20:n.y};return i.collapsed?[]:[{type:a.nx.CUSTOM_LABEL,renderKey:d.kD.BRANCH_ADDER,offset:r,props:{activated:e.entity.getData(a.Lz).activated,transform:i,node:null==(t=i.originParent)?void 0:t.entity}}]},getInputPoint(e,t){let n=a.XP.isVertical(t),o=e.firstChild;return o?o.inputPoint:n?e.bounds.topCenter:e.bounds.rightCenter},getOutputPoint(e,t){let n=a.XP.isVertical(t);if(e.collapsed)return e.inputPoint;let o=e.firstChild;if(o){var i,r;return n?{x:null==(i=o.outputPoint)?void 0:i.x,y:e.bounds.bottom}:{x:e.bounds.right,y:null==(r=o.outputPoint)?void 0:r.y}}return n?e.bounds.bottomCenter:e.bounds.rightCenter}},O={extend:a.Sy.INLINE_BLOCKS,type:"mainInlineBlocks",meta:{inlineSpacingPre:20,inlineSpacingAfter:40},getLines(e){let{transform:t}=e,n=t.firstChild;return[{type:a.IG.STRAIGHT_LINE,from:n.outputPoint,to:t.originParent.outputPoint}]},getLabels(e){var t;let{transform:n}=e,{isVertical:o}=e.entity,i=n.children[1],r=o?(n.parent.outputPoint.x+i.inputPoint.x)/2:n.inputPoint.x-54,l=o?n.inputPoint.y-54:(n.parent.outputPoint.y+i.inputPoint.y)/2;return[{type:a.nx.TEXT_LABEL,renderKey:d.oC.TRY_START_TEXT,offset:{x:o?n.inputPoint.x:n.inputPoint.x+-20,y:o?n.inputPoint.y+-20:n.inputPoint.y}},{type:a.nx.TEXT_LABEL,renderKey:d.oC.TRY_END_TEXT,offset:{x:o?n.inputPoint.x:n.originParent.outputPoint.x+-20,y:o?n.originParent.outputPoint.y+-20:n.inputPoint.y}},{type:a.nx.CUSTOM_LABEL,renderKey:d.kD.TRY_CATCH_COLLAPSE,offset:{x:r,y:l},props:{node:null==(t=n.lastChild)?void 0:t.entity}}]},getInputPoint:e=>e.firstChild.inputPoint,getOutputPoint(e,t){let n=e.firstChild;return a.XP.isVertical(t)?{x:n.outputPoint.x,y:e.bounds.bottom+20}:{x:e.bounds.right+20,y:n.outputPoint.y}},getDelta(){},getChildDelta(e,t){var n;let o=null==(n=e.entity.pre)?void 0:n.getData(a.eG),i=a.XP.isVertical(t);if(o){let{localBounds:t}=o,n=0;return n=i?Math.max(e.parent.minInlineBlockSpacing,-e.originDeltaX+(0,a.yI)(e.entity,a.cc.BRANCH_SPACING)):Math.max(e.parent.minInlineBlockSpacing,-e.originDeltaY+(0,a.yI)(e.entity,a.cc.BRANCH_SPACING)),{x:i?t.right+n:0,y:i?0:t.bottom+n}}return{x:0,y:0}}},_={extend:a.Sy.BLOCK,type:"tryBlock",meta:{hidden:!0,spacing:a.Lu.NULL},getLines:()=>[],getLabels:()=>[]},B={type:"tryCatch",meta:{hidden:!0,inlineSpacingAfter:0},onCreate(e,t){let{document:n}=e,[o,...i]=t.blocks||[],r=[],l=n.addNode({id:`$tryCatchIcon$${e.id}`,type:a.Sy.BLOCK_ICON,originParent:e,parent:e}),d=n.addNode({id:`$mainInlineBlocks$${e.id}`,type:"mainInlineBlocks",originParent:e,parent:e}),s=n.addNode({id:o.id,type:o.type||"tryBlock",originParent:e,parent:d,data:o.data}),u=n.addNode({id:`$trySlot$${o.id}`,hidden:!0,type:"trySlot",originParent:e,parent:s}),p=n.addNode({id:`$catchInlineBlocks$${e.id}`,type:"catchInlineBlocks",originParent:e,parent:d});return r.push(l,d,s,u,p),(o.blocks||[]).forEach(e=>{n.addNode({...e,parent:s},r)}),i.forEach(t=>{n.addBlock(e,t,r)}),r},onBlockChildCreate(e,t,n){let o=e.document.getNode(`$catchInlineBlocks$${e.id}`),i=e.document.addNode({id:t.id,type:t.type||"catchBlock",originParent:e,parent:o,data:t.data}),r=e.document.addNode({id:`$blockOrderIcon$${t.id}`,type:a.Sy.BLOCK_ORDER_ICON,originParent:e,parent:i});return t.blocks&&e.document.addBlocksAsChildren(i,t.blocks||[],n),null==n||n.push(i,r),i},getInputPoint:e=>e.firstChild.inputPoint,getOutputPoint(e,t){let n=a.XP.isVertical(t),o=e.firstChild;return n?{x:o.inputPoint.x,y:e.bounds.bottom}:{x:e.bounds.right,y:o.inputPoint.y}},extendChildRegistries:[{type:a.Sy.BLOCK_ICON,meta:{spacing:54},getLabels:()=>[]},O,E,_,S,{type:"trySlot",meta:{inlineSpacingAfter:16,spacing:0,size:{width:16,height:0}},onAfterUpdateLocalTransform(e){e.entity.isVertical?e.data.size={width:16,height:0}:e.data.size={width:0,height:16},e.transform.update({size:e.data.size})},getLabels:e=>[{offset:e.transform.bounds.center,type:a.nx.ADDER_LABEL}]}]},D={SPACING:16,COLLAPSE_INLINE_SPACING_BOTTOM:60,[a.cc.INLINE_SPACING_BOTTOM]:48,MIN_INLINE_BLOCK_SPACING:280,HORIZONTAL_MIN_INLINE_BLOCK_SPACING:180,LEFT_EMPTY_BLOCK_WIDTH:80,EMPTY_BRANCH_SPACING:20,LOOP_BLOCK_ICON_SPACING:13,[a.cc.INLINE_BLOCKS_INLINE_SPACING_BOTTOM]:23,INLINE_BLOCKS_INLINE_SPACING_TOP:30},A={type:"loopLeftEmptyBlock",meta:{inlineSpacingAfter:0,spacing:0,size:{width:D.LEFT_EMPTY_BLOCK_WIDTH,height:0}},onAfterUpdateLocalTransform(e){e.entity.isVertical?e.data.size={width:D.LEFT_EMPTY_BLOCK_WIDTH,height:0}:e.data.size={width:0,height:D.LEFT_EMPTY_BLOCK_WIDTH},e.transform.update({size:e.data.size})},getLines:()=>[],getLabels:()=>[]},T={...v,type:"loopRightEmptyBlock",meta:{...v.meta,inlineSpacingAfter:0}},R={type:"loopEmptyBranch",meta:{inlineSpacingAfter:0,spacing:D.EMPTY_BRANCH_SPACING,size:{width:100,height:0}},getLabels(e){let{isVertical:t}=e.entity,n=e.transform;return t?[{type:a.nx.ADDER_LABEL,offset:{x:n.inputPoint.x,y:n.bounds.center.y+8}}]:[{type:a.nx.ADDER_LABEL,offset:{x:n.bounds.center.x+8,y:n.inputPoint.y}}]},onAfterUpdateLocalTransform(e){e.entity.isVertical?e.data.size={width:100,height:0}:e.data.size={width:0,height:100},e.transform.update({size:e.data.size})}},k={type:a.Sy.INLINE_BLOCKS,meta:{inlineSpacingPre:e=>(0,a.yI)(e.entity,a.cc.INLINE_BLOCKS_INLINE_SPACING_TOP,D.INLINE_BLOCKS_INLINE_SPACING_TOP),inlineSpacingAfter:e=>(0,a.yI)(e.entity,a.cc.INLINE_BLOCKS_INLINE_SPACING_BOTTOM,D.INLINE_BLOCKS_INLINE_SPACING_BOTTOM),minInlineBlockSpacing:e=>e.entity.isVertical?D.MIN_INLINE_BLOCK_SPACING:D.HORIZONTAL_MIN_INLINE_BLOCK_SPACING},getLines(e){let t=e.transform,n=t.parent,{isVertical:o}=e.entity,i=[{type:a.IG.STRAIGHT_LINE,from:t.outputPoint,to:n.outputPoint}];if(t.collapsed)return i;let[r]=t.children;return[...i,{type:a.IG.ROUNDED_LINE,from:t.outputPoint,to:r.outputPoint,vertices:[o?{x:r.inputPoint.x,y:t.bounds.bottom}:{x:t.bounds.right,y:r.inputPoint.y}]},{type:a.IG.ROUNDED_LINE,from:r.outputPoint,to:u.E9.move(t.inputPoint,o?{x:-12,y:10}:{x:10,y:-12}),vertices:[o?{x:r.inputPoint.x,y:t.bounds.top+10}:{x:t.bounds.left+10,y:r.inputPoint.y}],arrow:!0}]},getLabels(e){var t;let n=e.transform,{isVertical:o}=e.entity,i=[];if(n.collapsed)return i;let r=n.children[0],l=n.children[1];return(null==(t=e.entity.originParent)?void 0:t.id.startsWith("while_"))?i.push({type:a.nx.TEXT_LABEL,renderKey:d.oC.LOOP_WHILE_TEXT,rotate:o?"":"-90deg",offset:o?{x:(n.inputPoint.x+l.inputPoint.x)/2,y:n.inputPoint.y+10}:{x:n.inputPoint.x+10,y:(n.inputPoint.y+l.inputPoint.y)/2}}):i.push({type:a.nx.TEXT_LABEL,renderKey:d.oC.LOOP_TRAVERSE_TEXT,offset:o?{x:r.inputPoint.x,y:n.bounds.center.y+5}:{x:n.bounds.center.x+5,y:r.inputPoint.y}}),i}},$={type:"loop",meta:{hidden:!0,inlineSpacingAfter:e=>e.collapsed?D.COLLAPSE_INLINE_SPACING_BOTTOM:(0,a.yI)(e.entity,a.cc.INLINE_SPACING_BOTTOM,D.INLINE_SPACING_BOTTOM),spacing:D.SPACING},onCreate(e,t){let{document:n}=e,o=t.blocks||[],i=n.addNode({id:`$blockIcon$${e.id}`,type:a.Sy.BLOCK_ICON,originParent:e,parent:e}),r=n.addNode({id:`$inlineBlocks$${e.id}`,hidden:!0,type:a.Sy.INLINE_BLOCKS,originParent:e,parent:e}),l=n.addNode({id:`$loopLeftEmpty$${e.id}`,hidden:!0,type:"loopLeftEmptyBlock",originParent:e,parent:r}),d=n.addNode({id:`$block$${e.id}`,hidden:!0,type:a.Sy.BLOCK,originParent:e,parent:r}),s=n.addNode({id:`$loopRightEmpty$${e.id}`,hidden:!0,type:"loopEmptyBranch",originParent:e,parent:d}),u=[];return o.forEach(e=>n.addNode({...e,type:e.type,parent:d},u)),[i,l,r,d,s,...u]},getLabels(e){let t=e.transform,{isVertical:n}=e.entity;return[{type:a.nx.TEXT_LABEL,renderKey:d.oC.LOOP_END_TEXT,props:n?void 0:{style:{maxWidth:"20px",lineHeight:"12px",whiteSpace:"pre-wrap"}},offset:u.E9.move(t.outputPoint,n?{y:-26}:{x:-26})},{type:a.nx.ADDER_LABEL,offset:t.outputPoint}]},getInputPoint(e){var t,n,o,i;let{isVertical:r}=e.entity;return r?{x:(null==(o=e.pre)?void 0:o.outputPoint.x)||(null==(i=e.firstChild)?void 0:i.outputPoint.x)||0,y:e.bounds.top}:{x:e.bounds.left,y:(null==(t=e.pre)?void 0:t.outputPoint.y)||(null==(n=e.firstChild)?void 0:n.outputPoint.y)||0}},getOutputPoint(e){var t,n,o,i;let{isVertical:r}=e.entity;return r?{x:(null==(o=e.pre)?void 0:o.outputPoint.x)||(null==(i=e.firstChild)?void 0:i.outputPoint.x)||0,y:e.bounds.bottom}:{x:e.bounds.right,y:(null==(t=e.pre)?void 0:t.outputPoint.y)||(null==(n=e.firstChild)?void 0:n.outputPoint.y)||0}},extendChildRegistries:[{type:a.Sy.BLOCK_ICON,meta:{spacing:D.LOOP_BLOCK_ICON_SPACING}},A,R,T,k],addChild(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{index:o}=n,i=e.document;return i.addNode({...t,...n,parent:i.getNode(`$block$${e.id}`),index:"number"==typeof o?o+1:void 0})}},M={type:a.Sy.ROOT,meta:{spacing:a.Lu.NULL,hidden:!0},getInputPoint(e){var t;return(null==(t=e.firstChild)?void 0:t.inputPoint)||e.bounds.topCenter},getOutputPoint(e){var t;return(null==(t=e.firstChild)?void 0:t.outputPoint)||e.bounds.bottomCenter}},G={type:a.Sy.EMPTY,meta:{spacing:e=>(0,a.yI)(e.entity,a.cc.NODE_SPACING)/2,size:{width:0,height:0},hidden:!0},getLabels:e=>[{offset:e.transform.bounds,type:a.nx.ADDER_LABEL}]},V={type:a.OT.SIMPLE_SPLIT,extend:a.OT.DYNAMIC_SPLIT,onBlockChildCreate(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],{document:o}=e,i=o.getNode(`$inlineBlocks$${e.id}`),r=o.addNode({...t,type:t.type||a.Sy.BLOCK,parent:i},n);return n.push(r),r}},H={type:a.Sy.BREAK,extend:a.Sy.END},K={type:a.Sy.INPUT,extend:a.Sy.BLOCK,meta:{hidden:!1},getLines(e,t){let n=e.transform,{isVertical:o}=e.entity,i=[];if(n&&n.entity.isInlineBlock&&e.renderData.draggable){var r,l,d,s,u,p,y,c,g,h;if(o){let e=n.firstChild?n.firstChild.bounds.right:n.bounds.right,t=((null==(r=n.next)?void 0:r.firstChild)?null==(d=n.next)||null==(l=d.firstChild.bounds)?void 0:l.left:null==(u=n.next)||null==(s=u.bounds)?void 0:s.left)||0,o=n.outputPoint.y;(null==n?void 0:n.next)&&i.push({type:a.IG.MERGE_LINE,isDraggingLine:!0,from:{x:(e+t)/2,y:o},to:n.parent.outputPoint,side:a.VH.NORMAL_BRANCH})}else{let e=n.firstChild?n.firstChild.bounds.bottom:n.bounds.bottom,t=((null==(p=n.next)?void 0:p.firstChild)?null==(c=n.next)||null==(y=c.firstChild.bounds)?void 0:y.top:null==(h=n.next)||null==(g=h.bounds)?void 0:g.top)||0,o=n.outputPoint.x;(null==n?void 0:n.next)&&i.push({type:a.IG.MERGE_LINE,isDraggingLine:!0,from:{x:o,y:(e+t)/2},to:n.parent.outputPoint,side:a.VH.NORMAL_BRANCH})}}return e.isNodeEnd||i.push({type:a.IG.MERGE_LINE,from:n.outputPoint,to:n.parent.outputPoint,side:a.VH.NORMAL_BRANCH}),i},getLabels(e){let t=e.transform,{isVertical:n}=e.entity,o=[];if(t&&t.entity.isInlineBlock&&e.renderData.draggable){var i,r,l,d,s,u,p,y;if(n){let e=t.firstChild?t.firstChild.bounds.right:t.bounds.right,n=((null==(i=t.next)?void 0:i.firstChild)?null==(r=t.next.firstChild.bounds)?void 0:r.left:null==(d=t.next)||null==(l=d.bounds)?void 0:l.left)||0,s=t.outputPoint.y;(null==t?void 0:t.next)&&o.push({offset:{x:(e+n)/2,y:s},type:a.nx.BRANCH_DRAGGING_LABEL,width:n-e,props:{side:a.VH.NORMAL_BRANCH}})}else{let e=t.firstChild?t.firstChild.bounds.bottom:t.bounds.bottom,n=((null==(s=t.next)?void 0:s.firstChild)?null==(u=t.next.firstChild.bounds)?void 0:u.top:null==(y=t.next)||null==(p=y.bounds)?void 0:p.top)||0,i=t.outputPoint.x;(null==t?void 0:t.next)&&o.push({offset:{x:i,y:(e+n)/2},type:a.nx.BRANCH_DRAGGING_LABEL,width:n-e,props:{side:a.VH.NORMAL_BRANCH}})}}return[...o]}},U={type:a.Sy.OUTPUT,extend:a.Sy.BLOCK,meta:{hidden:!1,isNodeEnd:!0}},w={type:a.Sy.MULTI_OUTPUTS,extend:a.OT.SIMPLE_SPLIT,meta:{isNodeEnd:!0},getLines:(e,t)=>{var n;return(null==(n=e.entity.parent)?void 0:n.flowNodeType)===a.Sy.INLINE_BLOCKS?v.getLines(e,t):[]},getLabels:(e,t)=>[...I.getLabels(e,t),...v.getLabels(e,t)],getOutputPoint(e,t){var n;let o=a.XP.isVertical(t),i=null==(n=e.lastChild)?void 0:n.outputPoint;return o?{x:i?i.x:e.bounds.center.x,y:e.bounds.bottom}:{x:e.bounds.right,y:i?i.y:e.bounds.center.y}},extendChildRegistries:[{type:a.Sy.BLOCK_ICON,meta:{}}]},X={type:a.Sy.MULTI_INPUTS,extend:a.OT.SIMPLE_SPLIT,extendChildRegistries:[{type:a.Sy.BLOCK_ICON,meta:{hidden:!0,spacing:0},getLines:()=>[],getLabels:()=>[]},{type:a.Sy.INLINE_BLOCKS,meta:{inlineSpacingPre:0},getLabels(e){var t,n;let o=e.entity.isVertical,i=e.transform,r=(0,a.yI)(e.entity,a.cc.INLINE_BLOCKS_PADDING_BOTTOM);return i.collapsed||0===e.entity.childrenLength?[{type:a.nx.CUSTOM_LABEL,renderKey:d.kD.BRANCH_ADDER,offset:u.E9.move(i.outputPoint,o?{y:r}:{x:r}),props:{activated:e.entity.getData(a.Lz).activated,transform:i,node:null==(n=i.originParent)?void 0:n.entity}}]:[{type:a.nx.CUSTOM_LABEL,renderKey:d.kD.BRANCH_ADDER,offset:u.E9.move(i.outputPoint,o?{y:-r/2}:{x:-r/2}),props:{activated:e.entity.getData(a.Lz).activated,transform:i,node:null==(t=i.originParent)?void 0:t.entity}}]}}],getLabels:()=>[]},z=d.kD.SLOT_ADDER,F=d.kD.SLOT_LABEL,Y=d.kD.SLOT_COLLAPSE,J="SLOT_START_DISTANCE",Z="SLOT_PORT_DISTANCE",j=((o=j||{})[o.Slot=a.Sy.SLOT]="Slot",o[o.SlotBlock=a.Sy.SLOT_BLOCK]="SlotBlock",o.SlotInlineBlocks="slotInlineBlocks",o.SlotBlockInlineBlocks="slotBlockInlineBlocks",o),Q=e=>{var t;return!!(null==e||null==(t=e.lastCollapsedChild)?void 0:t.blocks.length)},q=e=>{var t;return!!(null==e||null==(t=e.parent)?void 0:t.isTypeOrExtendType(j.SlotBlock))},W=e=>e.firstChild?W(e.firstChild):e,ee=e=>{if(!e)return{x:0,y:0};let t=(0,a.yI)(e.entity,J,16);return e.entity.isVertical?{x:(null==e?void 0:e.bounds.right)+t,y:null==e?void 0:e.bounds.center.y}:{x:null==e?void 0:e.bounds.center.x,y:(null==e?void 0:e.bounds.bottom)+t}},et=e=>{var t;let n=null==(t=e.transform.next)?void 0:t.inputPoint,o=e.transform.firstChild,i=e.transform.parent;return o&&i?(e.transform.next||(n=e.entity.isVertical?{x:o.outputPoint.x,y:i.outputPoint.y}:{x:i.outputPoint.x,y:o.outputPoint.y}),n||{x:0,y:0}):{x:0,y:0}},en=e=>{if(!e)return{x:0,y:0};let t=W(e);return{x:e.bounds.left,y:t.bounds.center.y}},eo=e=>e.firstChild?e.localBounds.top+eo(e.firstChild):e.localBounds.center.y,ei={type:a.Sy.BLOCK_ICON,meta:{defaultExpanded:!1,spacing:0},getLines:e=>[...Q(e.entity.parent)?(e=>{let t=(0,a.yI)(e.transform.entity,J,16);return[{type:a.IG.STRAIGHT_LINE,from:ee(e.transform),to:u.E9.move(ee(e.transform),e.entity.isVertical?{x:-t,y:0}:{x:0,y:-t}),style:{strokeDasharray:"5 5"}}]})(e):[]],getLabels:e=>[...Q(e.entity.parent)?(e=>{let t=e.transform;return[{type:a.nx.CUSTOM_LABEL,renderKey:Y,offset:ee(t),props:{node:e.entity.parent}}]})(e):[]],getDelta:e=>q(e.entity.parent)?e.entity.isVertical?{x:-e.originDeltaX,y:0}:{x:0,y:-e.originDeltaY}:{x:0,y:0}},er={type:"slotInlineBlocks",extend:a.Sy.BLOCK,meta:{spacing:0,inlineSpacingPre:0,inlineSpacingAfter:0,isInlineBlocks:e=>!e.isVertical},getLines:()=>[],getLabels:()=>[],getChildDelta(e,t){var n;if(e.entity.isVertical)return{x:0,y:0};let o=null==(n=e.entity.pre)?void 0:n.getData(a.eG);if(o){let{localBounds:e}=o;return{x:0,y:e.bottom+30}}return{x:0,y:0}},getDelta(e){if(!e.children.length)return{x:0,y:0};let t=e.pre;if(!t)return{x:0,y:0};let n=(0,a.yI)(e.entity,J,16),o=(0,a.yI)(e.entity,Z,100),i=(0,a.yI)(e.entity,"SLOT_BLOCK_PORT_DISTANCE",32.5);if(!e.entity.isVertical){var r,l;return(null==e||null==(l=e.children)||null==(r=l.every)?void 0:r.call(l,e=>!e.children.length))?{x:o-t.localBounds.width/2,y:t.localBounds.bottom+n}:{x:o+i-t.localBounds.width/2,y:t.localBounds.bottom+n}}return{x:t.localBounds.right+(n+o+i),y:-t.localBounds.height}}},el={type:j.SlotBlock,extend:a.Sy.BLOCK,meta:{inlineSpacingAfter:0,inlineSpacingPre:0,spacing:e=>e.entity.isVertical||0!==e.size.width?(0,a.yI)(e.entity,"SLOT_BLOCK_VERTICAL_SPACING",32.5):90,isInlineBlocks:e=>!e.isVertical},getLines(e){var t;let n=ee(null==(t=e.transform.parent)?void 0:t.pre),o=e.transform.inputPoint,i=(0,a.yI)(e.transform.entity,"SLOT_RADIUS",16),r=[{x:n.x,y:o.y}];if(e.entity.isVertical){let e=Math.abs(o.y-n.y),t=i,l=!1;e<2*i&&(l=!0,e<i&&(t=Math.sqrt(i**2-(i-e)**2))),r=[{x:n.x+t,y:n.y,radiusX:i,radiusY:i,radiusOverflow:"truncate"},{x:n.x+t,y:o.y,...l?{radiusX:0,radiusY:0}:{}}]}return 1===e.transform.children.length?[{type:a.IG.ROUNDED_LINE,from:n,to:en(e.transform.children[0]),vertices:r,style:{strokeDasharray:"5 5"},radius:i}]:[{type:a.IG.ROUNDED_LINE,from:n,to:o,vertices:r,style:{strokeDasharray:"5 5"},radius:i},...e.transform.children.map(e=>{let t=en(e);return{type:a.IG.ROUNDED_LINE,radius:i,from:o,to:t,vertices:[{x:o.x,y:t.y}],style:{strokeDasharray:"5 5"}}})]},getLabels(e){var t;let n=ee(null==(t=e.transform.parent)?void 0:t.pre),o=e.transform.inputPoint;return[{type:a.nx.CUSTOM_LABEL,renderKey:z,props:{node:e.entity},offset:o},{type:a.nx.CUSTOM_LABEL,renderKey:F,props:{node:e.entity},offset:{x:n.x+(0,a.yI)(e.entity,"SLOT_LABEL_DISTANCE",32),y:o.y},origin:[0,.5]}]},getInputPoint(e){var t;let n=ee(null==(t=e.parent)?void 0:t.pre),o=e.bounds.center.y;return e.children.length&&(o=h([en(e.firstChild).y,en(e.lastChild).y])),{x:n.x+(0,a.yI)(e.entity,Z,100),y:o}},getChildDelta(e,t){var n;let o=!!e.firstChild;if(e.entity.isVertical)return{x:o?0:-e.originDeltaX,y:0};let i=o?0:-e.originDeltaY,r=null==(n=e.entity.pre)?void 0:n.getData(a.eG);if(r){let{localBounds:e}=r;return{x:0,y:e.bottom+30+i}}return{x:0,y:i}},getChildLabels:()=>[],getChildLines:()=>[],getDelta:e=>({x:0,y:0})},ed={type:a.Sy.SLOT,extend:"block",meta:{draggable:e=>!q(e),hidden:!0,spacing:e=>(0,a.yI)(e.entity,"SLOT_SPACING",32),padding:e=>({left:0,right:e.collapsed?(0,a.yI)(e.entity,J,16):0,bottom:!q(e.entity)&&e.isLast?10:0,top:0}),copyDisable:!1,defaultExpanded:!1},onCreate:(e,t)=>{let{document:n}=e,o=[],i=n.addNode({id:`$slotIcon$${e.id}`,type:a.Sy.BLOCK_ICON,originParent:e,parent:e}),r=n.addNode({id:`$slotInlineBlocks$${e.id}`,type:"slotInlineBlocks",originParent:e,parent:e});return o.push(i),o.push(r),(t.blocks||[]).forEach(t=>{let i=n.addNode({type:j.SlotBlock,...t,originParent:e,parent:r});o.push(i),(t.blocks||[]).forEach(e=>{n.addNode({type:j.Slot,...e,parent:i},o)})}),o},getLines:e=>[...q(e.entity)?[]:(e=>{let t=e.transform.firstChild,n=et(e);return t?[{type:a.IG.STRAIGHT_LINE,from:t.outputPoint,to:n},{type:a.IG.STRAIGHT_LINE,from:t.inputPoint,to:e.transform.inputPoint}]:[]})(e)],getLabels:e=>[...q(e.entity)?[]:(e=>{var t,n;let o=et(e),i=e.transform.firstChild.outputPoint,r=e.entity.isVertical?{hoverHeight:o.y-i.y,hoverWidth:null==(t=e.transform.firstChild)?void 0:t.bounds.width}:{hoverHeight:null==(n=e.transform.firstChild)?void 0:n.bounds.height,hoverWidth:o.x-i.x};return[{offset:u.E9.getMiddlePoint(i,o),type:a.nx.ADDER_LABEL,props:r}]})(e)],getInputPoint:e=>{let t=e.firstChild;return t?e.entity.isVertical?t.inputPoint:{x:e.bounds.left,y:t.outputPoint.y}:{x:0,y:0}},getOutputPoint:e=>{let t=e.firstChild;return t?e.entity.isVertical?{x:t.outputPoint.x,y:e.bounds.bottom}:{x:e.bounds.right,y:t.outputPoint.y}:{x:0,y:0}},onAfterUpdateLocalTransform(e){let{isVertical:t}=e.entity;if(!t)return;let n=e.firstChild,o=e.lastChild;if(!n||!o)return;let i=n.localBounds.height,r=o.localBounds.height;if(e.collapsed||!o)return;let l=(e=>{if(!e.children.length)return e.localBounds.height/2;let t=[e.firstChild,e.lastChild].map(e=>(e=>{if(!e.children.length)return e.localBounds.top;let t=[e.firstChild,e.lastChild].map(e=>eo(e));return e.localBounds.top+h(t)})(e));return h(t)})(o);if(n.entity.clearMemoLocal(),o.entity.clearMemoLocal(),i/2+l>r||!o.children.length){n.transform.update({position:{x:n.transform.position.x,y:0}}),o.transform.update({position:{x:o.transform.position.x,y:Math.max(i/2-r/2,0)}});return}o.transform.update({position:{x:o.transform.position.x,y:0}}),null==n||n.transform.update({position:{x:n.transform.position.x,y:Math.max(l-i/2,0)}})},extendChildRegistries:[ei,er]},ea=class{registerDocument(e){e.registerFlowNodes(M,P,I,C,V,v,m,x,b,B,N,$,G,H,w,X,K,U,ed,el),e.registerNodeDatas(a.Lz,a.Xr,a.eG)}registerRenderer(e){e.registerLayers(d.V7,d.Em,d.HW,d.Eq,s.wY)}onReady(){}onDispose(){}};ea=((e,t,n,o)=>{for(var i,r=o>1?void 0:o?L(t,n):t,l=e.length-1;l>=0;l--)(i=e[l])&&(r=(o?i(t,n,r):i(r))||r);return o&&r&&f(t,n,r),r})([(0,l.b2)()],ea);var es=new l.nZ(e=>{(0,u.KV)(e,ea,[a.Lw,d.OK,s.qY])}),eu=n(908600),ep=(0,s.M1)({onInit(e,t){!1!==t.enable&&e.playground.registerLayer(d.EU,{onDrop:t.onDrop?t.onDrop.bind(null,e):void 0,canDrop:t.canDrop?t.canDrop.bind(null,e):void 0})}});function ey(){let e=(0,s.Dc)().getLayer(d.EU);return(0,eu.useMemo)(()=>({startDrag:e?e.startDrag.bind(e):e=>{},dragOffset:e?e.dragOffset:{x:0,y:0}}),[e])}var ec=n(324067),eg=n(66298),eh=n(952893),ef=n(57064),eL=Object.defineProperty,eN=Object.getOwnPropertyDescriptor,eI=(e,t,n,o)=>{for(var i,r=o>1?void 0:o?eN(t,n):t,l=e.length-1;l>=0;l--)(i=e[l])&&(r=(o?i(t,n,r):i(r))||r);return o&&r&&eL(t,n,r),r},eC=class{init(e,t){t.nodeToJSON&&(this.nodeToJSON=t.nodeToJSON(e)),t.getNodeLabelById&&(this.getNodeLabelById=t.getNodeLabelById(e)),t.getNodeLabel&&(this.getNodeLabel=t.getNodeLabel(e)),t.getBlockLabel&&(this.getBlockLabel=t.getBlockLabel(e)),t.getNodeURI&&(this.getNodeURI=t.getNodeURI(e))}getParentName(e){return e?this.getNodeLabelById(e):"root"}constructor(){this.nodeToJSON=e=>e.toJSON(),this.getNodeLabelById=e=>e,this.getNodeLabel=e=>e.id,this.getBlockLabel=e=>e.id,this.getNodeURI=e=>`node:${e}`}};eC=eI([(0,l.b2)()],eC);var ev=class{setSource(e){this.historyService.context.source=e}registerOperationMetas(e){e.forEach(e=>{this.operationRegistry.registerOperationMeta(e)})}transact(e){this.historyService.transact(e)}async undo(){await this.historyService.undo()}async redo(){await this.historyService.redo()}canRedo(){return this.historyService.canRedo()}canUndo(){return this.historyService.canUndo()}pushHistoryOperation(e){return this.historyService.pushOperation(e)}getHistoryOperations(){return this.historyService.getHistoryOperations()}addFromNode(e,t){let n={fromId:"string"==typeof e?e:e.id,data:t};return this.historyService.pushOperation({type:a.C8.addFromNode,value:n,uri:this.config.getNodeURI(t.id)})}deleteNode(e){let{originParent:t,parent:n}=e,o=this.config.getNodeURI(e.id),i=this.config.nodeToJSON(e);if(i||(i={id:e.id,type:e.flowNodeType}),n){let r=n.children.findIndex(t=>t===e);if(t){let e=t.id;if(!e)return void console.warn("no parent found");let n={targetId:e,blockData:i};return r>=0&&(n.index=r),this.historyService.pushOperation({type:a.C8.deleteBlock,value:n,uri:o})}{let e={data:i,parentId:n.id};return r>=0&&(e.index=r),this.historyService.pushOperation({type:a.C8.deleteChildNode,value:e,uri:o})}}return e.pre?this.historyService.pushOperation({type:a.C8.deleteFromNode,value:{fromId:e.pre.id,data:i,uri:o}}):void console.warn("no pre found")}addChildNode(e,t,n,o){let i={data:e,parentId:null==t?void 0:t.id,originParentId:null==o?void 0:o.id,index:n};return this.historyService.pushOperation({type:a.C8.addChildNode,value:i,uri:this.config.getNodeURI(e.id)})}deleteNodes(e){0!==e.length&&this.historyService.transact(()=>{e.reverse().forEach(e=>{this.deleteNode(e)})})}addFromNodes(e,t){if(0!==t.length)return this.historyService.pushOperation({type:a.C8.addNodes,value:{fromId:e.id,nodes:t.map(e=>this.config.nodeToJSON(e)),uri:this.config.getNodeURI(t[0].id)}})}addBlock(e,t,n,o){let i={targetId:"string"==typeof e?e:e.id,blockData:t,index:o};return n&&(i.parentId=n.id),this.historyService.pushOperation({type:a.C8.addBlock,value:i,uri:this.config.getNodeURI(i.blockData.id)})}moveNode(e,t){return this.fixedHistoryOperationService.dragNodes({dropNode:t,nodes:[e]})}};eI([(0,l.f3)(eg.qp)],ev.prototype,"historyService",2),eI([(0,l.f3)(eg.CD)],ev.prototype,"operationRegistry",2),eI([(0,l.f3)(a.VO)],ev.prototype,"fixedHistoryOperationService",2),eI([(0,l.f3)(a.pQ)],ev.prototype,"document",2),eI([(0,l.f3)(eC)],ev.prototype,"config",2),ev=eI([(0,l.b2)()],ev);var em=class extends a.D9{apply(e){return this.historyService.pushOperation(e)}originApply(e){return super.apply(e)}transact(e){this.historyService.transact(e)}};eI([(0,l.f3)(eg.qp)],em.prototype,"historyService",2),em=eI([(0,l.b2)()],em);var ex=class{resetCache(e,t){Object.keys(t).forEach(n=>{this.setCache(e,n,t[n])})}setCache(e,t,n){this._cache.has(e)||this._cache.set(e,new Map),this._cache.get(e).set(t,(0,eh.Z)(n))}getCache(e,t){if(this._cache.has(e))return this._cache.get(e).get(t)}getFormDataByNodeId(e){let t=this.document.getNode(e);if(t)return t.getData(ef.Ps)}getFormItemValue(e,t){let n=this.getFormItem(e,t);if(n)return n.value}setFormItemValue(e,t,n){let o=this.getFormItem(e,t);o&&(o.value=n,this._formValueChangeByHistoryEmitter.fire({formData:e,path:t,value:n}))}getFormItem(e,t){if(void 0!==t)return t.endsWith("/")&&(t=t.slice(0,-1)),t.startsWith("/")||(t="/"+t),e.getFormModel().getFormItemByPath(t)}dispose(){this._formValueChangeByHistoryEmitter.dispose(),this._cache.clear()}constructor(){this._cache=new Map,this._formValueChangeByHistoryEmitter=new u.Q5,this.onFormValueChangeByHistory=this._formValueChangeByHistoryEmitter.event}};eI([(0,l.f3)(a.pQ)],ex.prototype,"document",2),ex=eI([(0,l.b2)()],ex);var eb={apply:(e,t)=>t.get(a.VO).originApply(e)},eP={...eb,type:a.C8.addFromNode,inverse:e=>({...e,type:a.C8.deleteFromNode}),getLabel:(e,t)=>{let n=t.get(eC),{value:o}=e;return`Create ${n.getNodeLabel(o.data)}`},getDescription:(e,t)=>{let n=t.get(eC),{value:o}=e,i=n.getNodeLabel(o.data),r=n.getNodeLabelById(o.fromId);return`Create ${o.data.type} node ${i} after ${r}`}},eS={...eb,type:a.C8.ungroup,inverse:e=>({...e,type:a.C8.createGroup}),getLabel:(e,t)=>{let n=e.value;return`Ungroup ${n.groupId}`},getDescription:(e,t)=>{let n=e.value;return`Ungroup with nodes ${n.nodeIds.join(", ")}`}},eE={...eb,type:a.C8.moveNodes,inverse:e=>({...e,value:{...e.value,fromId:e.value.toId,toId:e.value.fromId}}),getLabel:(e,t)=>{let n=t.get(eC),o=e.value;return`${o.nodeIds.map(e=>`Move ${n.getNodeLabelById(e)}`).join(";")}`},getDescription:(e,t)=>{let n=t.get(eC),o=e.value;return`${o.nodeIds.map(e=>`Move ${n.getNodeLabelById(e)} to ${n.getNodeLabelById(o.toId)}`).join(";")}`},getURI:(e,t)=>{let n=t.get(eC),o=e.value.nodeIds;if(0!==o.length)return n.getNodeURI(o[0])}},eO={...eb,type:a.C8.moveChildNodes,inverse:e=>({...e,value:{...e.value,fromIndex:e.value.toIndex,toIndex:e.value.fromIndex,fromParentId:e.value.toParentId,toParentId:e.value.fromParentId}}),getLabel:(e,t)=>{let n=t.get(eC),o=e.value;return`Move ${o.nodeIds.map(e=>n.getNodeLabelById(e)).join(",")}`},getDescription:(e,t)=>{let n=t.get(eC),o=e.value,i=void 0!==o.toIndex?`position ${o.toIndex}`:"the end";return`Move nodes ${o.nodeIds.map(e=>n.getNodeLabelById(e)).join(",")} to ${i}`}},e_={...eb,type:a.C8.moveBlock,inverse:e=>({...e,value:{...e.value,fromIndex:e.value.toIndex,toIndex:e.value.fromIndex,fromParentId:e.value.toParentId,toParentId:e.value.fromParentId}}),getLabel:(e,t)=>{let n=t.get(eC),o=e.value;return`Move ${n.getNodeLabelById(o.nodeId)}`},getDescription:(e,t)=>{let n=t.get(eC),o=e.value,i=void 0!==o.toIndex?`position ${o.toIndex}`:"the end";return`Move branch ${n.getNodeLabelById(o.nodeId)} to ${i}`}},eB={...eb,type:a.C8.deleteNodes,inverse:e=>({...e,type:a.C8.addNodes}),getLabel:(e,t)=>{let n=t.get(eC);return e.value.nodes.map(e=>`Delete ${n.getNodeLabel(e)}`).join(";")},getDescription:(e,t)=>{let n=t.get(eC),o=e.value,i=n.getNodeLabelById(o.fromId);return o.nodes.map(e=>`Delete ${e.type} node ${n.getNodeLabel(e)} after ${i}`).join(";")},shouldMerge:(e,t,n)=>!!t&&Date.now()-n.getTimestamp()<500},eD={...eb,type:a.C8.deleteNode,inverse:e=>({...e,type:a.C8.addNode}),apply:(e,t)=>{let{value:{data:n}}=e;return t.get(a.VO).deleteNode(n.id)},getLabel:(e,t)=>{let n=t.get(eC),o=e.value;return`Create ${n.getNodeLabel(o.data)}`},getDescription:(e,t)=>{let n=t.get(eC),o=e.value,i=n.getNodeLabel(o.data),r=n.getParentName(o.parentId),l=void 0!==o.index?`position ${o.index}`:"the end";return`Delete ${o.data.type} node ${i} in ${r} at ${l}`}},eA={...eb,type:a.C8.deleteFromNode,inverse:e=>({...e,type:a.C8.addFromNode}),getLabel:(e,t)=>{let n=t.get(eC),o=e.value;return`Delete ${n.getNodeLabel(o.data)}`},getDescription:(e,t)=>{let n=t.get(eC),o=e.value,i=n.getNodeLabel(o.data),r=n.getNodeLabelById(o.fromId);return`Delete ${o.data.type} node ${i} after ${r}`}},eT={...eb,type:a.C8.deleteChildNode,inverse:e=>({...e,type:a.C8.addChildNode}),getLabel:(e,t)=>{let n=t.get(eC),o=e.value;return`Delete ${n.getNodeLabel(o.data)}`},getDescription:(e,t)=>{let n=t.get(eC),o=e.value,i=n.getNodeLabel(o.data),r=n.getParentName(o.parentId),l=void 0!==o.index?`position ${o.index}`:"the end";return`Delete ${o.data.type} node ${i} in ${r} at ${l}`}},eR={...eb,type:a.C8.deleteBlock,inverse:e=>({...e,type:a.C8.addBlock}),getLabel:(e,t)=>{let n=t.get(eC),o=e.value;return`Delete ${n.getBlockLabel(o.blockData)}`},getDescription:(e,t)=>{let n=t.get(eC),o=e.value,i=n.getBlockLabel(o.blockData),r=n.getNodeLabelById(o.targetId),l=void 0!==o.index?`position ${o.index}`:"the end";return`Delete branch ${i} in ${r} at ${l}`}},ek={...eb,type:a.C8.createGroup,inverse:e=>({...e,type:a.C8.ungroup}),getLabel:(e,t)=>{let n=e.value;return`Create group ${n.groupId} from ${n.targetId}`},getDescription:(e,t)=>{let n=e.value;return`Create group with nodes ${n.nodeIds.join(", ")}`}},e$={...eb,type:a.C8.addNodes,inverse:e=>({...e,type:a.C8.deleteNodes}),getLabel:(e,t)=>{let n=t.get(eC),o=e.value;return`${o.nodes.map(e=>`Create ${n.getNodeLabel(e)}`).join(";")}`},getDescription:(e,t)=>{let n=t.get(eC),o=e.value,i=n.getNodeLabelById(o.fromId);return`${o.nodes.map(e=>`Create ${e.type} node ${n.getNodeLabel(e)} after ${i}`).join(";")}`}},eM={type:a.C8.addNode,inverse:e=>({...e,type:a.C8.deleteNode}),apply:(e,t)=>{let{value:{data:n,parentId:o,index:i,hidden:r}}=e;return t.get(a.VO).addNode(n,{parent:o,index:i,hidden:r})},getLabel:(e,t)=>{let n=t.get(eC),o=e.value;return`Create ${n.getNodeLabel(o.data)}`},getDescription:(e,t)=>{let n=t.get(eC),o=e.value,i=n.getNodeLabel(o.data),r=n.getParentName(o.parentId),l=void 0!==o.index?`position ${o.index}`:"the end";return`Create ${o.data.type} node ${i} in ${r} at ${l}`}},eG={...eb,type:a.C8.addChildNode,inverse:e=>({...e,type:a.C8.deleteChildNode}),getLabel:(e,t)=>{let n=t.get(eC),o=e.value;return`Create ${n.getNodeLabel(o.data)}`},getDescription:(e,t)=>{let n=t.get(eC),o=e.value,i=n.getNodeLabel(o.data),r=n.getParentName(o.parentId),l=void 0!==o.index?`position ${o.index}`:"the end";return`Create ${o.data.type} node ${i} in ${r} at ${l}`}},eV=[eA,eP,{...eb,type:a.C8.addBlock,inverse:e=>({...e,type:a.C8.deleteBlock}),getLabel:(e,t)=>{let n=t.get(eC),o=e.value;return`Create ${n.getBlockLabel(o.blockData)}`},getDescription:(e,t)=>{let n=t.get(eC),o=e.value,i=n.getBlockLabel(o.blockData),r=n.getNodeLabelById(o.targetId),l=void 0!==o.index?`position ${o.index}`:"the end";return`Create branch ${i} in ${r} at ${l}`}},eR,ek,eS,eE,eB,e$,e_,eG,eT,eO,eM,eD],eH=class{registerOperationMeta(e){eV.forEach(t=>{e.registerOperationMeta(t)})}};eH=eI([(0,l.b2)()],eH);var eK=(0,s.M1)({onBind:e=>{let{bind:t,rebind:n}=e;(0,u.KV)(t,eH,[eg.FU]),t(ev).toSelf().inSingletonScope(),t(ex).toSelf().inSingletonScope(),t(eC).toSelf().inSingletonScope(),n(a.VO).to(em).inSingletonScope()},onInit(e,t){let n=e.get(ev);n.setSource(e);let o=e.get(a.pQ);(null==t?void 0:t.uri)&&(n.historyService.context.uri=t.uri),(null==t?void 0:t.getDocumentJSON)?n.historyService.config.getSnapshot=t.getDocumentJSON(e):n.historyService.config.getSnapshot=()=>o.toJSON(),n.config.init(e,t),(null==t?void 0:t.operationMetas)&&n.registerOperationMetas(t.operationMetas),t.onApply&&e.get(eg.f9).onApply(t.onApply.bind(null,e))},containerModules:[eg.Xn]}),eU=n(875787),ew=Object.defineProperty,eX=Object.getOwnPropertyDescriptor,ez=(e,t,n,o)=>{for(var i,r=o>1?void 0:o?eX(t,n):t,l=e.length-1;l>=0;l--)(i=e[l])&&(r=(o?i(t,n,r):i(r))||r);return o&&r&&ew(t,n,r),r},eF=r.Zn3;(i||(i={})).DEFAULT={...r.nYJ.DEFAULT,scroll:{enableScrollLimit:!0}};var eY=e=>(t,n)=>{let o=e.filter(Boolean);return o.length?o.reduce((e,n)=>n(t,e),n):n},eJ=Symbol("FlowOperationService"),eZ=class extends r.D9C{createGroup(e){return this.groupService.createGroup(e)}ungroup(e){return this.groupService.ungroup(e)}setFormValue(e,t,n){var o;let i=this.toNodeEntity(e),l=null==i||null==(o=i.getData(r.Psq))?void 0:o.getFormModel();if(l)if((0,r.THq)(l))l.setValueIn(t,n);else{let e=l.getFormItemByPath(t);if(!e)return;e.value=n}}startTransaction(){}endTransaction(){}};ez([(0,l.f3)(r.QUv)],eZ.prototype,"groupService",2),eZ=ez([(0,l.b2)()],eZ);var ej=class extends eZ{init(){this.toDispose.push(this.onNodeAdd(this.handleNodeAdd.bind(this)))}addFromNode(e,t){return this.fixedHistoryService.addFromNode(e,t)}addBlock(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{parent:o,index:i}=n;return this.fixedHistoryService.addBlock(e,t,o,i)}deleteNode(e){let t=this.toNodeEntity(e);t&&this.fixedHistoryService.deleteNode(t)}deleteNodes(e){let t=e.map(e=>"string"==typeof e?this.document.getNode(e):e);return this.fixedHistoryService.deleteNodes(t)}startTransaction(){this.historyService.startTransaction()}endTransaction(){this.historyService.endTransaction()}apply(e){this.historyService.pushOperation(e)}doMoveNode(e,t,n){var o;if(!(null==(o=e.parent)?void 0:o.id))return;let i={nodeIds:[this.toId(e)],fromParentId:e.parent.id,toParentId:this.toId(t),fromIndex:this.getNodeIndex(e),toIndex:n};return this.historyService.pushOperation({type:r.C8.moveChildNodes,value:i})}handleNodeAdd(e){let{data:t}=e,{parent:n,index:o,hidden:i,originParent:l,...d}=t,a={data:d,parentId:null==n?void 0:n.id,index:o,hidden:i};return this.historyService.pushOperation({type:r.C8.addNode,value:a,uri:this.fixedHistoryService.config.getNodeURI(d.id)},{noApply:!0})}};ez([(0,l.f3)(ev)],ej.prototype,"fixedHistoryService",2),ez([(0,l.f3)(eg.qp)],ej.prototype,"historyService",2),ez([(0,l.f3)(r.pQ4)],ej.prototype,"document",2),ez([(0,l.zY)()],ej.prototype,"init",1),ej=ez([(0,l.b2)()],ej);var eQ=(0,s.M1)({onBind:(e,t)=>{var n;let{bind:o}=e;o(eJ).to((null==t||null==(n=t.history)?void 0:n.enable)?ej:eZ).inSingletonScope()},onDispose:e=>{e.container.get(eJ).dispose()}}),eq=(0,eu.forwardRef)(function(e,t){let{parentContainer:n,children:o,...l}=e,d=(0,eu.useMemo)(()=>{var e;return e=l,t=>{var n,o;let l=[eQ(e={...i.DEFAULT,...e})];return l.push((0,r.cL)({registerShortcuts(n){var o;let i=t.get(r.z2R);if(n.addHandlers({commandId:r.mYg.Default.DELETE,shortcuts:["backspace","delete"],isEnabled:()=>i.selection.length>0&&!t.playground.config.readonlyOrDisabled,execute:()=>{let e=i.selection.filter(e=>e instanceof r.GAy);t.get(eJ).deleteNodes(e),i.selection=i.selection.filter(e=>!e.disposed)}}),null==e||null==(o=e.history)?void 0:o.enable){let o=t.get(ev);e.history.disableShortcuts||(n.addHandlers({commandId:r.mYg.Default.UNDO,shortcuts:["meta z","ctrl z"],isEnabled:()=>!0,execute:()=>{o.undo()}}),n.addHandlers({commandId:r.mYg.Default.REDO,shortcuts:["meta shift z","ctrl shift z"],isEnabled:()=>!0,execute:()=>{o.redo()}}))}}}),(0,ec.Y)({canSelect:e=>0===e.button&&!t.get(r.pQ4).renderState.config.nodeHoveredId,...e.selectBox||{}}),ep(e.dragdrop||{})),l=(0,r.Fu1)(e,l)(t),(null==(n=e.variableEngine)?void 0:n.enable)&&l.push((0,r.Ys9)({...e.variableEngine,layout:"fixed"})),(null==(o=e.history)?void 0:o.enable)&&l.push(eK(e.history)),l.push((0,r.d3V)({containerModules:[es],onBind(t){t.isBound(r.h3M)||t.bind(r.h3M).toConstantValue({...r.XsM,defaultLayout:e.defaultLayout,toNodeJSON:t=>(function(e,t){let n,o={};return t.document.traverse(t=>{if(t.id.startsWith("$"))return;let i=t.getData(r.Psq),l=i&&i.formModel&&i.formModel.initialized?i.toJSON():void 0,d={id:t.id,type:t.flowNodeType,data:i?l:t.getExtInfo(),blocks:[]};e.toNodeJSON&&(d=e.toNodeJSON(t,d)),n||(n=d);let{parent:a}=t;a&&a.id.startsWith("$")&&(a=a.originParent);let s=a?o[a.id]:void 0;if(s){var u;null==(u=s.blocks)||u.push(d)}o[t.id]=d},t),n})(e,t),fromNodeJSON:(t,n,o)=>(function(e,t,n,o){n=e.fromNodeJSON?e.fromNodeJSON(t,n,o):n;let i=t.getData(r.Psq);if(i){var l,d,a;let r=null==(d=e.nodeEngine)||null==(l=d.createDefaultFormMeta)?void 0:l.call(d,t),s=(null==(a=t.getNodeRegistry())?void 0:a.formMeta)||r;s&&(o?i.createForm(s,n.data):i.updateFormValues(n.data))}else n.data&&t.updateExtInfo(n.data,!0)})(e,t,n,o),allNodesDefaultExpanded:e.allNodesDefaultExpanded})},onInit:t=>{var n,o,i;t.playground.registerLayers(r.Emw,r.V7e),e.formatNodeLines&&(t.document.options.formatNodeLines=eY([t.document.options.formatNodeLines,e.formatNodeLines])),e.formatNodeLabels&&(t.document.options.formatNodeLabels=eY([t.document.options.formatNodeLabels,e.formatNodeLabels])),(null==(n=e.scroll)?void 0:n.enableScrollLimit)&&t.playground.registerLayer(r.qq0),(null==(o=e.scroll)?void 0:o.disableScrollBar)||t.playground.registerLayer(r.lVg),(null==(i=e.scroll)?void 0:i.disableScroll)&&(t.playground.config.scrollDisable=!0),e.nodeRegistries&&t.document.registerFlowNodes(...e.nodeRegistries)}})),(0,r.esp)(e,l)(t)}},[]),a=(0,eu.useCallback)(e=>({...(0,r.FwO)(e),get document(){return e.get(r.pQ4)},get operation(){return e.get(eJ)},get clipboard(){return e.get(r.YvH)},get selection(){return e.get(r.z2R)},get history(){return e.get(eg.qp)},get tools(){return{fitView:t=>{let n=e.get(r.XQj).config,o=e.get(r.pQ4);return n.fitView(o.root.bounds,t,30)}}}}),[]);return eu.createElement(r.W6u,{ref:t,plugins:d,customPluginContext:a,parentContainer:n},o)});function eW(e){let t=e||(0,eu.useContext)(r.rQR),n=(0,eu.useRef)(),o=t.getData(r.LzJ),{expanded:i,dragging:l,activated:d}=o,{startDrag:a,dragOffset:s}=ey(),u=(0,r.Dcz)(),p=t.flowNodeType===r.SyX.BLOCK_ORDER_ICON,y=t.flowNodeType===r.SyX.BLOCK_ICON,[c,g]=(0,eu.useState)(0),h=(0,eu.useRef)(!1);h.current=!1;let f=(p||y?t.parent:t)||n.current;n.current=f;let L=(0,r.G2Z)(eJ),N=(0,eu.useCallback)(()=>{L.deleteNode(f)},[f,L]),I=(0,eu.useCallback)(e=>{a(e,{dragStartEntity:t},{dragOffsetX:s.x,dragOffsetY:s.y})},[t,a]),C=(0,eu.useCallback)(e=>{o.toggleMouseEnter()},[o]),v=(0,eu.useCallback)(e=>{o.toggleMouseLeave()},[o]),m=(0,eu.useCallback)(()=>{o.toggleExpand()},[o]),x=(0,eu.useCallback)(()=>f.getExtInfo(),[f]),b=(0,eu.useCallback)((e,t)=>{f.updateExtInfo(e,t)},[f]),P=(0,eu.useMemo)(()=>(0,r.CMu)(f),[f]),S=(0,eU.Re)(null==P?void 0:P.state);(0,eu.useEffect)(()=>{let e;return(y||p)&&(e=t.parent.onExtInfoChange(()=>t.renderData.fireChange())),()=>null==e?void 0:e.dispose()},[t,y,p]),(0,eu.useEffect)(()=>{let e=null==P?void 0:P.onFormValuesChange(()=>{h.current&&g(e=>e+1)});return()=>null==e?void 0:e.dispose()},[P]);let E=u.config.readonly;return(0,eu.useMemo)(()=>({id:f.id,type:f.flowNodeType,get data(){if(P)return h.current=!0,P.values;return x()},updateData(e){P?P.updateFormValues(e):b(e,!0)},node:f,isBlockOrderIcon:p,isBlockIcon:y,activated:d,readonly:E,expanded:i,dragging:l,startDrag:I,deleteNode:N,onMouseEnter:C,onMouseLeave:v,getExtInfo:x,updateExtInfo:b,toggleExpand:m,get form(){if(!P)return;return{...P,get values(){return h.current=!0,P.values},get state(){return S}}}}),[f,p,y,d,E,i,l,I,N,C,v,x,b,m,P,S,c])}function e0(e){let{maxZoom:t,minZoom:n}=e||{},o=(0,r.Dcz)(),i=(0,r.KUq)(),l=i.isBound(eg.qp)?i.get(eg.qp):void 0,d=(0,r.G2Z)(r.pQ4),[a,s]=(0,eu.useState)("PAD"),[p,y]=(0,eu.useState)(1),[c,g]=(0,eu.useState)(d.layout),[h,f]=(0,eu.useState)(!1),[L,N]=(0,eu.useState)(!1),I=(0,eu.useCallback)((e,t,n)=>(n=n||30,o.config.fitView(d.root.bounds,e,n,t)),[d,o]),C=(0,eu.useCallback)(e=>{let t=d.getAllNodes();e=e||(d.layout.name===r.XPE.HORIZONTAL_FIXED_LAYOUT?r.XPE.VERTICAL_FIXED_LAYOUT:r.XPE.HORIZONTAL_FIXED_LAYOUT),t.map(e=>{e.getData(r.LzJ).node.classList.add("gedit-transition-ease")}),setTimeout(()=>{I()},10),setTimeout(()=>{t.map(e=>{e.getData(r.LzJ).node.classList.remove("gedit-transition-ease")})},500),d.setLayout(e),g(d.layout)},[d,o]),v=(0,eu.useCallback)(e=>{null==o||o.config.zoomout(e)},[p,o]),m=(0,eu.useCallback)(e=>{null==o||o.config.zoomin(e)},[p,o]),x=(0,eu.useCallback)((e,t,n)=>{o.config.updateZoom(e,t,n)},[o]),b=(0,eu.useCallback)(()=>null==l?void 0:l.undo(),[l]),P=(0,eu.useCallback)(()=>null==l?void 0:l.redo(),[l]);return(0,eu.useEffect)(()=>{let e=new u.K4;return o&&e.push(o.onZoom(e=>y(e))),l&&e.push(l.undoRedoService.onChange(()=>{f(l.canUndo()),N(l.canRedo())})),()=>e.dispose()},[o,l]),(0,eu.useEffect)(()=>{let e=o.config.config;o.config.updateConfig({maxZoom:void 0!==t?t:e.maxZoom,minZoom:void 0!==n?n:e.minZoom})},[o,t,n]),{zoomin:m,zoomout:v,fitView:I,updateZoom:x,zoom:p,isVertical:c.name===r.XPE.VERTICAL_FIXED_LAYOUT,changeLayout:C,canRedo:L,canUndo:h,undo:b,redo:P,interactiveType:a,setInteractiveType:function(e){"MOUSE"===e?o.editorState.changeState(r.yyW.STATE_MOUSE_FRIENDLY_SELECT.id):"PAD"===e&&o.editorState.changeState(r.yyW.STATE_SELECT.id),s(e)}}}function e2(){return(0,r.G2Z)(r.Zn3)}}}]);