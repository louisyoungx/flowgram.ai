"use strict";(self.webpackChunk_flowgram_ai_docs=self.webpackChunk_flowgram_ai_docs||[]).push([["603737"],{562913:function(e,t,o){o.d(t,{Z:()=>i});var n=o(908600);let i=(0,o(524053).A)(function(e){return n.createElement("svg",Object.assign({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,"aria-hidden":!0},e),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M23 12a11 11 0 1 1-22 0 11 11 0 0 1 22 0Zm-11 9a9 9 0 1 0 0-18 9 9 0 0 0 0 18ZM8.11 8.11a1 1 0 0 1 1.42 0L12 10.6l2.47-2.48a1 1 0 1 1 1.42 1.42L13.4 12l2.48 2.47a1 1 0 0 1-1.42 1.42L12 13.4 9.53 15.9a1 1 0 0 1-1.42-1.42L10.6 12 8.1 9.53a1 1 0 0 1 0-1.42Z",fill:"currentColor"}))},"cross_circle_stroked")},144843:function(e,t,o){let n,i,r,s,l;o.r(t),o.d(t,{DemoFreeLayout:()=>ra});var a,d,c,u,p,h,g,m,y,x,f,v,j,C=o(110239),b=o(640898);o(530371),o(187);var N=o(129034),w=((a={}).Start="start",a.End="end",a.LLM="llm",a.HTTP="http",a.Code="code",a.Variable="variable",a.Condition="condition",a.Loop="loop",a.BlockStart="block-start",a.BlockEnd="block-end",a.Comment="comment",a.Continue="continue",a.Break="break",a);let M="data:image/png;base64,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";var A=o(986377),S=o(746640),k=o(769424),T=o(461249);let D=T.ZP.span`
  font-size: 12px;
  color: red;
`,I=T.ZP.span`
  font-size: 12px;
  color: orange;
`,E=e=>{let{errors:t,warnings:o,invalid:n}=e,i=e=>e?e.map(e=>(0,C.jsx)("span",{children:e.message},e.name)):null;return(0,C.jsxs)("div",{children:[(0,C.jsx)("div",{children:(0,C.jsx)(D,{children:i(t)})}),(0,C.jsx)("div",{children:(0,C.jsx)(I,{children:i(o)})})]})};var L=o(908600),P=o(827656),Z=o(330893),z=o(854343),O=o(773898),B=o(893740),R=o(9163),V=o(832176),F=o(336330),Q=o(201063),U=o(579962),H=Object.defineProperty,G=Object.getOwnPropertyDescriptor,J=(e,t,o,n)=>{for(var i,r=n>1?void 0:n?G(t,o):t,s=e.length-1;s>=0;s--)(i=e[s])&&(r=(n?i(t,o,r):i(r))||r);return n&&r&&H(t,o,r),r},Y=async()=>{await (0,F.gw)(20)},q=e=>(null==e?void 0:e.getNodeMeta().isContainer)??!1,X=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0},o=e.node;if(q(o)){let{point:o}=e;return"input"===e.portType?new V.Ae(o.x+t.x,o.y-50+t.y,300,100):new V.Ae(o.x-300,o.y-50,300,100)}return o.getData(U.eG).bounds},W=(e,t)=>void 0!==e&&void 0!==t&&e-t>1e-5,K=(e,t)=>void 0!==e&&void 0!==t&&t-e>1e-5,_=e=>{var t;let{nodeType:o,position:n,fromPort:i,toPort:r,containerNode:s,document:l,dragService:a}=e,d=l.getNodeRegistry(o),c=null==d||null==(t=d.meta)?void 0:t.size,u=n;return u=c?i&&r?{x:n.x,y:n.y-c.height/2}:i&&!r?"bottom"===i.location?{x:n.x,y:n.y}:{x:n.x+c.width/2,y:n.y-c.height/2}:!i&&r?{x:n.x-c.width/2,y:n.y-c.height/2}:n:n,a.adjustSubNodePosition(o,s,u)},$=e=>{var t,o;let{fromPort:n,node:i,toPort:r,linesManager:s}=e,l=i.getData(F.QW);if(!l)return;let a=(null==(t=l.inputPorts)?void 0:t.length)>0;if(n&&a){let e="bottom"===n.location,t=l.inputPorts.find(t=>!e||"top"===t.location)||l.inputPorts[0];s.createLine({from:n.node.id,fromPort:n.portID,to:i.id,toPort:t.portID})}let d=(null==(o=l.outputPorts)?void 0:o.length)>0;if(r&&d){let e=l.outputPorts[0];s.createLine({from:i.id,fromPort:e.portID,to:r.node.id,toPort:r.portID})}},ee=e=>{let{fromPort:t,containerNode:o}=e;if(o)return o;let n=null==t?void 0:t.node,i=null==n?void 0:n.parent;return q(n)?n:i},et=e=>{let{node:t,fromPort:o,toPort:n,linesManager:i,historyService:r,dragService:s,containerNode:l,padding:a={x:100,y:100}}=e,d=(e=>{var t;let{node:o,fromPort:n,toPort:i,padding:r}=e,s=X(n),l=X(i),a=o.getData(U.eG),d=(null==(t=o.getNodeMeta())?void 0:t.size)??{width:a.bounds.width,height:a.bounds.height},c={x:d.width+r.x,y:d.height+r.y},u=((e,t)=>{let o=Math.abs(Math.min(e.right,t.right)-Math.max(e.left,t.left)),n=Math.abs(Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top));return V.Ae.intersects(e,t)?{x:-o,y:-n}:{x:o,y:n}})(s,l),p={x:W(u.x,c.x)?0:c.x-u.x,y:W(u.y,c.y)?0:c.y-u.y};if(0===p.x||0===p.y)return;let h={vertical:V.Ae.intersects(s,l,"horizontal"),horizontal:V.Ae.intersects(s,l,"vertical")},g=0,m=0;return!h.horizontal&&(W(l.center.y,s.center.y)?m=p.y:K(l.center.y,s.center.y)&&(m=-p.y)),!h.vertical&&(W(l.center.x,s.center.x)?g=p.x:K(l.center.x,s.center.x)&&(g=-p.x)),{x:g,y:m}})({node:t,fromPort:o,toPort:n,padding:a});(e=>{let{node:t,subsequentNodes:o,fromPort:n,toPort:i,containerNode:r,offset:s,historyService:l,dragService:a}=e;if(!s||!i)return;let d=o.map(e=>{let t=e.getData(B.VO);return{x:t.position.x,y:t.position.y}});l.pushOperation({type:Q.Nj.dragNodes,value:{ids:o.map(e=>e.id),value:d.map(e=>({x:e.x+s.x,y:e.y+s.y})),oldValue:d}});let c=X(n),u=X(i,s),p=t.getData(B.VO),h={x:(c.center.x+u.center.x)/2,y:(c.y+u.y)/2};r&&(h=a.adjustSubNodePosition(t.flowNodeType,r,h)),l.pushOperation({type:Q.Nj.dragNodes,value:{ids:[t.id],value:[h],oldValue:[{x:p.position.x,y:p.position.y}]}})})({node:t,subsequentNodes:(e=>{var t;let{node:o,linesManager:n}=e;if(q(o))return[];let i=(null==(t=o.parent)?void 0:t.blocks)??[],r=new Set,s=new Map;n.getAllAvailableLines().forEach(e=>{var t,o;s.has(e.from.id)||s.set(e.from.id,[]),!(null==(t=e.to)?void 0:t.id)||q(e.to)||null==(o=s.get(e.from.id))||o.push(e.to.id)});let l=e=>{r.has(e)||(r.add(e),(s.get(e)??[]).forEach(l))};return l(o.id),i.filter(e=>r.has(e.id))})({node:n.node,linesManager:i}),fromPort:o,toPort:n,containerNode:l,offset:d,historyService:r,dragService:s})},eo=class{dispose(){this.toDispose.dispose()}setCallNodePanel(e){this.callNodePanel=e}async call(e){let{panelPosition:t,fromPort:o,enableMultiAdd:n=!1,panelProps:i={},containerNode:r,afterAddNode:s}=e;if(!t||this.playgroundConfig.readonly)return;let l=[];return new Promise(a=>{this.callNodePanel({position:t,enableMultiAdd:n,panelProps:i,containerNode:ee({fromPort:o,containerNode:r}),onSelect:async t=>{let o=await this.addNode(e,t);null==s||s(o),n?o&&l.push(o):a(o)},onClose:()=>{a(n?l:void 0)}})})}async singleSelectNodePanel(e){return new Promise(t=>{this.callNodePanel({...e,enableMultiAdd:!1,onSelect:async e=>{t(e)},onClose:()=>{t(void 0)}})})}async addNode(e,t){let{panelPosition:o,fromPort:n,toPort:i,canAddNode:r,autoOffsetPadding:s={x:100,y:100},enableBuildLine:l=!1,enableSelectPosition:a=!1,enableAutoOffset:d=!1,enableDragNode:c=!1}=e;if(!o||!t)return;let{nodeType:u,selectEvent:p,nodeJSON:h}=t,g=ee({fromPort:n,containerNode:e.containerNode});if(r&&!r({nodeType:u,containerNode:g}))return;let m=this.playgroundConfig.getPosFromMouseEvent(p),y=e.customPosition?e.customPosition({nodeType:u,selectPosition:m}):_({nodeType:u,position:a?m:o,fromPort:n,toPort:i,containerNode:g,document:this.document,dragService:this.dragService}),x=this.document.createWorkflowNodeByType(u,y,h??{},null==g?void 0:g.id);if(x)return d&&n&&i&&et({node:x,fromPort:n,toPort:i,padding:s,containerNode:g,historyService:this.historyService,dragService:this.dragService,linesManager:this.linesManager}),(l||c)&&(await Y(),l&&$({fromPort:n,node:x,toPort:i,linesManager:this.linesManager}),c&&(this.selectService.selectNode(x),this.dragService.startDragSelectedNodes(p))),x}constructor(){this.toDispose=new V.K4,this.callNodePanel=async()=>void 0}};J([(0,R.f3)(F.L4)],eo.prototype,"document",2),J([(0,R.f3)(F.iw)],eo.prototype,"dragService",2),J([(0,R.f3)(F.oJ)],eo.prototype,"selectService",2),J([(0,R.f3)(F.dm)],eo.prototype,"linesManager",2),J([(0,R.f3)(B.ER)],eo.prototype,"playgroundConfig",2),J([(0,R.f3)(Q.qp)],eo.prototype,"historyService",2),eo=J([(0,R.b2)()],eo);var en=class extends B.mh{onReady(){this.service.setCallNodePanel(this.call.bind(this))}onZoom(e){this.node.style.transform=`scale(${e})`}render(){let e=this.options.renderer;return L.createElement(L.Fragment,null,Array.from(this.renderList.keys()).map(t=>{let o=this.renderList.get(t);return L.createElement(e,{key:t,...o})}))}async call(e){let t=(0,F.x0)(),{onSelect:o,onClose:n,enableMultiAdd:i=!1,panelProps:r={}}=e;return new Promise(s=>{let l=()=>{this.renderList.delete(t),this.render(),s()},a={...e,panelProps:r,onSelect:e=>{o(e),i||l()},onClose:()=>{l(),n()}};this.renderList.set(t,a),this.render()})}constructor(){super(),this.node=V.xF.createDivWithClass("gedit-playground-layer gedit-node-panel-layer"),this.node.style.zIndex="9999",this.renderList=new Map}};en.type="WorkflowNodePanelLayer",J([(0,R.f3)(eo)],en.prototype,"service",2);var ei=(0,B.M1)({onBind(e){let{bind:t}=e;t(eo).toSelf().inSingletonScope()},onInit:(e,t)=>{e.playground.registerLayer(en,{renderer:t.renderer})},onDispose:e=>{e.get(eo).dispose()}}),er=o(697495),es=o(148168),el=o(438024),ea=o(661881),ed=o(569517),ec=o(27430),eu=Object.defineProperty,ep=Object.getOwnPropertyDescriptor,eh=(e,t,o,n)=>{for(var i,r=n>1?void 0:n?ep(t,o):t,s=e.length-1;s>=0;s--)(i=e[s])&&(r=(n?i(t,o,r):i(r))||r);return n&&r&&eu(t,o,r),r},eg=((d=eg||{}).In="in",d.Out="out",d),em=async()=>{await new Promise(e=>requestAnimationFrame(e))},ey=e=>(null==e?void 0:e.getNodeMeta().isContainer)??!1,ex=e=>e.filter(e=>e.originParent?e.getNodeMeta().selectable&&e.originParent.getNodeMeta().selectable:e.getNodeMeta().selectable).filter(e=>ey(e)).sort((e,t)=>{let o=e.renderData.stackIndex;return t.renderData.stackIndex-o}).map(e=>e.transform),ef=e=>{let{targetRect:t,targetPoint:o,transforms:n,withPadding:i=!1,document:r}=e;return n.find(e=>{let{bounds:n,entity:s}=e,l=i?r.layout.getPadding(s):{left:0,right:0},a=new V.Ae(n.x+l.left+l.right,n.y,n.width,n.height);if(t){let e=t.right>a.left&&t.left<a.right,o=t.bottom>a.top&&t.top<a.bottom;return e&&o}if(o)return o.x>=a.left&&o.x<=a.right&&o.y>=a.top&&o.y<=a.bottom;return!1})},ev=class{init(){this.initState(),this.toDispose.push(this.emitter)}ready(){this.toDispose.push(this.listenDragToContainer())}dispose(){this.initState(),this.toDispose.dispose()}async moveOutContainer(e){var t;let{node:o}=e,n=o.parent,i=null==n?void 0:n.parent,r=this.document.toNodeJSON(o);if(!n||!i||!ey(n)||!(null==(t=r.meta)?void 0:t.position))return;let s=n.getData(B.VO);this.operationService.moveNode(o,{parent:i}),await em(),s.fireChange(),this.operationService.updateNodePosition(o,{x:s.position.x+r.meta.position.x,y:s.position.y+r.meta.position.y}),this.emitter.fire({type:"out",node:o,sourceContainer:n,targetContainer:i})}canMoveOutContainer(e){let t=e.parent,o=null==t?void 0:t.parent;return!!t&&!!o&&!!ey(t)&&!!this.dragService.canDropToNode({dragNodeType:e.flowNodeType,dragNode:e,dropNodeType:null==o?void 0:o.flowNodeType,dropNode:o}).allowDrop}async clearInvalidLines(e){var t;let{dragNode:o,sourceParent:n}=e;o&&o.parent!==n&&(null==(t=o.parent)?void 0:t.flowNodeType)!==U.Sy.GROUP&&(null==n?void 0:n.flowNodeType)!==U.Sy.GROUP&&await this.removeNodeLines(o)}async removeNodeLines(e){this.linesManager.getAllLines().forEach(t=>{var o,n;((null==(o=t.from)?void 0:o.id)===e.id||(null==(n=t.to)?void 0:n.id)===e.id)&&t.dispose()}),await em()}initState(){this.state={isDraggingNode:!1,isSkipEvent:!1,transforms:void 0,dragNode:void 0,dropNode:void 0,sourceParent:void 0}}listenDragToContainer(){let e=e=>this.draggingNode(e),t=(0,ea.Z)(e,200);return this.dragService.onNodesDrag(async o=>{if(1===this.selectService.selectedNodes.length){if("onDragStart"===o.type){var n;if(this.state.isSkipEvent){this.state.isSkipEvent=!1;return}this.historyService.startTransaction(),this.state.isDraggingNode=!0,this.state.transforms=ex(this.document.getAllNodes()),this.state.dragNode=this.selectService.selectedNodes[0],this.state.dropNode=void 0,this.state.sourceParent=null==(n=this.state.dragNode)?void 0:n.parent,await this.dragOutContainer(o)}if("onDragging"===o.type&&t(o),"onDragEnd"===o.type){if(this.state.isSkipEvent)return;t.cancel(),e(o),await this.dropNodeToContainer(),await this.clearInvalidLines({dragNode:this.state.dragNode,sourceParent:this.state.sourceParent}),this.setDropNode(void 0),this.initState(),this.historyService.endTransaction()}}})}async dragOutContainer(e){let{dragNode:t}=this.state;(e.triggerEvent.metaKey||e.triggerEvent.ctrlKey)&&t&&this.canMoveOutContainer(t)&&(this.moveOutContainer({node:t}),this.state.isSkipEvent=!0,e.dragger.stop(e.dragEvent.clientX,e.dragEvent.clientY),await em(),this.dragService.startDragSelectedNodes(e.triggerEvent))}setDropNode(e){var t,o,n,i;if(this.state.dropNode===e)return;if(this.state.dropNode){let e=null==(i=this.state.dropNode.getData(U.Lz).node)||null==(n=i.children)?void 0:n[0];e&&e.classList.remove("selected")}if(this.state.dropNode=e,!e)return;let r=null==(o=e.getData(U.Lz).node)||null==(t=o.children)?void 0:t[0];r&&r.classList.add("selected")}async dropNodeToContainer(){let{dropNode:e,dragNode:t,isDraggingNode:o}=this.state;if(o&&t&&e)return await this.moveIntoContainer({node:t,containerNode:e})}draggingNode(e){let{dragNode:t,isDraggingNode:o,transforms:n=[]}=this.state;if(!o||!t||!(null==n?void 0:n.length))return this.setDropNode(void 0);let i=this.playgroundConfig.getPosFromMouseEvent(e.dragEvent),r=ef({targetPoint:i,transforms:n.filter(e=>e.entity.id!==t.id),document:this.document}),s=null==r?void 0:r.entity;return this.canDropToContainer({dragNode:t,dropNode:s})?this.setDropNode(s):this.setDropNode(void 0)}canDropToContainer(e){let{dragNode:t,dropNode:o}=e,n=null==o?void 0:o.getNodeMeta().isContainer;return!(!o||!n||this.isParent(t,o)||this.isParent(o,t))&&(t.flowNodeType!==U.Sy.GROUP||o.flowNodeType===U.Sy.GROUP)&&!!this.dragService.canDropToNode({dragNodeType:t.flowNodeType,dropNodeType:null==o?void 0:o.flowNodeType,dragNode:t,dropNode:o}).allowDrop}isParent(e,t){let o=e.parent;for(;o;){if(o.id===t.id)return!0;o=o.parent}return!1}async moveIntoContainer(e){let{node:t,containerNode:o}=e,n=t.parent;this.operationService.moveNode(t,{parent:o});let i=this.document.layout.getPadding(o),r=(e=>{let{targetNode:t,containerNode:o,containerPadding:n}=e;if(o.flowNodeType===U.Sy.ROOT)return t.transform.position;let i=t.transform.transform.worldTransform,r=o.transform.transform.worldTransform,s={x:i.tx,y:i.ty};return o.children&&0!==o.children.length?{x:s.x-r.tx,y:s.y-r.ty}:{x:0,y:n.top}})({targetNode:t,containerNode:o,containerPadding:i});this.operationService.updateNodePosition(t,r),await em(),this.emitter.fire({type:"in",node:t,sourceContainer:n,targetContainer:o})}constructor(){this.emitter=new V.Q5,this.toDispose=new V.K4,this.on=this.emitter.event}};eh([(0,R.f3)(F.iw)],ev.prototype,"dragService",2),eh([(0,R.f3)(F.L4)],ev.prototype,"document",2),eh([(0,R.f3)(B.ER)],ev.prototype,"playgroundConfig",2),eh([(0,R.f3)(F.xV)],ev.prototype,"operationService",2),eh([(0,R.f3)(F.dm)],ev.prototype,"linesManager",2),eh([(0,R.f3)(Q.qp)],ev.prototype,"historyService",2),eh([(0,R.f3)(F.oJ)],ev.prototype,"selectService",2),ev=eh([(0,R.b2)()],ev);var ej=(0,B.M1)({onBind:e=>{let{bind:t}=e;t(ev).toSelf().inSingletonScope()},onInit(e,t){e.get(ev).init()},onReady(e,t){!0!==t.disableNodeIntoContainer&&e.get(ev).ready()},onDispose(e){e.get(ev).dispose()}}),eC=()=>{let e=(0,F.PF)(),{size:t={width:300,height:200},isContainer:o}=e.getNodeMeta(),n=e.getData(U.eG),[i,r]=(0,L.useState)(t.width),[s,l]=(0,L.useState)(t.height),a=()=>{if(0===e.blocks.length){r(t.width),l(t.height);return}r(n.bounds.width),l(n.bounds.height)};if((0,L.useEffect)(()=>{let t=n.onDataChange(()=>{a(),e.getData(F.QW).updateDynamicPorts()});return()=>t.dispose()},[n,i,s]),(0,L.useEffect)(()=>{a()},[]),o)return{width:i,height:s}},eb=T.ZP.div`
  width: 100%;
  height: 100%;
  inset: 56px 18px 18px;
  /* 背景色现在通过 style 属性动态设置 */
`,eN=()=>{let e=(0,F.PF)(),t={};try{t=(0,B.G2)(ed.Xm)}catch(e){}let o=t.gridSize??20,n=t.dotSize??1,i=t.dotColor??"#eceeef",r=t.dotOpacity??.5,s=t.backgroundColor??"#f2f3f5",l=t.dotFillColor===i?"":t.dotFillColor,a=`sub-canvas-dot-pattern-${e.id}`;return L.createElement(eb,{className:"sub-canvas-background","data-flow-editor-selectable":"true",style:{backgroundColor:s}},L.createElement("svg",{width:"100%",height:"100%"},L.createElement("pattern",{id:a,width:o,height:o,patternUnits:"userSpaceOnUse"},L.createElement("circle",{cx:n,cy:n,r:n,stroke:i,fill:l,fillOpacity:r})),L.createElement("rect",{width:"100%",height:"100%",fill:`url(#${a})`,"data-node-panel-container":e.id})))},ew=T.ZP.div`
  pointer-events: none;

  position: relative;

  display: flex;
  align-items: center;

  width: 100%;
  height: 100%;

  background-color: transparent;
  border: 1px solid var(--coz-stroke-plus, rgba(6, 7, 9, 15%));
  border-color: var(--coz-bg-plus, rgb(249, 249, 249));
  border-style: solid;
  border-width: 8px;
  border-radius: 8px;

  &::before {
    content: '';

    position: absolute;
    z-index: 0;
    inset: -4px;

    background-color: transparent;
    border-color: var(--coz-bg-plus, rgb(249, 249, 249));
    border-style: solid;
    border-width: 4px;
    border-radius: 8px;
  }
`,eM=e=>{let{style:t,children:o}=e;return L.createElement(ew,{className:"sub-canvas-border",style:{...t}},o)},eA=T.ZP.div`
  width: 100%;
  height: 100%;
`,eS="workflow-move-into-sub-canvas-tip-visible",ek="false",eT=class e{static get instance(){return this._instance||(this._instance=new e),this._instance}isClosed(){return this.isCloseForever()||this.closed}close(){this.closed=!0}isCloseForever(){return localStorage.getItem(eS)===ek}closeForever(){localStorage.setItem(eS,ek)}constructor(){this.closed=!1}},eD=T.ZP.div`
  pointer-events: auto;
  position: absolute;
  top: 0;

  width: 100%;
  height: 28px;

  .container {
    height: 100%;
    background-color: #e4e6f5;
    border-radius: 4px 4px 0 0;

    .content {
      overflow: hidden;
      display: inline-flex;
      align-items: center;
      justify-content: center;

      width: 100%;
      height: 100%;

      .text {
        font-size: 14px;
        font-weight: 400;
        font-style: normal;
        line-height: 20px;
        color: rgba(15, 21, 40, 82%);
        text-overflow: ellipsis;
      }

      .custom-content {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 100%;
        height: 100%;

        /* 为自定义内容提供默认样式，但允许覆盖 */
        font-size: 14px;
        font-weight: 400;
        line-height: 20px;
        color: rgba(15, 21, 40, 82%);

        /* 确保自定义内容不会超出容器 */
        overflow: hidden;
      }

      .space {
        width: 128px;
      }
    }

    .actions {
      position: absolute;
      top: 0;
      right: 0;

      display: flex;
      gap: 8px;
      align-items: center;

      height: 28px;
      padding: 0 16px;

      .close-forever {
        cursor: pointer;

        padding: 0 3px;

        font-size: 12px;
        font-weight: 400;
        font-style: normal;
        line-height: 12px;
        color: rgba(32, 41, 69, 62%);
      }

      .close {
        display: flex;
        cursor: pointer;
        height: 100%;
        align-items: center;
      }
    }
  }
`,eI=/(Macintosh|MacIntel|MacPPC|Mac68K|iPad)/.test(navigator.userAgent),eE=()=>L.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"none",viewBox:"0 0 16 16"},L.createElement("path",{fill:"#060709",fillOpacity:"0.5",d:"M12.13 12.128a.5.5 0 0 0 .001-.706L8.71 8l3.422-3.423a.5.5 0 0 0-.001-.705.5.5 0 0 0-.706-.002L8.002 7.293 4.579 3.87a.5.5 0 0 0-.705.002.5.5 0 0 0-.002.705L7.295 8l-3.423 3.422a.5.5 0 0 0 .002.706c.195.195.51.197.705.001l3.423-3.422 3.422 3.422c.196.196.51.194.706-.001"})),eL=e=>{let{tipText:t,neverRemindText:o}=e,{visible:n,close:i,closeForever:r}=(()=>{let e=(0,F.PF)(),[t,o]=(0,L.useState)(!1),n=eT.instance,i=(0,B.G2)(ev),r=(0,L.useCallback)(()=>{n.isClosed()||o(!0)},[n]),s=(0,L.useCallback)(()=>{n.close(),o(!1)},[n]),l=(0,L.useCallback)(()=>{n.closeForever(),s()},[s,n]);return(0,L.useEffect)(()=>{let t=i.on(t=>{"in"===t.type&&t.targetContainer===e&&r()}),n=i.on(t=>{"out"===t.type&&(t.sourceContainer!==e||e.blocks.length||o(!1))});return()=>{t.dispose(),n.dispose()}},[i,e,r,s,t]),{visible:t,close:s,closeForever:l}})(),s=t||ec.o.t("Hold {{key}} to drag node out",{key:eI?"Cmd ⌘":"Ctrl"});return n?L.createElement(eD,{className:"sub-canvas-tips"},L.createElement("div",{className:"container"},L.createElement("div",{className:"content"},"string"==typeof s?L.createElement("p",{className:"text"},s):L.createElement("div",{className:"custom-content"},s),L.createElement("div",{className:"space",style:{width:0}})),L.createElement("div",{className:"actions"},L.createElement("p",{className:"close-forever",onClick:r},o||ec.o.t("Never Remind")),L.createElement("div",{className:"close",onClick:i},L.createElement(eE,null))))):null},eP=e=>{let{className:t,style:o,offsetY:n=0,tipText:i}=e,r=eC(),s=(null==r?void 0:r.height)??0,l=(0,F.PF)();return(0,L.useLayoutEffect)(()=>{r&&(l.renderData.node.style.width=r.width+"px",l.renderData.node.style.height=r.height+"px")},[null==r?void 0:r.width,null==r?void 0:r.height]),L.createElement(eA,{className:`sub-canvas-render ${t??""}`,style:{height:s+n,...o},"data-flow-editor-selectable":"true",onDragStart:e=>{e.stopPropagation()}},L.createElement(eM,null,L.createElement(eN,null),L.createElement(eL,{tipText:i})))},eZ=Object.defineProperty,ez=Object.getOwnPropertyDescriptor,eO=(e,t,o,n)=>{for(var i,r=n>1?void 0:n?ez(t,o):t,s=e.length-1;s>=0;s--)(i=e[s])&&(r=(n?i(t,o,r):i(r))||r);return n&&r&&eZ(t,o,r),r};(f||(f={})).validate=e=>{if(!e||!Array.isArray(e)||0===e.length||e.some(e=>e.flowNodeType===U.Sy.GROUP)||e.some(e=>{var t;return e&&(null==e||null==(t=e.parent)?void 0:t.flowNodeType)===U.Sy.GROUP}))return!1;let t=e[0].parent;return!!e.every(e=>e.parent===t)};var eB=Symbol("WorkflowGroupPluginOptions"),eR=class extends U.QU{ready(){this.toDispose.push(this.listenContainer())}dispose(){this.toDispose.dispose()}createGroup(e){var t;if(!f.validate(e))return;let o=e[0].parent??this.document.root,n=this.document.getNodeRegistry(U.Sy.GROUP),i=null==n||null==(t=n.onAdd)?void 0:t.call(n,this.context);this.opts.initGroupJSON&&(i=this.opts.initGroupJSON(i,e)),this.historyService.startTransaction(),this.document.createWorkflowNodeByType(U.Sy.GROUP,{x:0,y:0},i,o.id),e.forEach(e=>{this.freeOperationService.moveNode(e,{parent:i.id})}),this.historyService.endTransaction()}ungroup(e){let t=e.blocks.slice();if(!e.parent)return;let o=e.transform.position;this.historyService.startTransaction(),t.forEach(t=>{var o;this.freeOperationService.moveNode(t,{parent:null==(o=e.parent)?void 0:o.id})}),e.dispose(),t.forEach(e=>{let t=e.getData(B.VO),n={x:t.position.x+o.x,y:t.position.y+o.y};this.freeOperationService.updateNodePosition(e,n)}),this.historyService.endTransaction()}listenContainer(){return this.nodeIntoContainerService.on(e=>{var t,o;e.type===eg.Out&&(null==(t=e.sourceContainer)?void 0:t.flowNodeType)===U.Sy.GROUP&&(null==(o=e.sourceContainer)?void 0:o.blocks.length)===0&&e.sourceContainer.dispose()})}constructor(){super(...arguments),this.toDispose=new V.K4}};eO([(0,R.f3)(F.L4)],eR.prototype,"document",2),eO([(0,R.f3)(F.xV)],eR.prototype,"freeOperationService",2),eO([(0,R.f3)(Q.qp)],eR.prototype,"historyService",2),eO([(0,R.f3)(ev)],eR.prototype,"nodeIntoContainerService",2),eO([(0,R.f3)(eB)],eR.prototype,"opts",2),eO([(0,R.f3)(b.bQo)],eR.prototype,"context",2),eR=eO([(0,R.b2)()],eR);var eV=((c=eV||{}).Group="group",c.Ungroup="ungroup",c),eF=class{async execute(){this.groupService.createGroup(this.selectService.selectedNodes),this.selectService.clear()}constructor(e){this.commandId="group",this.commandDetail={label:"Group"},this.shortcuts=["meta g","ctrl g"],this.selectService=e.get(F.oJ),this.groupService=e.get(eR),this.execute=this.execute.bind(this)}},eQ=class{async execute(e){let t=e||this.selectService.activatedNode;t&&t.flowNodeType===U.Sy.GROUP&&(this.groupService.ungroup(t),this.selectService.clear())}constructor(e){this.commandId="ungroup",this.commandDetail={label:"Ungroup"},this.shortcuts=["meta shift g","ctrl shift g"],this.selectService=e.get(F.oJ),this.groupService=e.get(eR),this.execute=this.execute.bind(this)}},eU={type:U.Sy.GROUP,meta:{renderKey:U.Sy.GROUP,defaultPorts:[],isContainer:!0,disableSideBar:!0,size:{width:560,height:400},padding:()=>({top:80,bottom:40,left:65,right:65}),selectable:(e,t)=>!t||!e.getData(U.eG).bounds.contains(t.x,t.y),expandable:!1},formMeta:{render:()=>React.createElement(React.Fragment,null)},onAdd:()=>({type:U.Sy.GROUP,id:`group_${(0,F.x0)(5)}`,meta:{position:{x:0,y:0}},data:{}})},eH=(0,B.M1)({onBind(e,t){let{bind:o,rebind:n}=e;o(eR).toSelf().inSingletonScope(),o(eB).toConstantValue(t),n(U.QU).toService(eR)},onInit(e,t){let{groupNodeRender:o,disableGroupShortcuts:n=!1}=t;o&&e.get(el.Rf).registerReactComponent(U.Sy.GROUP,o),n||e.get(es.Kg).addHandlers(new eF(e),new eQ(e));let i=e.get(F.L4);i.getNodeRegistry(U.Sy.GROUP)||i.registerFlowNodes(eU)},onReady(e){e.get(eR).ready()},onDispose(e){e.get(eR).dispose()}});let eG=async(e,t)=>{let o=e.get(eo),n=e.document,i=e.get(b.iwM),r=e.get(b.dmf),{fromPort:s,toPort:l,mousePos:a,line:d,originLine:c}=t;if(c||!d||l||!s)return;let u=s.node.parent,p="bottom"===s.location,h=await o.singleSelectNodePanel({position:p?{x:a.x-165,y:a.y+60}:a,containerNode:u,panelProps:{enableNodePlaceholder:!0,enableScrollClose:!0,fromPort:s}});if(!h)return;let{nodeType:g,nodeJSON:m}=h,y=_({nodeType:g,position:a,fromPort:s,toPort:l,containerNode:u,document:n,dragService:i}),x=n.createWorkflowNodeByType(g,y,m??{},null==u?void 0:u.id);await (0,b.gw0)(20),$({fromPort:s,node:x,linesManager:r})};function eJ(e,t){return!([w.Start,w.End,w.BlockStart,w.BlockEnd].includes(e)||[w.Continue,w.Break].includes(e)&&t!==w.Loop)&&(e!==w.Loop||t!==w.Loop)}let eY="flowgram-workflow-clipboard-data";var eq=((u={}).COPY="COPY",u.PASTE="PASTE",u.CUT="CUT",u.GROUP="GROUP",u.UNGROUP="UNGROUP",u.COLLAPSE="COLLAPSE",u.EXPAND="EXPAND",u.DELETE="DELETE",u.ZOOM_IN="ZOOM_IN",u.ZOOM_OUT="ZOOM_OUT",u.RESET_ZOOM="RESET_ZOOM",u.SELECT_ALL="SELECT_ALL",u.CANCEL_SELECT="CANCEL_SELECT",u);class eX{async execute(){this.playgroundConfig.zoom>1.9||this.playgroundConfig.zoomout()}constructor(e){this.commandId=eq.ZOOM_OUT,this.shortcuts=["meta -","ctrl -"],this.playgroundConfig=e.get(b.ERL),this.execute=this.execute.bind(this)}}class eW{async execute(){this.playgroundConfig.zoom>1.9||this.playgroundConfig.zoomin()}constructor(e){this.commandId=eq.ZOOM_IN,this.shortcuts=["meta =","ctrl ="],this.playgroundConfig=e.get(b.ERL),this.execute=this.execute.bind(this)}}class eK{async execute(){let e=this.document.getAllNodes();this.playground.selectionService.selection=e}constructor(e){this.commandId=eq.SELECT_ALL,this.shortcuts=["meta a","ctrl a"],this.document=e.get(b.L4w),this.playground=e.playground,this.execute=this.execute.bind(this)}}var e_=o(653378);!function(e){e.traverseNodes=(o,n)=>{let{value:i}=o;if(i){if("[object Object]"===Object.prototype.toString.call(i))Object.entries(i).forEach(t=>{let[r,s]=t;return e.traverseNodes({value:s,container:i,key:r,parent:o},n)});else if(Array.isArray(i))for(let t=i.length-1;t>=0;t--){let r=i[t];e.traverseNodes({value:r,container:i,index:t,parent:o},n)}n(t({node:o}))}};let t=e=>{let{node:t}=e;return{node:t,setValue:e=>o(t,e),getParents:()=>n(t),getPath:()=>i(t),getStringifyPath:()=>r(t),deleteSelf:()=>s(t)}},o=(e,t)=>{if(!t||!e)return;e.value=t;let{container:o,key:n,index:i}=e;n&&o?o[n]=t:"number"==typeof i&&(o[i]=t)},n=e=>{let t=[],o=e;for(;o;)t.unshift(o),o=o.parent;return t},i=e=>{let t=[];return n(e).forEach(e=>{e.key?t.unshift(e.key):e.index&&t.unshift(e.index)}),t},r=e=>i(e).reduce((e,t)=>"string"!=typeof t?`${e}[${t}]`:/\W/g.test(t)?`${e}["${t}"]`:`${e}.${t}`,""),s=e=>{let{container:t,key:o,index:n}=e;o&&t?delete t[o]:"number"==typeof n&&t.splice(n,1)}}(v||(v={}));var e$=j||(j={});let e0=(0,N.kP)("1234567890",6);e$.getAllNodeIds=e=>{let t=new Set,o=e=>{var n;t.add(e.id),(null==(n=e.blocks)?void 0:n.length)&&e.blocks.forEach(e=>o(e))};return e.nodes.forEach(e=>o(e)),Array.from(t)},e$.generateNodeReplaceMap=(e,t)=>{let o=new Map;return e.forEach(e=>{if(t(e))o.set(e,e);else{let n;do n=e0();while(!t(n));o.set(e,n)}}),o},e$.replaceNodeId=(e,t)=>(((e,t)=>{let o=Array.isArray(t)?e=>{t.forEach(t=>t(e))}:t;return v.traverseNodes({value:e},o)})(e,e=>{if(!(e=>{var t,o,n,i,r,s,l;let{node:a}=e;return!!((null==a?void 0:a.key)&&["sourceNodeID","targetNodeID"].includes(a.key))&&(null==(o=a.parent)||null==(t=o.parent)?void 0:t.key)==="edges"||(null==a?void 0:a.key)==="id"&&null!=(null==(n=a.container)?void 0:n.type)&&null!=(null==(i=a.container)?void 0:i.meta)&&null!=(null==(r=a.container)?void 0:r.data)||(null==a?void 0:a.key)==="blockID"&&null!=(null==(s=a.container)?void 0:s.name)&&(null==(l=a.container)?void 0:l.source)==="block-output"})(e))return;let{node:o}=e;t.has(o.value)&&e.setValue(t.get(o.value))}),e);class e1{async execute(){if(this.readonly)return;let e=await this.tryReadClipboard();if(!e||!this.isValidData(e))return;let t=this.apply(e);return t.length>0&&(e_.Toast.success({content:"Copy successfully",showClose:!1}),await this.nextTick(),this.scrollNodesToView(t)),t}apply(e){let{json:t}=e,o=(e=>{let{json:t,isUniqueId:o}=e,n=j.getAllNodeIds(t),i=j.generateNodeReplaceMap(n,o);return j.replaceNodeId(t,i)})({json:t,isUniqueId:e=>!this.entityManager.getEntityById(e)}),n=this.calcPasteOffset(e.bounds),i=this.getSelectedContainer();i&&o.nodes.some(e=>!eJ(e.type,i.flowNodeType))&&(i=void 0),this.applyOffset({json:o,offset:n,parent:i});let{nodes:r}=this.document.batchAddFromJSON(o,{parent:i});return this.selectNodes(r),this.playground.node.focus(),r}get readonly(){return this.playgroundConfig.readonly}isValidData(e){if((null==e?void 0:e.type)!==eY)return e_.Toast.error({content:"Invalid clipboard data"}),!1;if(e.source.host!==window.location.host)return e_.Toast.error({content:"Cannot paste nodes from different host"}),!1;let t=this.getSelectedContainer();for(let o of e.json.nodes){let e=this.dragService.canDropToNode({dragNodeType:o.type,dropNodeType:null==t?void 0:t.flowNodeType,dropNode:t});if(!e.allowDrop)return e_.Toast.error({content:e.message??"Cannot paste nodes to invalid container"}),!1}return!0}async tryReadClipboard(){try{let e=await navigator.clipboard.readText()||"";return JSON.parse(e)}catch(e){return}}calcPasteOffset(e){let{x:t,y:o,width:n,height:i}=e,{center:r}=new b.AeJ(t,o,n,i),s=this.hoverService.hoveredPos;return{x:s.x-r.x,y:s.y-r.y}}applyOffset(e){let{json:t,offset:o,parent:n}=e;t.nodes.forEach(e=>{var t;if(!(null==(t=e.meta)?void 0:t.position))return;let i={x:e.meta.position.x+o.x,y:e.meta.position.y+o.y};n&&(i=this.dragService.adjustSubNodePosition(e.type,n,i)),e.meta.position=i})}getSelectedContainer(){let{activatedNode:e}=this.selectService;return(null==e?void 0:e.getNodeMeta().isContainer)?e:void 0}selectNodes(e){this.selectService.selection=e}async scrollNodesToView(e){let t=e.map(e=>e.getData(b.eGM).bounds);await this.document.playgroundConfig.scrollToView({bounds:b.AeJ.enlarge(t)})}async nextTick(){await (0,b.gw0)(16),await new Promise(e=>requestAnimationFrame(e))}constructor(e){this.commandId=eq.PASTE,this.shortcuts=["meta v","ctrl v"],this.playgroundConfig=e.playground.config,this.document=e.get(b.L4w),this.selectService=e.get(b.oJU),this.entityManager=e.get(b.v2K),this.hoverService=e.get(b.XHk),this.dragService=e.get(b.iwM),this.playground=e.playground,this.execute=this.execute.bind(this)}}class e2{async execute(){this.selectService.selectedNodes.forEach(e=>{e.renderData.expanded=!0})}constructor(e){this.commandId=eq.EXPAND,this.commandDetail={label:"Expand"},this.shortcuts=["meta alt closebracket","ctrl alt openbracket"],this.selectService=e.get(b.oJU),this.execute=this.execute.bind(this)}}class e3{async execute(e){if(this.readonly)return;let t=Array.isArray(e)?e:this.selectService.selection;this.isValid(t.filter(e=>e instanceof b.CTO))&&(this.historyService.startTransaction(),t.forEach(e=>{e instanceof b.CTO?this.removeNode(e):e instanceof b.e2M?this.removeLine(e):e.dispose()}),this.selectService.selection=this.selectService.selection.filter(e=>!e.disposed),this.historyService.endTransaction())}get readonly(){return this.playgroundConfig.readonly}isValid(e){return!e.some(e=>[w.Start,w.End].includes(e.flowNodeType))||(e_.Toast.error({content:"Start or End node cannot be deleted",showClose:!1}),!1)}removeNode(e){var t;if(!this.document.canRemove(e))return;let o=e.getNodeMeta(),n=null==(t=o.subCanvas)?void 0:t.call(o,e);if(null==n?void 0:n.isCanvas)return void n.parentNode.dispose();e.dispose()}removeLine(e){this.document.linesManager.canRemove(e)&&e.dispose()}constructor(e){this.commandId=eq.DELETE,this.shortcuts=["backspace","delete"],this.playgroundConfig=e.playground.config,this.document=e.get(b.L4w),this.selectService=e.get(b.oJU),this.historyService=e.get(b.qpv),this.execute=this.execute.bind(this)}}class e4{async execute(){if(this.readonly||await this.hasSelectedText()||!this.isValid(this.selectedNodes))return;let e=this.toClipboardData();await this.write(e)}toClipboardData(e){let t=this.getValidNodes(e||this.selectedNodes),o=this.toSource();return{type:eY,source:o,json:this.toJSON(t),bounds:this.getEntireBounds(t)}}get readonly(){return this.playgroundConfig.readonly}async hasSelectedText(){var e,t;return!!(null==(e=window.getSelection())?void 0:e.toString())&&(await navigator.clipboard.writeText((null==(t=window.getSelection())?void 0:t.toString())??""),e_.Toast.success({content:"Text copied"}),!0)}get selectedNodes(){return this.selectService.selection.filter(e=>e instanceof b.CTO)}isValid(e){return 0!==e.length||(e_.Toast.warning({content:"No nodes selected"}),!1)}getValidNodes(e){return e.filter(e=>![w.Start,w.End].includes(e.flowNodeType)&&!e.getNodeMeta().copyDisable)}toSource(){return{host:window.location.host}}toJSON(e){return{nodes:this.getNodeJSONs(e),edges:this.getEdgeJSONs(e)}}getNodeJSONs(e){return e.map(e=>e.flowNodeType===b.SyX.GROUP?this.getGroupNodeJSON(e):this.document.toNodeJSON(e)).filter(Boolean)}getGroupNodeJSON(e){return{...this.document.toNodeJSON(e),blocks:e.blocks.map(e=>this.document.toNodeJSON(e))}}getEdgeJSONs(e){let t=new Set,o=this.expandGroupNodes(e),n=new Set(o.map(e=>e.id));return o.forEach(e=>{let o=e.lines;[...o.inputLines,...o.outputLines].forEach(e=>{var o,i;(null==(o=e.from)?void 0:o.id)&&n.has(e.from.id)&&(null==(i=e.to)?void 0:i.id)&&n.has(e.to.id)&&t.add(e)})}),Array.from(t).map(e=>e.toJSON())}expandGroupNodes(e){return e.flatMap(e=>e.flowNodeType===b.SyX.GROUP?[e,...e.blocks]:e)}getEntireBounds(e){let t=e.map(e=>e.getData(b.VOn).bounds),o=b.AeJ.enlarge(t);return{x:o.x,y:o.y,width:o.width,height:o.height}}async write(e){try{await navigator.clipboard.writeText(JSON.stringify(e)),this.notifySuccess()}catch(e){console.error("Failed to write text: ",e)}}notifySuccess(){let e=[w.Start,w.End,w.BlockStart,w.BlockEnd];if(this.selectedNodes.some(t=>e.includes(t.flowNodeType)))return void e_.Toast.warning({content:"The Start/End node cannot be duplicated, other nodes have been copied to the clipboard",showClose:!1});e_.Toast.success({content:"Nodes have been copied to the clipboard",showClose:!1})}constructor(e){this.commandId=eq.COPY,this.shortcuts=["meta c","ctrl c"],this.playgroundConfig=e.playground.config,this.document=e.get(b.L4w),this.selectService=e.get(b.oJU),this.execute=this.execute.bind(this)}}class e5{async execute(){this.selectService.selectedNodes.forEach(e=>{e.renderData.expanded=!1})}constructor(e){this.commandId=eq.COLLAPSE,this.commandDetail={label:"Collapse"},this.shortcuts=["meta alt openbracket","ctrl alt openbracket"],this.selectService=e.get(b.oJU),this.execute=this.execute.bind(this)}}function e9(e,t){e.addHandlers(new e4(t),new e1(t),new eK(t),new e5(t),new e2(t),new e3(t),new eW(t),new eX(t))}var e6=o(549207);class e8{save(){console.log(this.document.toJSON())}}(0,e6.gn)([(0,b.f3M)(b.bQo),(0,e6.w6)("design:type",void 0===b.bQo?Object:b.bQo)],e8.prototype,"ctx",void 0),(0,e6.gn)([(0,b.f3M)(b.z2R),(0,e6.w6)("design:type",void 0===b.z2R?Object:b.z2R)],e8.prototype,"selectionService",void 0),(0,e6.gn)([(0,b.f3M)(b.XQj),(0,e6.w6)("design:type",void 0===b.XQj?Object:b.XQj)],e8.prototype,"playground",void 0),(0,e6.gn)([(0,b.f3M)(b.L4w),(0,e6.w6)("design:type",void 0===b.L4w?Object:b.L4w)],e8.prototype,"document",void 0),e8=(0,e6.gn)([(0,b.b2C)()],e8);class e7{validateLines(){this.linesManager.getAllLines().forEach(e=>e.validate())}async validateNode(e){return await e.getData(b.Psq).getFormModel().validateWithFeedbacks()}async validateNodes(){let e=this.document.getAssociatedNodes();return(await Promise.all(e.map(async e=>({feedbacks:await this.validateNode(e),node:e})))).filter(e=>e.feedbacks.length)}}(0,e6.gn)([(0,b.f3M)(b.dmf),(0,e6.w6)("design:type",void 0===b.dmf?Object:b.dmf)],e7.prototype,"linesManager",void 0),(0,e6.gn)([(0,b.f3M)(b.L4w),(0,e6.w6)("design:type",void 0===b.L4w?Object:b.L4w)],e7.prototype,"document",void 0),e7=(0,e6.gn)([(0,b.b2C)()],e7);var te=o(937643),tt=o(499164),to=o(615152);function tn(){let e=(0,b.G2Z)(b.fin),t=(0,b.JAk)(),o=e.getVar();if((0,L.useEffect)(()=>{let o=e.output.onVariableListChange(()=>{t()});return()=>{o.dispose()}},[]),!o)return null;let n=o.type?te.Kz.astToSchema(o.type):{type:"object"};return(0,C.jsx)(to._,{value:n,onChange:e=>o.updateType(te.Kz.schemaToAST(e))})}var ti=o(117280);function tr(){let e=(0,ti.V)({});return(0,C.jsx)(e_.Tree,{treeData:e})}var ts=o(106937);function tl(){let[e,t]=(0,L.useState)(!1);return(0,C.jsxs)("div",{className:ts.Z["panel-wrapper"],children:[(0,C.jsx)(e_.Tooltip,{content:"Toggle Variable Panel",children:(0,C.jsx)(e_.Button,{className:`${ts.Z["variable-panel-button"]} ${e?ts.Z.close:""}`,theme:e?"borderless":"light",onClick:()=>t(e=>!e),children:e?(0,C.jsx)(tt.Z,{}):(0,C.jsx)("img",{src:M,width:20,height:20})})}),(0,C.jsx)(e_.Collapsible,{isOpen:e,children:(0,C.jsx)("div",{className:ts.Z["panel-container"],children:(0,C.jsxs)(e_.Tabs,{children:[(0,C.jsx)(e_.Tabs.TabPane,{itemKey:"variables",tab:"Variable List",children:(0,C.jsx)(tr,{})}),(0,C.jsx)(e_.Tabs.TabPane,{itemKey:"global",tab:"Global Editor",children:(0,C.jsx)(tn,{})})]})})})]})}class ta extends b.mh4{onReady(){this.config.onDataChange(()=>{let{scrollX:e,scrollY:t}=this.config.config;b.xFV.setStyle(this.node,{position:"absolute",right:25-e,top:t+25})})}render(){return(0,C.jsx)(tl,{})}}ta=(0,e6.gn)([(0,b.b2C)()],ta);let td=async()=>(await new Promise(e=>setTimeout(e,1e3)),{type:"object",properties:{userId:{type:"string"}}}),tc=Symbol("GlobalVariableSchemaGetter"),tu=(0,b.M1y)({onBind(e){let{bind:t}=e;t(tc).toDynamicValue(e=>()=>{let t=e.container.get(b.fin).getVar();return te.Kz.astToSchema(null==t?void 0:t.type)})},onInit(e,t){e.playground.registerLayer(ta);let o=e.get(b.fin);t.initialData?o.setVar(b.qRT.createVariableDeclaration({key:"global",meta:{title:"Global",icon:M},type:te.Kz.schemaToAST(t.initialData)})):td().then(e=>{o.setVar(b.qRT.createVariableDeclaration({key:"global",meta:{title:"Global",icon:M},type:te.Kz.schemaToAST(e)}))})}});var tp=o(123387),th=tp.ZP.record(tp.ZP.string(),tp.ZP.any()),tg=tp.ZP.object({id:tp.ZP.string(),nodeID:tp.ZP.string(),inputs:th,outputs:th.optional(),data:th,branch:tp.ZP.string().optional()}),tm={status:tp.ZP.string(),terminated:tp.ZP.boolean(),startTime:tp.ZP.number(),endTime:tp.ZP.number().optional(),timeCost:tp.ZP.number()},ty=tp.ZP.object(tm),tx=tp.ZP.object({id:tp.ZP.string(),...tm,snapshots:tp.ZP.array(tg)}),tf=tp.ZP.record(tp.ZP.string(),tx),tv=tp.ZP.object({id:tp.ZP.string(),type:tp.ZP.enum(["log","info","debug","error","warning"]),message:tp.ZP.string(),nodeID:tp.ZP.string().optional(),timestamp:tp.ZP.number()}),tj=tp.ZP.record(tp.ZP.enum(["log","info","debug","error","warning"]),tp.ZP.array(tv)),tC=((p=tC||{}).ServerInfo="ServerInfo",p.TaskRun="TaskRun",p.TaskReport="TaskReport",p.TaskResult="TaskResult",p.TaskCancel="TaskCancel",p.TaskValidate="TaskValidate",p),tb={name:"TaskValidate",method:"POST",path:"/task/validate",module:"Task",schema:{input:tp.ZP.object({schema:tp.ZP.string(),inputs:th}),output:tp.ZP.object({valid:tp.ZP.boolean(),errors:tp.ZP.array(tp.ZP.string()).optional()})}},tN={name:"TaskRun",method:"POST",path:"/task/run",module:"Task",schema:{input:tp.ZP.object({schema:tp.ZP.string(),inputs:th}),output:tp.ZP.object({taskID:tp.ZP.string()})}},tw={name:"TaskResult",method:"GET",path:"/task/result",module:"Task",schema:{input:tp.ZP.object({taskID:tp.ZP.string()}),output:th}},tM={name:"TaskReport",method:"GET",path:"/task/report",module:"Task",schema:{input:tp.ZP.object({taskID:tp.ZP.string()}),output:tp.ZP.object({id:tp.ZP.string(),inputs:th,outputs:th,workflowStatus:ty,reports:tf,messages:tj})}},tA={name:"TaskCancel",method:"PUT",path:"/task/cancel",module:"Task",schema:{input:tp.ZP.object({taskID:tp.ZP.string()}),output:tp.ZP.object({success:tp.ZP.boolean()})}};tp.ZP.undefined(),tp.ZP.object({name:tp.ZP.string(),runtime:tp.ZP.string(),version:tp.ZP.string(),time:tp.ZP.string()}),Symbol.for("Engine"),Symbol.for("Executor");var tS=((h=tS||{}).Pending="pending",h.Processing="processing",h.Succeeded="succeeded",h.Failed="failed",h.Cancelled="canceled",h);Symbol.for("Validation");class tk{constructor(){}}tC.TaskRun,tC.TaskReport,tC.TaskResult,tC.TaskCancel,tC.TaskValidate,tk=(0,e6.gn)([(0,b.b2C)(),(0,e6.w6)("design:type",Function),(0,e6.w6)("design:paramtypes",[])],tk);class tT{constructor(){this[n]=async e=>{let{TaskRunAPI:t}=await Promise.all([o.e("471097"),o.e("334122")]).then(o.bind(o,302953));return t(e)},this[i]=async e=>{let{TaskReportAPI:t}=await Promise.all([o.e("471097"),o.e("334122")]).then(o.bind(o,302953));return t(e)},this[r]=async e=>{let{TaskResultAPI:t}=await Promise.all([o.e("471097"),o.e("334122")]).then(o.bind(o,302953));return t(e)},this[s]=async e=>{let{TaskCancelAPI:t}=await Promise.all([o.e("471097"),o.e("334122")]).then(o.bind(o,302953));return t(e)},this[l]=async e=>{let{TaskValidateAPI:t}=await Promise.all([o.e("471097"),o.e("334122")]).then(o.bind(o,302953));return t(e)}}}n=tC.TaskRun,i=tC.TaskReport,r=tC.TaskResult,s=tC.TaskCancel,l=tC.TaskValidate,tT=(0,e6.gn)([(0,b.b2C)(),(0,e6.w6)("design:type",Function),(0,e6.w6)("design:paramtypes",[])],tT);let tD={domain:"localhost",port:4e3,protocol:"http"};class tI{init(e){this.config=e}async [tC.TaskRun](e){return this.request(tN.path,tN.method,{body:e,errorMessage:"TaskRun failed"})}async [tC.TaskReport](e){return this.request(tM.path,tM.method,{queryParams:{taskID:e.taskID},errorMessage:"TaskReport failed"})}async [tC.TaskResult](e){return this.request(tw.path,tw.method,{queryParams:{taskID:e.taskID},errorMessage:"TaskResult failed",fallbackValue:{success:!1}})}async [tC.TaskCancel](e){return await this.request(tA.path,tA.method,{body:e,errorMessage:"TaskCancel failed",fallbackValue:{success:!1}})??{success:!1}}async [tC.TaskValidate](e){return this.request(tb.path,tb.method,{body:e,errorMessage:"TaskValidate failed"})}async request(e,t,o){try{let n=this.url(e,o.queryParams),i={method:t,redirect:"follow"};o.body&&(i.headers={"Content-Type":"application/json"},i.body=JSON.stringify(o.body));let r=await fetch(n,i),s=await r.json();if(this.isError(s))return console.error(o.errorMessage,s),o.fallbackValue;return s}catch(e){return console.error(e),o.fallbackValue}}url(e,t){let o=this.getURL(`/api${e}`);if(!t)return o;let n=new URLSearchParams(t);return`${o}?${n.toString()}`}isError(e){return!!e&&void 0!==e.code}getURL(e){let t=this.config.protocol??window.location.protocol,o=this.config.port?`${this.config.domain}:${this.config.port}`:this.config.domain;return`${t}://${o}${e}`}constructor(){this.config=tD}}tI=(0,e6.gn)([(0,b.b2C)(),(0,e6.w6)("design:type",Function),(0,e6.w6)("design:paramtypes",[])],tI);class tE{isFlowingLine(e){return this.runningNodes.some(t=>t.lines.inputLines.includes(e))}async taskRun(e){let t;if(this.taskID&&await this.taskCancel(),!await this.validateForm())return void this.resultEmitter.fire({errors:["Form validation failed"]});let o={...this.document.toJSON(),globalVariable:this.getGlobalVariableSchema()},n=await this.runtimeClient.TaskValidate({schema:JSON.stringify(o),inputs:e});if(!(null==n?void 0:n.valid))return void this.resultEmitter.fire({errors:(null==n?void 0:n.errors)??["Internal Server Error"]});this.reset();try{let n=await this.runtimeClient.TaskRun({schema:JSON.stringify(o),inputs:e});t=null==n?void 0:n.taskID}catch(e){this.resultEmitter.fire({errors:[null==e?void 0:e.message]});return}return t?(this.taskID=t,this.syncTaskReportIntervalID=setInterval(()=>{this.syncTaskReport()},500),this.taskID):void this.resultEmitter.fire({errors:["Task run failed"]})}async taskCancel(){this.taskID&&await this.runtimeClient.TaskCancel({taskID:this.taskID})}async validateForm(){let e=this.document.getAllNodes().map(e=>e.form);return(await Promise.all(e.map(async e=>null==e?void 0:e.validate()))).filter(e=>void 0!==e).every(e=>e)}reset(){this.taskID=void 0,this.nodeRunningStatus=new Map,this.runningNodes=[],this.syncTaskReportIntervalID&&clearInterval(this.syncTaskReportIntervalID),this.resetEmitter.fire({})}async syncTaskReport(){if(!this.taskID)return;let e=await this.runtimeClient.TaskReport({taskID:this.taskID});if(!e){clearInterval(this.syncTaskReportIntervalID),console.error("Sync task report failed");return}let{workflowStatus:t,inputs:o,outputs:n,messages:i}=e;if(t.terminated)if(clearInterval(this.syncTaskReportIntervalID),Object.keys(n).length>0)this.resultEmitter.fire({result:{inputs:o,outputs:n}});else{var r;this.resultEmitter.fire({errors:null==i||null==(r=i.error)?void 0:r.map(e=>e.nodeID?`${e.nodeID}: ${e.message}`:e.message)})}this.updateReport(e)}updateReport(e){let{reports:t}=e;this.runningNodes=[],this.document.getAllNodes().filter(e=>![w.BlockStart,w.BlockEnd].includes(e.flowNodeType)).forEach(e=>{let o=e.id,n=t[o];if(!n)return;n.status===tS.Processing&&this.runningNodes.push(e);let i=this.nodeRunningStatus.get(o);i&&n.status===i.status&&n.snapshots.length===i.nodeResultLength?n.status===tS.Processing&&this.reportEmitter.fire(n):(this.nodeRunningStatus.set(o,{nodeID:o,status:n.status,nodeResultLength:n.snapshots.length}),this.reportEmitter.fire(n),this.document.linesManager.forceUpdate())})}constructor(){this.runningNodes=[],this.reportEmitter=new b.Q5$,this.resetEmitter=new b.Q5$,this.resultEmitter=new b.Q5$,this.onNodeReportChange=this.reportEmitter.event,this.onReset=this.resetEmitter.event,this.onResultChanged=this.resultEmitter.event}}(0,e6.gn)([(0,b.f3M)(b.XQj),(0,e6.w6)("design:type",void 0===b.XQj?Object:b.XQj)],tE.prototype,"playground",void 0),(0,e6.gn)([(0,b.f3M)(b.L4w),(0,e6.w6)("design:type",void 0===b.L4w?Object:b.L4w)],tE.prototype,"document",void 0),(0,e6.gn)([(0,b.f3M)(tk),(0,e6.w6)("design:type",void 0===tk?Object:tk)],tE.prototype,"runtimeClient",void 0),(0,e6.gn)([(0,b.f3M)(tc),(0,e6.w6)("design:type",void 0===tc?Object:tc)],tE.prototype,"getGlobalVariableSchema",void 0),tE=(0,e6.gn)([(0,b.b2C)()],tE);class tL extends b.mh4{onReady(){this.listenPlaygroundEvent("contextmenu",e=>{this.config.readonlyOrDisabled||(this.openNodePanel(e),e.preventDefault(),e.stopPropagation())})}openNodePanel(e){let t=this.getPosFromMouseEvent(e),o=this.getContainerNode(t);this.nodePanelService.callNodePanel({position:t,containerNode:o,panelProps:{},onSelect:async e=>{if(!e)return;let{nodeType:n,nodeJSON:i}=e,r=this.dragService.adjustSubNodePosition(n,o,t),s=this.ctx.document.createWorkflowNodeByType(n,r,i??{},null==o?void 0:o.id);this.selectService.select(s)},onClose:()=>{}})}getContainerNode(e){let t=ef({targetPoint:e,transforms:ex(this.document.getAllNodes()),document:this.document});return null==t?void 0:t.entity}}(0,e6.gn)([(0,b.f3M)(b.bQo),(0,e6.w6)("design:type",void 0===b.bQo?Object:b.bQo)],tL.prototype,"ctx",void 0),(0,e6.gn)([(0,b.f3M)(eo),(0,e6.w6)("design:type",void 0===eo?Object:eo)],tL.prototype,"nodePanelService",void 0),(0,e6.gn)([(0,b.f3M)(b.XHk),(0,e6.w6)("design:type",void 0===b.XHk?Object:b.XHk)],tL.prototype,"hoverService",void 0),(0,e6.gn)([(0,b.f3M)(b.oJU),(0,e6.w6)("design:type",void 0===b.oJU?Object:b.oJU)],tL.prototype,"selectService",void 0),(0,e6.gn)([(0,b.f3M)(b.L4w),(0,e6.w6)("design:type",void 0===b.L4w?Object:b.L4w)],tL.prototype,"document",void 0),(0,e6.gn)([(0,b.f3M)(b.iwM),(0,e6.w6)("design:type",void 0===b.iwM?Object:b.iwM)],tL.prototype,"dragService",void 0),tL=(0,e6.gn)([(0,b.b2C)()],tL);let tP=(0,b.M1y)({onInit(e,t){e.playground.registerLayer(tL)}}),tZ=(0,b.M1y)({onBind(e,t){let{bind:o,rebind:n}=e;o(tk).toSelf().inSingletonScope(),o(tI).toSelf().inSingletonScope(),o(tT).toSelf().inSingletonScope(),"server"===t.mode?n(tk).to(tI):n(tk).to(tT),o(tE).toSelf().inSingletonScope()},onInit(e,t){"server"===t.mode&&e.get(tk).init(t.serverConfig)}});var tz=o(944822),tO=o(140404),tB=o(887173),tR=o(883435),tV=((g={}).NodeFormPanel="nodeFormPanel",g.TestRunFormPanel="testRunFormPanel",g.ProblemPanel="problemPanel",g);let tF=()=>{let e=(0,tz.zi)();return{open:t=>{e.open(tV.NodeFormPanel,"right",{props:t})},close:()=>e.close(tV.NodeFormPanel)}},tQ=()=>{let e=(0,tz.zi)();return{open:()=>{e.open(tV.TestRunFormPanel,"right")},close:()=>e.close(tV.TestRunFormPanel)}},tU=()=>{let e=(0,tz.zi)();return{open:()=>{e.open(tV.ProblemPanel,"bottom")},close:()=>e.close(tV.ProblemPanel)}};var tH=o(204561);function tG(e){let[t,o]=(0,L.useState)(0),n=(0,b.sX$)(),i=(0,L.useCallback)(()=>{o(n.document.getAllNodes().map(e=>e.form).filter(e=>null==e?void 0:e.state.invalid).length)},[n]),{open:r}=tQ(),s=(0,L.useCallback)(async()=>{let e=n.document.getAllNodes().map(e=>e.form);await Promise.all(e.map(async e=>null==e?void 0:e.validate())),console.log(">>>>> save data: ",n.document.toJSON()),r()},[n]);return(0,L.useEffect)(()=>{let e=e=>{let{form:t}=e;if(t){let o=t.onValidate(()=>i());e.onDispose(()=>o.dispose())}};n.document.getAllNodes().map(t=>e(t));let t=n.document.onNodeCreate(t=>{let{node:o}=t;return e(o)});return()=>t.dispose()},[n]),0===t?(0,C.jsx)(e_.Button,{disabled:e.disabled,onClick:s,icon:(0,C.jsx)(tR.Z,{size:"small"}),className:tH.Z.testrunSuccessButton,children:"Test Run"}):(0,C.jsx)(e_.Badge,{count:t,position:"rightTop",type:"danger",children:(0,C.jsx)(e_.Button,{type:"danger",disabled:e.disabled,onClick:s,icon:(0,C.jsx)(tR.Z,{size:"small"}),className:tH.Z.testrunErrorButton,children:"\xa0 Test Run"})})}var tJ=o(633988);let tY=e=>{let t=(()=>{let e=(0,b.G2Z)(b.L4w),t=(0,b.G2Z)(eo),o=(0,b.G2Z)(b.oJU),n=(0,b.Dcz)(),i=(()=>{let e=(0,b.Dcz)();return(0,L.useCallback)(t=>e.config.getPosFromMouseEvent({clientX:t.left+64,clientY:t.top-7}),[e])})(),r=(()=>{let e=(0,b.G2Z)(b.oJU);return(0,L.useCallback)(t=>{t&&e.selectNode(t)},[e])})();return(0,L.useCallback)(async n=>{let s=i(n),l=(e=>{let{activatedNode:t}=e;if(!t)return;let{isContainer:o}=t.getNodeMeta();if(o)return t;let n=t.parent;if(n&&n.flowNodeType!==b.SyX.ROOT)return n})(o);await new Promise(o=>{t.callNodePanel({position:s,enableMultiAdd:!0,containerNode:l,panelProps:{},onSelect:async t=>{if(!t)return;let{nodeType:o,nodeJSON:n}=t,i=l?(0,b.n2P)(e,{x:0,y:200}):void 0;r(e.createWorkflowNodeByType(o,i,n??{},null==l?void 0:l.id))},onClose:()=>{o()}})})},[i,t,n.config.zoom,e,r])})();return(0,C.jsx)(e_.Button,{"data-testid":"demo.free-layout.add-node",icon:(0,C.jsx)(tJ.Z,{}),color:"highlight",style:{backgroundColor:"rgba(171,181,255,0.3)",borderRadius:"8px"},disabled:e.disabled,onClick:e=>{t(e.currentTarget.getBoundingClientRect())},children:"Add Node"})},tq=T.ZP.div`
  position: absolute;
  bottom: 16px;
  display: flex;
  justify-content: left;
  min-width: 360px;
  pointer-events: none;
  gap: 8px;

  z-index: 20;
`,tX=T.ZP.div`
  display: flex;
  align-items: center;
  background-color: #fff;
  border: 1px solid rgba(68, 83, 130, 0.25);
  border-radius: 10px;
  box-shadow: rgba(0, 0, 0, 0.04) 0px 2px 6px 0px, rgba(0, 0, 0, 0.02) 0px 4px 12px 0px;
  column-gap: 2px;
  height: 40px;
  padding: 0 4px;
  pointer-events: auto;
`,tW=T.ZP.span`
  padding: 4px;
  border-radius: 8px;
  border: 1px solid rgba(68, 83, 130, 0.25);
  font-size: 12px;
  width: 50px;
  cursor: pointer;
`,tK=T.ZP.div`
  position: absolute;
  bottom: 60px;
  width: 198px;
`,t_=(0,T.ZP)(()=>(0,C.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,C.jsxs)("g",{id:"g1",children:[(0,C.jsx)("path",{id:"path1",fill:"#000000",stroke:"none",d:"M 18.09091 6.883101 L 5.409091 6.883101 L 5.409091 16.746737 L 10.664648 16.746737 C 10.927091 17.116341 11.30353 17.422749 11.792977 17.611004 L 12.664289 17.946156 L 12.744959 18.155828 L 5.409091 18.155828 C 4.630871 18.155828 4 17.524979 4 16.746737 L 4 6.883101 C 4 6.104881 4.630871 5.47401 5.409091 5.47401 L 18.09091 5.47401 C 18.86915 5.47401 19.5 6.104881 19.5 6.883101 L 19.5 12.52348 C 19.247208 11.883823 18.730145 11.365912 18.09091 11.111994 L 18.09091 6.883101 Z M 18.09091 18.155828 L 17.881165 18.155828 L 19.469212 14.368896 C 19.479921 14.343321 19.490206 14.317817 19.5 14.292241 L 19.5 16.746737 C 19.5 17.524979 18.86915 18.155828 18.09091 18.155828 Z"}),(0,C.jsx)("path",{id:"path2",fill:"#000000",fillRule:"evenodd",stroke:"none",d:"M 18.494614 13.960189 C 18.982441 12.796985 17.813459 11.628003 16.650255 12.11576 L 12.133272 14.01 C 10.962248 14.501069 10.987188 16.168798 12.172375 16.62464 L 13.482055 17.128389 L 13.985805 18.438068 C 14.441646 19.623184 16.109375 19.648125 16.600443 18.477171 L 18.494614 13.960189 Z M 17.19515 13.415224 L 15.30098 17.932205 L 14.79723 16.622526 C 14.654066 16.250385 14.359989 15.956307 13.987918 15.813213 L 12.678168 15.309464 L 17.19515 13.415224 Z"})]})}))`
  color: ${e=>e.visible?void 0:"#060709cc"};
`,t$=()=>{let e=(0,b.erw)({maxZoom:2,minZoom:.25}),t=(0,b.Dcz)(),[o,n]=(0,L.useState)(!1);return(0,C.jsx)(e_.Dropdown,{position:"top",trigger:"custom",visible:o,onClickOutSide:()=>n(!1),render:(0,C.jsxs)(e_.Dropdown.Menu,{children:[(0,C.jsx)(e_.Dropdown.Item,{onClick:()=>e.zoomin(),children:"Zoom in"}),(0,C.jsx)(e_.Dropdown.Item,{onClick:()=>e.zoomout(),children:"Zoom out"}),(0,C.jsx)(e_.Divider,{layout:"horizontal"}),(0,C.jsx)(e_.Dropdown.Item,{onClick:()=>t.config.updateZoom(.5),children:"Zoom to 50%"}),(0,C.jsx)(e_.Dropdown.Item,{onClick:()=>t.config.updateZoom(1),children:"Zoom to 100%"}),(0,C.jsx)(e_.Dropdown.Item,{onClick:()=>t.config.updateZoom(1.5),children:"Zoom to 150%"}),(0,C.jsx)(e_.Dropdown.Item,{onClick:()=>t.config.updateZoom(2),children:"Zoom to 200%"})]}),children:(0,C.jsxs)(tW,{onClick:()=>n(!0),children:[Math.floor(100*e.zoom),"%"]})})},t0=(0,C.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,C.jsx)("path",{id:"switch-line",fill:"currentColor",stroke:"none",d:"M 12.728118 10.060962 C 13.064282 8.716098 14.272528 7.772551 15.65877 7.772343 L 17.689898 7.772343 C 18.0798 7.772343 18.39588 7.456264 18.39588 7.066362 C 18.39588 6.676458 18.0798 6.36038 17.689898 6.36038 L 15.659616 6.36038 C 13.62515 6.360315 11.851767 7.745007 11.358504 9.718771 C 11.02234 11.063635 9.814095 12.007183 8.427853 12.007389 L 7.101437 12.007389 C 6.711768 12.007389 6.395878 12.323277 6.395878 12.712947 C 6.395878 13.102616 6.711768 13.418506 7.101437 13.418506 L 8.426159 13.418506 C 9.812716 13.418323 11.021417 14.361954 11.357657 15.707124 C 11.850921 17.680887 13.624304 19.065578 15.65877 19.065516 L 17.689049 19.065516 C 18.078953 19.065516 18.395033 18.749435 18.395033 18.359533 C 18.395033 17.969631 18.078953 17.653551 17.689049 17.653551 L 15.65877 17.653551 C 14.272528 17.653345 13.064282 16.709797 12.728118 15.364932 C 12.454905 14.27114 11.774856 13.322707 10.826583 12.712947 C 11.774536 12.10303 12.454268 11.154617 12.727271 10.060962 Z"})}),t1=()=>{let e=(0,b.G2Z)(b.dmf),t=(0,L.useCallback)(()=>{e.switchLineType()},[e]);return(0,C.jsx)(e_.Tooltip,{content:"Switch Line",children:(0,C.jsx)(e_.IconButton,{type:"tertiary",theme:"borderless",onClick:t,icon:t0})})};var t2=o(184066),t3=o(950731);let t4=()=>{let e=(0,b.Dcz)(),t=(0,L.useCallback)(()=>{e.config.readonly=!e.config.readonly},[e]);return e.config.readonly?(0,C.jsx)(e_.Tooltip,{content:"Editable",children:(0,C.jsx)(e_.IconButton,{theme:"borderless",type:"tertiary",icon:(0,C.jsx)(t2.Z,{size:"default"}),onClick:t})}):(0,C.jsx)(e_.Tooltip,{content:"Readonly",children:(0,C.jsx)(e_.IconButton,{theme:"borderless",type:"tertiary",icon:(0,C.jsx)(t3.Z,{size:"default"}),onClick:t})})},t5=e=>{let{minimapVisible:t,setMinimapVisible:o}=e;return(0,C.jsx)(e_.Tooltip,{content:"Minimap",children:(0,C.jsx)(e_.IconButton,{type:"tertiary",theme:"borderless",icon:(0,C.jsx)(t_,{visible:t}),onClick:()=>o(!t)})})},t9=e=>{let{visible:t}=e;return t?(0,C.jsx)(tK,{children:(0,C.jsx)(Z.Zd,{panelStyles:{},containerStyles:{pointerEvents:"auto",position:"relative",top:"unset",right:"unset",bottom:"unset",left:"unset"},inactiveStyle:{opacity:1,scale:1,translateX:0,translateY:0}})}):(0,C.jsx)(C.Fragment,{})};function t6(e){let{width:t,height:o}=e;return(0,C.jsxs)("svg",{width:t||48,height:o||38,viewBox:"0 0 48 38",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,C.jsx)("rect",{x:"1.83317",y:"1.49998",width:"44.3333",height:"35",rx:"3.5",stroke:"currentColor",strokeOpacity:"0.8",strokeWidth:"2.33333"}),(0,C.jsx)("path",{d:"M14.6665 30.6667H33.3332",stroke:"currentColor",strokeOpacity:"0.8",strokeWidth:"2.33333",strokeLinecap:"round"})]})}let t8=()=>(0,C.jsxs)("svg",{width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:[(0,C.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.8549 5H3.1451C3.06496 5 3 5.06496 3 5.1451V18.8549C3 18.935 3.06496 19 3.1451 19H20.8549C20.935 19 21 18.935 21 18.8549V5.1451C21 5.06496 20.935 5 20.8549 5ZM3.1451 3C1.96039 3 1 3.96039 1 5.1451V18.8549C1 20.0396 1.96039 21 3.1451 21H20.8549C22.0396 21 23 20.0396 23 18.8549V5.1451C23 3.96039 22.0396 3 20.8549 3H3.1451Z"}),(0,C.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.99991 16C6.99991 15.4477 7.44762 15 7.99991 15H15.9999C16.5522 15 16.9999 15.4477 16.9999 16C16.9999 16.5523 16.5522 17 15.9999 17H7.99991C7.44762 17 6.99991 16.5523 6.99991 16Z"})]});function t7(e){let{width:t,height:o}=e;return(0,C.jsx)("svg",{width:t||34,height:o||52,viewBox:"0 0 34 52",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,C.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M30.9998 16.6666V35.3333C30.9998 37.5748 30.9948 38.4695 30.9 39.1895C30.2108 44.4247 26.0912 48.5443 20.856 49.2335C20.1361 49.3283 19.2413 49.3333 16.9998 49.3333C14.7584 49.3333 13.8636 49.3283 13.1437 49.2335C7.90847 48.5443 3.78888 44.4247 3.09965 39.1895C3.00487 38.4695 2.99984 37.5748 2.99984 35.3333V16.6666C2.99984 14.4252 3.00487 13.5304 3.09965 12.8105C3.78888 7.57528 7.90847 3.45569 13.1437 2.76646C13.7232 2.69017 14.4159 2.67202 15.8332 2.66785V9.86573C14.4738 10.3462 13.4998 11.6426 13.4998 13.1666V17.8332C13.4998 19.3571 14.4738 20.6536 15.8332 21.1341V23.6666C15.8332 24.3109 16.3555 24.8333 16.9998 24.8333C17.6442 24.8333 18.1665 24.3109 18.1665 23.6666V21.1341C19.5259 20.6536 20.4998 19.3572 20.4998 17.8332V13.1666C20.4998 11.6426 19.5259 10.3462 18.1665 9.86571V2.66785C19.5837 2.67202 20.2765 2.69017 20.856 2.76646C26.0912 3.45569 30.2108 7.57528 30.9 12.8105C30.9948 13.5304 30.9998 14.4252 30.9998 16.6666ZM0.666504 16.6666C0.666504 14.4993 0.666504 13.4157 0.786276 12.5059C1.61335 6.22368 6.55687 1.28016 12.8391 0.453085C13.7489 0.333313 14.8325 0.333313 16.9998 0.333313C19.1671 0.333313 20.2508 0.333313 21.1605 0.453085C27.4428 1.28016 32.3863 6.22368 33.2134 12.5059C33.3332 13.4157 33.3332 14.4994 33.3332 16.6666V35.3333C33.3332 37.5006 33.3332 38.5843 33.2134 39.494C32.3863 45.7763 27.4428 50.7198 21.1605 51.5469C20.2508 51.6666 19.1671 51.6666 16.9998 51.6666C14.8325 51.6666 13.7489 51.6666 12.8391 51.5469C6.55687 50.7198 1.61335 45.7763 0.786276 39.494C0.666504 38.5843 0.666504 37.5006 0.666504 35.3333V16.6666ZM15.8332 13.1666C15.8332 13.0011 15.8676 12.8437 15.9297 12.7011C15.9886 12.566 16.0722 12.4443 16.1749 12.3416C16.386 12.1305 16.6777 11.9999 16.9998 11.9999C17.6435 11.9999 18.1654 12.5212 18.1665 13.1646L18.1665 13.1666V17.8332L18.1665 17.8353C18.1665 17.8364 18.1665 17.8376 18.1665 17.8387C18.1661 17.9132 18.1588 17.986 18.1452 18.0565C18.0853 18.3656 17.9033 18.6312 17.6515 18.8011C17.4655 18.9266 17.2412 18.9999 16.9998 18.9999C16.3555 18.9999 15.8332 18.4776 15.8332 17.8332V13.1666Z",fill:"currentColor",fillOpacity:"0.8"})})}let oe=()=>(0,C.jsx)("svg",{width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:(0,C.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.5 8C4.5 4.13401 7.63401 1 11.5 1H12.5C16.366 1 19.5 4.13401 19.5 8V17C19.5 20.3137 16.8137 23 13.5 23H10.5C7.18629 23 4.5 20.3137 4.5 17V8ZM11.2517 3.00606C8.60561 3.13547 6.5 5.32184 6.5 8V17C6.5 19.2091 8.29086 21 10.5 21H13.5C15.7091 21 17.5 19.2091 17.5 17V8C17.5 5.32297 15.3962 3.13732 12.7517 3.00622V5.28013C13.2606 5.54331 13.6074 6.06549 13.6074 6.66669V8.75759C13.6074 9.35879 13.2606 9.88097 12.7517 10.1441V11.4091C12.7517 11.8233 12.4159 12.1591 12.0017 12.1591C11.5875 12.1591 11.2517 11.8233 11.2517 11.4091V10.1457C10.7411 9.88298 10.3931 9.35994 10.3931 8.75759V6.66669C10.3931 6.06433 10.7411 5.5413 11.2517 5.27862V3.00606ZM12.0017 6.14397C11.7059 6.14397 11.466 6.38381 11.466 6.67968V8.74462C11.466 9.03907 11.7036 9.27804 11.9975 9.28031L12.0002 9.28032C12.0456 9.28032 12.0896 9.27482 12.1316 9.26447C12.3401 9.21256 12.5002 9.0386 12.5318 8.82287C12.5345 8.80149 12.5359 8.7797 12.5359 8.75759V6.66669C12.5359 6.64463 12.5345 6.62288 12.5318 6.60154C12.4999 6.38354 12.3368 6.20817 12.1252 6.15826C12.0856 6.14891 12.0442 6.14397 12.0017 6.14397Z"})});o(711325);let{Title:ot,Paragraph:oo}=e_.Typography,on=e=>{let{title:t,subTitle:o,icon:n,onChange:i,value:r,selected:s}=e;return(0,C.jsxs)("div",{className:`mouse-pad-option ${s?"mouse-pad-option-selected":""}`,onClick:()=>i(r),children:[(0,C.jsx)("div",{className:`mouse-pad-option-icon ${s?"mouse-pad-option-icon-selected":""}`,children:n}),(0,C.jsx)(ot,{heading:6,className:`mouse-pad-option-title ${s?"mouse-pad-option-title-selected":""}`,children:t}),(0,C.jsx)(oo,{type:"tertiary",className:`mouse-pad-option-subTitle ${s?"mouse-pad-option-subTitle-selected":""}`,children:o})]})},oi=e=>{let{value:t,onChange:o,onPopupVisibleChange:n,containerStyle:i,iconStyle:r,arrowStyle:s}=e,[l,a]=(0,L.useState)(!1);return(0,C.jsx)(e_.Popover,{trigger:"custom",position:"topLeft",closeOnEsc:!0,visible:l,onVisibleChange:e=>{null==n||n(e)},onClickOutSide:()=>{a(!1)},spacing:20,content:(0,C.jsxs)("div",{className:"ui-mouse-pad-selector-popover",children:[(0,C.jsx)(e_.Typography.Title,{heading:4,children:"Interaction mode"}),(0,C.jsxs)("div",{className:"ui-mouse-pad-selector-popover-options",children:[(0,C.jsx)(on,{title:"Mouse-Friendly",subTitle:"Drag the canvas with the left mouse button, zoom with the scroll wheel.",value:"MOUSE",selected:"MOUSE"===t,icon:(0,C.jsx)(t7,{}),onChange:o}),(0,C.jsx)(on,{title:"Touchpad-Friendly",subTitle:"Drag with two fingers moving in the same direction, zoom by pinching or spreading two fingers.",value:"PAD",selected:"PAD"===t,icon:(0,C.jsx)(t6,{}),onChange:o})]})]}),children:(0,C.jsx)("div",{className:`ui-mouse-pad-selector ${l?"ui-mouse-pad-selector-active":""}`,onClick:()=>{a(!l)},style:i,children:(0,C.jsx)("div",{className:"ui-mouse-pad-selector-icon",style:r,children:"MOUSE"===t?(0,C.jsx)(oe,{}):(0,C.jsx)(t8,{})})})})},or="workflow_prefer_interactive_type",os=/(Macintosh|MacIntel|MacPPC|Mac68K|iPad)/.test(navigator.userAgent),ol=()=>{let e=localStorage.getItem(or);return e&&["MOUSE","PAD"].includes(e)?e:os?"PAD":"MOUSE"},oa=()=>{let e=(0,b.erw)(),[t,o]=(0,L.useState)(!1),[n,i]=(0,L.useState)(()=>ol()),[r,s]=(0,L.useState)(!1);return(0,L.useEffect)(()=>{let t=ol();e.setInteractiveType(t)},[]),(0,C.jsx)(e_.Popover,{trigger:"custom",position:"top",visible:t,onClickOutSide:()=>{o(!1)},children:(0,C.jsx)(e_.Tooltip,{content:"MOUSE"===n?"Mouse-Friendly":"Touchpad-Friendly",style:{display:r?"none":"block"},children:(0,C.jsx)("div",{className:"workflow-toolbar-interactive",children:(0,C.jsx)(oi,{value:n,onChange:t=>{i(t),localStorage.setItem(or,t),e.setInteractiveType(t)},onPopupVisibleChange:s,containerStyle:{border:"none",height:"32px",width:"32px",justifyContent:"center",alignItems:"center",gap:"2px",padding:"4px",borderRadius:"var(--small, 6px)"},iconStyle:{margin:"0",width:"16px",height:"16px"},arrowStyle:{width:"12px",height:"12px"}})})})})};var od=o(665114);let oc=()=>{let e=(0,b.erw)();return(0,C.jsx)(e_.Tooltip,{content:"FitView",children:(0,C.jsx)(e_.IconButton,{icon:(0,C.jsx)(od.Z,{}),type:"tertiary",theme:"borderless",onClick:()=>e.fitView()})})},ou=e=>{let{style:t}=e;return(0,C.jsxs)("svg",{width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",style:t,children:[(0,C.jsx)("path",{d:"M6.5 9C5.94772 9 5.5 9.44772 5.5 10V11C5.5 11.5523 5.94772 12 6.5 12H7.5C8.05228 12 8.5 11.5523 8.5 11V10C8.5 9.44772 8.05228 9 7.5 9H6.5zM11.5 9C10.9477 9 10.5 9.44772 10.5 10V11C10.5 11.5523 10.9477 12 11.5 12H12.5C13.0523 12 13.5 11.5523 13.5 11V10C13.5 9.44772 13.0523 9 12.5 9H11.5zM15.5 10C15.5 9.44772 15.9477 9 16.5 9H17.5C18.0523 9 18.5 9.44772 18.5 10V11C18.5 11.5523 18.0523 12 17.5 12H16.5C15.9477 12 15.5 11.5523 15.5 11V10z"}),(0,C.jsx)("path",{d:"M23 4C23 2.9 22.1 2 21 2H3C1.9 2 1 2.9 1 4V17.0111C1 18.0211 1.9 19.0111 3 19.0111H7.7586L10.4774 22C10.9822 22.5017 11.3166 22.6311 12 22.7009C12.414 22.707 13.0502 22.5093 13.5 22L16.2414 19.0111H21C22.1 19.0111 23 18.1111 23 17.0111V4ZM3 4H21V17.0111H15.5L12 20.6714L8.5 17.0111H3V4Z"})]})},op=()=>{let e=(0,b.Dcz)(),t=(0,b.G2Z)(b.L4w),o=(0,b.G2Z)(b.oJU),n=(0,b.G2Z)(b.iwM),[i,r]=(0,L.useState)(!1),s=(0,L.useCallback)(t=>{let o=e.config.getPosFromMouseEvent(t);return{x:o.x,y:o.y-75}},[e]),l=(0,L.useCallback)(async e=>{r(!1);let i=s(e),l=t.createWorkflowNodeByType(w.Comment,i);await (0,b.gw0)(16),o.selectNode(l),0!==e.detail&&n.startDragSelectedNodes(e)},[o,s,t,n]);return(0,C.jsx)(e_.Tooltip,{trigger:"custom",visible:i,onVisibleChange:r,content:"Comment",children:(0,C.jsx)(e_.IconButton,{disabled:e.config.readonly,icon:(0,C.jsx)(ou,{style:{width:16,height:16}}),type:"tertiary",theme:"borderless",onClick:l,onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1)})})},oh=(0,C.jsx)("svg",{width:"1em",height:"1em",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,C.jsx)("path",{fill:"currentColor",d:"M3 2C2.44772 2 2 2.44771 2 3V12C2 12.5523 2.44772 13 3 13H10C10.5523 13 11 12.5523 11 12V3C11 2.44772 10.5523 2 10 2H3zM4 11V4H9V11H4zM21 22C21.5523 22 22 21.5523 22 21V12C22 11.4477 21.5523 11 21 11H14C13.4477 11 13 11.4477 13 12V21C13 21.5523 13.4477 22 14 22H21zM20 13V20H15V13H20zM2 16C2 15.4477 2.44772 15 3 15H10C10.5523 15 11 15.4477 11 16V21C11 21.5523 10.5523 22 10 22H3C2.44772 22 2 21.5523 2 21V16zM4 20V17H9V20H4zM21 9C21.5523 9 22 8.55228 22 8V3C22 2.44772 21.5523 2 21 2H14C13.4477 2 13 2.44772 13 3V8C13 8.55228 13.4477 9 14 9H21zM20 4V7H15V4H20z"})}),og=()=>{let e=(0,b.erw)(),t=(0,b.Dcz)(),o=(0,L.useCallback)(async()=>{await e.autoLayout({enableAnimation:!0,animationDuration:1e3,layoutConfig:{rankdir:"LR",align:void 0,nodesep:100,ranksep:100}})},[e]);return(0,C.jsx)(e_.Tooltip,{content:"Auto Layout",children:(0,C.jsx)(e_.IconButton,{disabled:t.config.readonly,type:"tertiary",theme:"borderless",onClick:o,icon:oh})})};var om=o(763171),oy=o(371210);let ox=()=>{let{results:e,loading:t}=(()=>{let[e,t]=(0,L.useState)([]),[o,n]=(0,L.useState)(!1),i=(0,b.G2Z)(e7),r=(0,b.G2Z)(b.L4w),s=(0,L.useCallback)((0,P.Z)(async()=>{let e=await i.validateNodes();i.validateLines(),t(e),n(!1)},1e3),[i]),l=()=>{n(!0),s()};return(0,L.useEffect)(()=>{l();let e=r.onContentChange(()=>{l()});return()=>e.dispose()},[]),{results:e,loading:o}})(),o=(0,b.G2Z)(b.oJU),{close:n}=tU(),{open:i}=tF();return(0,C.jsxs)("div",{style:{width:"100%",height:"100%",borderRadius:"8px",background:"rgb(251, 251, 251)",border:"1px solid rgba(82,100,154, 0.13)"},children:[(0,C.jsxs)("div",{style:{display:"flex",height:"50px",alignItems:"center",justifyContent:"space-between",padding:"0 12px"},children:[(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center",columnGap:"4px",height:"100%"},children:[(0,C.jsx)(e_.Typography.Text,{strong:!0,children:"Problem"}),t&&(0,C.jsx)(e_.Spin,{size:"small",style:{lineHeight:"0"}})]}),(0,C.jsx)(e_.IconButton,{type:"tertiary",theme:"borderless",icon:(0,C.jsx)(om.Z,{}),onClick:()=>n()})]}),(0,C.jsx)("div",{style:{padding:"12px",display:"flex",flexDirection:"column",rowGap:"4px"},children:e.map(e=>{var t;return(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center",border:"1px solid #999",borderRadius:"4px",padding:"0 4px",cursor:"pointer"},onClick:()=>{o.selectNodeAndScrollToView(e.node),i({nodeId:e.node.id})},children:[(0,C.jsx)(e_.Avatar,{style:{flexShrink:"0"},src:e.node.getNodeRegistry().info.icon,size:"24px",shape:"square"}),(0,C.jsxs)("div",{style:{marginLeft:"8px"},children:[(0,C.jsx)(e_.Typography.Text,{children:null==(t=e.node.form)?void 0:t.values.title}),(0,C.jsx)("br",{}),(0,C.jsx)(e_.Typography.Text,{type:"danger",children:e.feedbacks.map(e=>e.feedbackText).join(", ")})]})]},e.node.id)})})]})},of=()=>{let{open:e}=tU();return(0,C.jsx)(e_.IconButton,{type:"tertiary",theme:"borderless",icon:(0,C.jsx)(oy.Z,{}),onClick:()=>e()})},ov=()=>{let{history:e,playground:t}=(0,b.sX$)(),[o,n]=(0,L.useState)(!1),[i,r]=(0,L.useState)(!1),[s,l]=(0,L.useState)(!0);(0,L.useEffect)(()=>{let t=e.undoRedoService.onChange(()=>{n(e.canUndo()),r(e.canRedo())});return()=>t.dispose()},[e]);let a=(0,b.JAk)();return(0,L.useEffect)(()=>{let e=t.config.onReadonlyOrDisabledChange(()=>a());return()=>e.dispose()},[t]),(0,C.jsx)(tq,{className:"demo-free-layout-tools",children:(0,C.jsxs)(tX,{children:[(0,C.jsx)(oa,{}),(0,C.jsx)(og,{}),(0,C.jsx)(t1,{}),(0,C.jsx)(t$,{}),(0,C.jsx)(oc,{}),(0,C.jsx)(t5,{minimapVisible:s,setMinimapVisible:l}),(0,C.jsx)(t9,{visible:s}),(0,C.jsx)(t4,{}),(0,C.jsx)(op,{}),(0,C.jsx)(e_.Tooltip,{content:"Undo",children:(0,C.jsx)(e_.IconButton,{type:"tertiary",theme:"borderless",icon:(0,C.jsx)(tO.Z,{}),disabled:!o||t.config.readonly,onClick:()=>e.undo()})}),(0,C.jsx)(e_.Tooltip,{content:"Redo",children:(0,C.jsx)(e_.IconButton,{type:"tertiary",theme:"borderless",icon:(0,C.jsx)(tB.Z,{}),disabled:!i||t.config.readonly,onClick:()=>e.redo()})}),(0,C.jsx)(of,{}),(0,C.jsx)(e_.Divider,{layout:"vertical",style:{height:"16px"},margin:3}),(0,C.jsx)(tY,{disabled:t.config.readonly}),(0,C.jsx)(e_.Divider,{layout:"vertical",style:{height:"16px"},margin:3}),(0,C.jsx)(tG,{disabled:t.config.readonly})]})})};var oj=o(211712),oC=o.n(oj);let ob=(0,o(524053).A)(function(e){return L.createElement("svg",Object.assign({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,"aria-hidden":!0},e),L.createElement("g",{clipPath:"url(#clip_spin)"},L.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.2 3.79A8.5 8.5 0 0 0 5 16.81a1.5 1.5 0 1 1-2.48 1.7 11.5 11.5 0 1 1 20.6-3.53 1.5 1.5 0 0 1-2.91-.78A8.5 8.5 0 0 0 14.2 3.79Z",fill:"currentColor"})),L.createElement("defs",null,L.createElement("radialGradient",{cx:0,cy:0,r:1,gradientUnits:"userSpaceOnUse",gradientTransform:"translate(12 12) rotate(15) scale(9.5 9.51825)"},L.createElement("stop",null),L.createElement("stop",{offset:.301257,stopOpacity:0,stopColor:"currentColor"}),L.createElement("stop",{offset:.466753,stopOpacity:1,stopColor:"currentColor"})),L.createElement("clipPath",{id:"clip_spin"},L.createElement("rect",{width:24,height:24,fill:"currentColor"}))))},"spin");var oN=o(980317);function ow(e){let{value:t,onChange:o}=e,n=(0,L.useMemo)(()=>JSON.stringify(t,null,2),[t]),[i,r]=(0,L.useState)(n),s=(0,L.useRef)(0),l=(0,L.useRef)(0);return(0,L.useEffect)(()=>{s.current=s.current+1,s.current!==l.current&&(s.current=l.current,r(JSON.stringify(t,null,2)))},[t]),(0,C.jsx)(oN.V,{value:i,onChange:e=>{r(e);try{let t=JSON.parse(e);o(t),l.current++}catch(e){}}})}let oM={type:"object",properties:{}},oA=()=>{var e;let t=(0,b.G2Z)(b.L4w),o=(0,L.useMemo)(()=>t.root.blocks.find(e=>e.flowNodeType===w.Start),[t]),n=(null==o||null==(e=o.form)?void 0:e.getValueIn("outputs"))||oM;return(0,L.useMemo)(()=>{let e=[];return Object.entries(n.properties).forEach(t=>{var o,i;let[r,s]=t;e.push({type:s.type,name:r,defaultValue:s.default,required:(null==(o=n.required)?void 0:o.includes(r))??!1,itemsType:null==(i=s.items)?void 0:i.type})}),e},[n])},oS=e=>{let{formMeta:t,values:o,setValues:n}=e;(0,L.useEffect)(()=>{let e={};t.map(t=>{t.name in o||void 0===t.defaultValue||(e={...e,[t.name]:["object","array","map"].includes(t.type)&&"string"==typeof t.defaultValue?JSON.parse(t.defaultValue):t.defaultValue})}),n({...o,...e})},[t])};var ok=o(769471);let oT=e=>{let{values:t,setValues:o}=e;return oS({formMeta:oA(),values:t,setValues:o}),(0,C.jsx)("div",{className:ok.Z["testrun-json-input"],children:(0,C.jsx)(ow,{value:t,onChange:o})})};var oD=o(993700),oI=o(211433);let oE=e=>{let{values:t,setValues:o}=e,n=oA(),i=(e=>{let{formMeta:t,values:o,setValues:n}=e;return t.map(e=>{let t=o[e.name]??e.defaultValue;return{...e,value:t,onChange:t=>{n({...o,[e.name]:t})}}})})({formMeta:n,values:t,setValues:o});return(oS({formMeta:n,values:t,setValues:o}),0===i.length)?(0,C.jsx)("div",{className:oI.Z.formContainer,children:(0,C.jsxs)("div",{className:oI.Z.emptyState,children:[(0,C.jsx)("div",{className:oI.Z.emptyText,children:"Empty"}),(0,C.jsx)("div",{className:oI.Z.emptyText,children:"No inputs found in start node"})]})}):(0,C.jsx)("div",{className:oI.Z.formContainer,children:i.map(e=>(0,C.jsxs)("div",{className:oI.Z.fieldGroup,children:[(0,C.jsxs)("label",{htmlFor:e.name,className:oI.Z.fieldLabel,children:[e.name,e.required&&(0,C.jsx)("span",{className:oI.Z.requiredIndicator,children:"*"}),(0,C.jsx)("span",{className:oI.Z.fieldTypeIndicator,children:(0,C.jsx)(oD.s,{value:{type:e.type,items:e.itemsType?{type:e.itemsType}:void 0}})})]}),(e=>{switch(e.type){case"boolean":return(0,C.jsx)("div",{className:oI.Z.fieldInput,children:(0,C.jsx)(e_.Switch,{checked:e.value,onChange:t=>e.onChange(t)})});case"integer":return(0,C.jsx)("div",{className:oI.Z.fieldInput,children:(0,C.jsx)(e_.InputNumber,{precision:0,value:e.value,onChange:t=>e.onChange(t),placeholder:"Please input integer"})});case"number":return(0,C.jsx)("div",{className:oI.Z.fieldInput,children:(0,C.jsx)(e_.InputNumber,{value:e.value,onChange:t=>e.onChange(t),placeholder:"Please input number"})});case"object":return(0,C.jsx)("div",{className:oC()(oI.Z.fieldInput,oI.Z.codeEditorWrapper),children:(0,C.jsx)(ow,{value:e.value,onChange:t=>e.onChange(t)})});case"array":return(0,C.jsx)("div",{className:oC()(oI.Z.fieldInput,oI.Z.codeEditorWrapper),children:(0,C.jsx)(ow,{value:e.value,onChange:t=>e.onChange(t)})});default:return(0,C.jsx)("div",{className:oI.Z.fieldInput,children:(0,C.jsx)(e_.Input,{value:e.value,onChange:t=>e.onChange(t),placeholder:"Please input text"})})}})(e)]},e.name))})};var oL=o(855403),oP=o(867602);let oZ=e=>{let{label:t,value:o,level:n,isLast:i=!1}=e,[r,s]=(0,L.useState)(!0),l=e=>{navigator.clipboard.writeText(e),e_.Toast.success("Copied")},a=e=>null!==e&&"object"==typeof e&&(Array.isArray(e)&&e.length>0||!Array.isArray(e)&&Object.keys(e).length>0);return(0,C.jsxs)("div",{className:oP.Z.treeNode,children:[(0,C.jsxs)("div",{className:oP.Z.treeNodeHeader,children:[a(o)?(0,C.jsx)("button",{className:oC()(oP.Z.expandButton,r?oP.Z.expanded:oP.Z.collapsed),onClick:()=>s(!r),children:"▶"}):(0,C.jsx)("span",{className:oP.Z.expandPlaceholder}),(0,C.jsx)("span",{className:oP.Z.nodeLabel,onClick:()=>l(JSON.stringify({[t]:o})),children:t}),!a(o)&&(0,C.jsx)("span",{className:oP.Z.nodeValue,children:(e=>{if(null===e)return(0,C.jsx)("span",{className:oC()(oP.Z.primitiveValue,oP.Z.null),children:"null"});if(void 0===e)return(0,C.jsx)("span",{className:oC()(oP.Z.primitiveValue,oP.Z.undefined),children:"undefined"});switch(typeof e){case"string":return(0,C.jsxs)("span",{children:[(0,C.jsx)("span",{className:oP.Z.primitiveValueQuote,children:'"'}),(0,C.jsx)("span",{className:oC()(oP.Z.primitiveValue,oP.Z.string),onDoubleClick:()=>l(e),children:e}),(0,C.jsx)("span",{className:oP.Z.primitiveValueQuote,children:'"'})]});case"number":return(0,C.jsx)("span",{className:oC()(oP.Z.primitiveValue,oP.Z.number),onDoubleClick:()=>l(String(e)),children:e});case"boolean":return(0,C.jsx)("span",{className:oC()(oP.Z.primitiveValue,oP.Z.boolean),onDoubleClick:()=>l(e.toString()),children:e.toString()});case"object":if(Array.isArray(e))return(0,C.jsx)("span",{className:oP.Z.primitiveValue,onDoubleClick:()=>l("[]"),children:"[]"});return(0,C.jsx)("span",{className:oP.Z.primitiveValue,onDoubleClick:()=>l("{}"),children:"{}"});default:return(0,C.jsx)("span",{className:oP.Z.primitiveValue,onDoubleClick:()=>l(String(e)),children:String(e)})}})(o)})]}),a(o)&&r&&(0,C.jsx)("div",{className:oP.Z.treeNodeChildren,children:(()=>{if(Array.isArray(o))return o.map((e,t)=>(0,C.jsx)(oZ,{label:`${t+1}.`,value:e,level:n+1,isLast:t===o.length-1},t));{let e=Object.entries(o);return e.map((t,o)=>{let[i,r]=t;return(0,C.jsx)(oZ,{label:`${i}:`,value:r,level:n+1,isLast:o===e.length-1},i)})}})()})]})},oz=e=>{let{data:t,level:o=0}=e;if(null==t||"object"!=typeof t)return(0,C.jsx)("div",{className:oP.Z.dataStructureViewer,children:(0,C.jsx)(oZ,{label:"value",value:t,level:0})});let n=Object.entries(t);return(0,C.jsx)("div",{className:oP.Z.dataStructureViewer,children:n.map((e,t)=>{let[o,i]=e;return(0,C.jsx)(oZ,{label:`${o}:`,value:i,level:0,isLast:t===n.length-1},o)})})};var oO=o(455702);let oB=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e&&Object.keys(e).length>0},oR=e=>{let{title:t,data:o,optional:n=!1,disableCollapse:i=!1}=e,r=oB(o),[s,l]=(0,L.useState)(!0);return n&&!r?null:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)("div",{className:oO.Z["node-status-group"],onClick:()=>r&&!i&&l(!s),children:[!i&&(0,C.jsx)(oL.Z,{className:oC()(oO.Z["node-status-group-icon"],{[oO.Z["node-status-group-icon-expanded"]]:s&&r})}),(0,C.jsxs)("span",{children:[t,":"]}),!r&&(0,C.jsx)(e_.Tag,{size:"small",className:oO.Z["node-status-group-tag"],children:"null"})]}),r&&s?(0,C.jsx)(oz,{data:o}):null]})},oV=e=>{let{className:t,style:o}=e;return(0,C.jsxs)("svg",{className:t,style:o,width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:[(0,C.jsx)("path",{d:"M9.5 8C8.67157 8 8 8.67157 8 9.5V14.5C8 15.3284 8.67157 16 9.5 16H14.5C15.3284 16 16 15.3284 16 14.5V9.5C16 8.67157 15.3284 8 14.5 8H9.5Z"}),(0,C.jsx)("path",{d:"M12 23C18.0751 23 23 18.0751 23 12C23 5.92487 18.0751 1 12 1C5.92487 1 1 5.92487 1 12C1 18.0751 5.92487 23 12 23ZM12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21Z"})]})};var oF=o(69049);let oQ=()=>{let e=(0,b.G2Z)(tE),{close:t}=tQ(),[o,n]=(0,L.useState)(!1),[i,r]=(0,L.useState)({}),[s,l]=(0,L.useState)(),[a,d]=(0,L.useState)(),[c,u]=(0,L.useState)(()=>{let e=localStorage.getItem("testrun-input-json-mode");return!!e&&JSON.parse(e)}),p=async()=>{if(o)return void await e.taskCancel();d(void 0),l(void 0),await e.taskRun(i)&&n(!0)},h=async()=>{await e.taskCancel(),r({}),n(!1),t()},g=(0,C.jsxs)("div",{className:oF.Z["testrun-panel-running"],children:[(0,C.jsx)(ob,{spin:!0,size:"large"}),(0,C.jsx)("div",{className:oF.Z.text,children:"Running..."})]}),m=(0,C.jsxs)("div",{className:oF.Z["testrun-panel-form"],children:[(0,C.jsxs)("div",{className:oF.Z["testrun-panel-input"],children:[(0,C.jsx)("div",{className:oF.Z.title,children:"Input Form"}),(0,C.jsx)("div",{children:"JSON Mode"}),(0,C.jsx)(e_.Switch,{checked:c,onChange:e=>{u(e),localStorage.setItem("testrun-input-json-mode",JSON.stringify(e))},size:"small"})]}),c?(0,C.jsx)(oT,{values:i,setValues:r}):(0,C.jsx)(oE,{values:i,setValues:r}),null==s?void 0:s.map(e=>(0,C.jsx)("div",{className:oF.Z.error,children:e},e)),(0,C.jsx)(oR,{title:"Inputs Result",data:null==a?void 0:a.inputs,optional:!0,disableCollapse:!0}),(0,C.jsx)(oR,{title:"Outputs Result",data:null==a?void 0:a.outputs,optional:!0,disableCollapse:!0})]}),y=(0,C.jsx)(e_.Button,{onClick:p,icon:o?(0,C.jsx)(oV,{}):(0,C.jsx)(tR.Z,{size:"small"}),className:oC()(oF.Z.button,{[oF.Z.running]:o,[oF.Z.default]:!o}),children:o?"Cancel":"Test Run"});return(0,L.useEffect)(()=>{let t=e.onResultChanged(e=>{let{result:t,errors:o}=e;n(!1),d(t),o?l(o):l(void 0)});return()=>t.dispose()},[]),(0,L.useEffect)(()=>()=>{e.taskCancel()},[e]),(0,C.jsxs)("div",{className:oF.Z["testrun-panel-container"],children:[(0,C.jsxs)("div",{className:oF.Z["testrun-panel-header"],children:[(0,C.jsx)("div",{className:oF.Z["testrun-panel-title"],children:"Test Run"}),(0,C.jsx)(e_.Button,{className:oF.Z["testrun-panel-title"],type:"tertiary",icon:(0,C.jsx)(om.Z,{}),size:"small",theme:"borderless",onClick:h})]}),(0,C.jsx)("div",{className:oF.Z["testrun-panel-content"],children:o?g:m}),(0,C.jsx)("div",{className:oF.Z["testrun-panel-footer"],children:y})]})},oU=L.createContext({}),oH=L.createContext(!1);function oG(e){var t;let{node:o}=e,n=(0,b.PVB)(o);return(0,C.jsx)(oU.Provider,{value:n,children:(0,C.jsx)("div",{style:{background:"rgb(251, 251, 251)",height:"100%",width:"100%",borderRadius:8,border:"1px solid rgba(82,100,154, 0.13)",boxSizing:"border-box"},children:null==(t=n.form)?void 0:t.render()})})}let oJ=e=>{var t;let{nodeId:o}=e,{selection:n,playground:i,document:r}=(0,b.sX$)(),s=(0,b.JAk)(),{close:l}=tF(),a=(0,L.useCallback)(()=>{(0,L.startTransition)(()=>{l()})},[]),d=r.getNode(o),c=(null==d||null==(t=d.getNodeMeta())?void 0:t.sidebarDisabled)===!0;return((0,L.useEffect)(()=>{let e=i.config.onReadonlyOrDisabledChange(()=>{a(),s()});return()=>e.dispose()},[i]),(0,L.useEffect)(()=>{let e=n.onSelectionChanged(()=>{0===n.selection.length?a():1===n.selection.length&&n.selection[0]!==d&&a()});return()=>e.dispose()},[n,d,a]),(0,L.useEffect)(()=>{if(d){let e=d.onDispose(()=>{l()});return()=>e.dispose()}return()=>{}},[d,c,a]),(0,L.useEffect)(()=>{(!d||c||i.config.readonly)&&a()},[d,c,i.config.readonly]),!d||c||i.config.readonly)?null:(0,C.jsx)(oH.Provider,{value:!0,children:(0,C.jsx)(b.rQR.Provider,{value:d,children:(0,C.jsx)(oG,{node:d})},d.id)})},oY={key:tV.NodeFormPanel,defaultSize:500,render:e=>(0,C.jsx)(oJ,{...e})},oq={key:tV.TestRunFormPanel,defaultSize:400,render:()=>(0,C.jsx)(oQ,{})},oX={key:tV.ProblemPanel,defaultSize:200,render:()=>(0,C.jsx)(ox,{})};var oW=o(38643),oK=o(236831),o_=o(125812),o$=o(623631),o0=o(183173),o1=o(789220);let o2={render:e=>{let{form:t}=e;return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(il,{}),(0,C.jsxs)(n3,{children:[(0,C.jsx)(n8,{}),(0,C.jsx)(e_.Divider,{}),(0,C.jsx)(S.L,{displayFromScope:!0})]})]})},validateTrigger:b.C$T.onChange,validate:{title:e=>{let{value:t}=e;return t?void 0:"Title is required"},"inputsValues.*":e=>{var t;let{value:o,context:n,formValues:i,name:r}=e,s=r.replace(/^inputsValues\./,""),l=(null==(t=i.inputs)?void 0:t.required)||[];return(0,oW.W)(o,{node:n.node,required:l.includes(s),errorMessages:{required:`${s} is required`}})}},formatOnInit:(e,t)=>e,formatOnSubmit:(e,t)=>e,effect:{title:oK.H,outputs:o_.X,inputsValues:[...o$.g,...(0,o0.S)({scope:"public"})],"inputsValues.*":(0,o1.V)(e=>{console.log(`[${e.context.node.id}][${e.name}] Schema Of Ref Updated`)})}};var o3=o(77696),o4=o(194090),o5=o(714456);o(906018);var o9=((m={}).Title="title",m.Color="color",m);let o6=e=>{let{size:t}=e;return(0,C.jsx)("svg",{width:"10",height:"10",viewBox:"0 0 10 10",xmlns:"http://www.w3.org/2000/svg",style:{width:t,height:t},children:(0,C.jsx)("path",{id:"group",fill:"currentColor",fillRule:"evenodd",stroke:"none",d:"M 0.009766 10 L 0.009766 9.990234 L 0 9.990234 L 0 7.5 L 1 7.5 L 1 9 L 2.5 9 L 2.5 10 L 0.009766 10 Z M 3.710938 10 L 3.710938 9 L 6.199219 9 L 6.199219 10 L 3.710938 10 Z M 7.5 10 L 7.5 9 L 9 9 L 9 7.5 L 10 7.5 L 10 9.990234 L 9.990234 9.990234 L 9.990234 10 L 7.5 10 Z M 0 6.289063 L 0 3.800781 L 1 3.800781 L 1 6.289063 L 0 6.289063 Z M 9 6.289063 L 9 3.800781 L 10 3.800781 L 10 6.289063 L 9 6.289063 Z M 0 2.5 L 0 0.009766 L 0.009766 0.009766 L 0.009766 0 L 2.5 0 L 2.5 1 L 1 1 L 1 2.5 L 0 2.5 Z M 9 2.5 L 9 1 L 7.5 1 L 7.5 0 L 9.990234 0 L 9.990234 0.009766 L 10 0.009766 L 10 2.5 L 9 2.5 Z M 3.710938 1 L 3.710938 0 L 6.199219 0 L 6.199219 1 L 3.710938 1 Z"})})},o8=e=>{let{size:t}=e;return(0,C.jsx)("svg",{width:"10",height:"10",viewBox:"0 0 10 10",xmlns:"http://www.w3.org/2000/svg",style:{width:t,height:t},children:(0,C.jsx)("path",{id:"ungroup",fill:"currentColor",fillRule:"evenodd",stroke:"none",d:"M 9.654297 10.345703 L 8.808594 9.5 L 7.175781 9.5 L 7.175781 8.609375 L 7.917969 8.609375 L 1.390625 2.082031 L 1.390625 2.824219 L 0.5 2.824219 L 0.5 1.191406 L -0.345703 0.345703 L 0.283203 -0.283203 L 1.166016 0.599609 L 2.724609 0.599609 L 2.724609 1.490234 L 2.056641 1.490234 L 8.509766 7.943359 L 8.509766 7.275391 L 9.400391 7.275391 L 9.400391 8.833984 L 10.283203 9.716797 L 9.654297 10.345703 Z M 0.509766 9.5 L 0.509766 9.490234 L 0.5 9.490234 L 0.5 7.275391 L 1.390625 7.275391 L 1.390625 8.609375 L 2.724609 8.609375 L 2.724609 9.5 L 0.509766 9.5 Z M 3.802734 9.5 L 3.802734 8.609375 L 6.017578 8.609375 L 6.017578 9.5 L 3.802734 9.5 Z M 0.5 6.197266 L 0.5 3.982422 L 1.390625 3.982422 L 1.390625 6.197266 L 0.5 6.197266 Z M 8.509766 6.197266 L 8.509766 3.982422 L 9.400391 3.982422 L 9.400391 6.197266 L 8.509766 6.197266 Z M 8.509766 2.824219 L 8.509766 1.490234 L 7.175781 1.490234 L 7.175781 0.599609 L 9.390625 0.599609 L 9.390625 0.609375 L 9.400391 0.609375 L 9.400391 2.824219 L 8.509766 2.824219 Z M 3.802734 1.490234 L 3.802734 0.599609 L 6.017578 0.599609 L 6.017578 1.490234 L 3.802734 1.490234 Z"})})},o7=e=>{let{node:t,style:o}=e,n=(0,b.G2Z)(b.HoL);return(0,C.jsx)(e_.Tooltip,{content:"Ungroup",children:(0,C.jsx)("div",{className:"workflow-group-ungroup",style:o,children:(0,C.jsx)(e_.Button,{icon:(0,C.jsx)(o8,{size:14}),style:{height:30,width:30},theme:"borderless",type:"tertiary",onClick:()=>{n.executeCommand(eV.Ungroup,t)}})})})};var ne=o(169228);let nt=()=>{let[e,t]=(0,L.useState)(!1);return(0,C.jsx)(b.gNt,{name:o9.Title,children:o=>{let{field:n}=o;return e?(0,C.jsx)(e_.Input,{autoFocus:!0,className:"workflow-group-title-input",size:"small",value:n.value,onChange:n.onChange,onMouseDown:e=>e.stopPropagation(),onBlur:()=>t(!1),draggable:!1,onEnterPress:()=>t(!1)}):(0,C.jsx)("p",{className:"workflow-group-title",onDoubleClick:()=>t(!0),children:n.value??"Group"})}})},no="Blue",nn={Red:{50:"#fef2f2",300:"#fca5a5",400:"#f87171"},Orange:{50:"#fff7ed",300:"#fdba74",400:"#fb923c"},Amber:{50:"#fffbeb",300:"#fcd34d",400:"#fbbf24"},Yellow:{50:"#fef9c3",300:"#fde047",400:"#facc15"},Lime:{50:"#f7fee7",300:"#bef264",400:"#a3e635"},Green:{50:"#f0fdf4",300:"#86efac",400:"#4ade80"},Emerald:{50:"#ecfdf5",300:"#6ee7b7",400:"#34d399"},Teal:{50:"#f0fdfa",300:"#5eead4",400:"#2dd4bf"},Cyan:{50:"#ecfeff",300:"#67e8f9",400:"#22d3ee"},Sky:{50:"#ecfeff",300:"#7dd3fc",400:"#38bdf8"},Blue:{50:"#eff6ff",300:"#93c5fd",400:"#60a5fa"},Indigo:{50:"#eef2ff",300:"#a5b4fc",400:"#818cf8"},Violet:{50:"#f5f3ff",300:"#c4b5fd",400:"#a78bfa"},Purple:{50:"#faf5ff",300:"#d8b4fe",400:"#c084fc"},Fuchsia:{50:"#fdf4ff",300:"#f0abfc",400:"#e879f9"},Pink:{50:"#fdf2f8",300:"#f9a8d4",400:"#f472b6"},Rose:{50:"#fff1f2",300:"#fda4af",400:"#fb7185"},Gray:{50:"#f9fafb",300:"#d1d5db",400:"#9ca3af"}},ni=()=>(0,C.jsx)(b.gNt,{name:o9.Color,children:e=>{let{field:t}=e,o=t.value??no;return(0,C.jsx)(e_.Popover,{position:"top",mouseLeaveDelay:300,content:(0,C.jsx)("div",{className:"workflow-group-color-palette",children:Object.entries(nn).map(e=>{let[n,i]=e;return(0,C.jsx)(e_.Tooltip,{content:n,mouseEnterDelay:300,children:(0,C.jsx)("span",{className:"workflow-group-color-item",style:{backgroundColor:i["300"],borderColor:n===o?i["400"]:"#fff"},onClick:()=>t.onChange(n)},n)},n)})}),children:(0,C.jsx)("span",{className:"workflow-group-color",style:{backgroundColor:nn[o]["300"]}})})}}),nr=()=>(0,C.jsxs)("div",{className:"workflow-group-tools",children:[(0,C.jsx)(ne.Z,{className:"workflow-group-tools-drag"}),(0,C.jsx)(nt,{}),(0,C.jsx)(ni,{})]}),ns="workflow-move-into-group-tip-visible",nl="false";class na{static get instance(){return this._instance||(this._instance=new na),this._instance}isClosed(){return this.isCloseForever()||this.closed}close(){this.closed=!0}isCloseForever(){return localStorage.getItem(ns)===nl}closeForever(){localStorage.setItem(ns,nl)}constructor(){this.closed=!1}}let nd=T.ZP.div`
  position: absolute;
  top: 35px;

  width: 100%;
  height: 28px;
  white-space: nowrap;
  pointer-events: auto;

  .container {
    display: inline-flex;
    justify-content: center;
    height: 100%;
    width: 100%;
    background-color: rgb(255 255 255);
    border-radius: 8px 8px 0 0;

    .content {
      overflow: hidden;
      display: inline-flex;
      align-items: center;
      justify-content: flex-start;

      width: fit-content;
      height: 100%;
      padding: 0 12px;

      .text {
        font-size: 14px;
        font-weight: 400;
        font-style: normal;
        line-height: 20px;
        color: rgba(15, 21, 40, 82%);
        text-overflow: ellipsis;
        margin: 0;
      }

      .space {
        width: 128px;
      }
    }

    .actions {
      display: flex;
      gap: 8px;
      align-items: center;

      height: 28px;
      padding: 0 12px;

      .close-forever {
        cursor: pointer;

        padding: 0 3px;

        font-size: 12px;
        font-weight: 400;
        font-style: normal;
        line-height: 12px;
        color: rgba(32, 41, 69, 62%);
        margin: 0;
      }

      .close {
        display: flex;
        cursor: pointer;
        height: 100%;
        align-items: center;
      }
    }
  }
`,nc=/(Macintosh|MacIntel|MacPPC|Mac68K|iPad)/.test(navigator.userAgent),nu=()=>(0,C.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",children:(0,C.jsx)("path",{fill:"#060709",fillOpacity:"0.5",d:"M12.13 12.128a.5.5 0 0 0 .001-.706L8.71 8l3.422-3.423a.5.5 0 0 0-.001-.705.5.5 0 0 0-.706-.002L8.002 7.293 4.579 3.87a.5.5 0 0 0-.705.002.5.5 0 0 0-.002.705L7.295 8l-3.423 3.422a.5.5 0 0 0 .002.706c.195.195.51.197.705.001l3.423-3.422 3.422 3.422c.196.196.51.194.706-.001"})}),np=()=>{let{visible:e,close:t,closeForever:o}=(()=>{let e=(0,b.PFB)(),[t,o]=(0,L.useState)(!1),n=na.instance,i=(0,b.G2Z)(ev),r=(0,L.useCallback)(()=>{n.isClosed()||o(!0)},[n]),s=(0,L.useCallback)(()=>{n.close(),o(!1)},[n]),l=(0,L.useCallback)(()=>{n.closeForever(),s()},[s,n]);return(0,L.useEffect)(()=>{let t=i.on(t=>{t.type===eg.In&&t.targetContainer===e&&r()}),n=i.on(t=>{t.type===eg.Out&&(t.sourceContainer!==e||e.blocks.length||o(!1))});return()=>{t.dispose(),n.dispose()}},[i,e,r,s,t]),{visible:t,close:s,closeForever:l}})();return e?(0,C.jsx)(nd,{className:"workflow-group-tips",children:(0,C.jsxs)("div",{className:"container",children:[(0,C.jsxs)("div",{className:"content",children:[(0,C.jsx)("p",{className:"text",children:`Hold ${nc?"Cmd ⌘":"Ctrl"} to drag node out`}),(0,C.jsx)("div",{className:"space",style:{width:0}})]}),(0,C.jsxs)("div",{className:"actions",children:[(0,C.jsx)("p",{className:"close-forever",onClick:o,children:"Never Remind"}),(0,C.jsx)("div",{className:"close",onClick:t,children:(0,C.jsx)(nu,{})})]})]})}):null},nh=e=>{let{onDrag:t,onFocus:o,onBlur:n,children:i,style:r}=e,s=nn[(0,b.qoQ)(o9.Color)??no];return(0,C.jsx)("div",{className:"workflow-group-header","data-flow-editor-selectable":"false",onMouseDown:t,onTouchStart:t,onFocus:o,onBlur:n,style:{...r,backgroundColor:s["50"],borderColor:s["300"]},children:i})},ng=e=>{let{node:t,style:o,selected:n}=e,i=nn[(0,b.qoQ)(o9.Color)??no];return(0,L.useEffect)(()=>{let e=document.createElement("style");return e.textContent=`
      .workflow-group-render[data-group-id="${t.id}"] .workflow-group-background {
        border: 1px solid ${i["300"]};
      }

      .workflow-group-render.selected[data-group-id="${t.id}"] .workflow-group-background {
        border: 1px solid #4e40e5;
      }
    `,document.head.appendChild(e),()=>{e.remove()}},[i]),(0,C.jsx)("div",{className:"workflow-group-background","data-flow-editor-selectable":"true",style:{...o,backgroundColor:`${i["300"]}${n?"40":"29"}`}})},nm=()=>{let{node:e,selected:t,selectNode:o,nodeRef:n,startDrag:i,onFocus:r,onBlur:s}=(0,b.PVB)(),l=eC(),a=e.getData(b.Psq).getFormModel(),d=null==a?void 0:a.formControl,{height:c,width:u}=l??{},p=c??0;return(0,L.useEffect)(()=>{e.renderData.node.style.pointerEvents="none"},[e]),(0,C.jsx)("div",{className:`workflow-group-render ${t?"selected":""}`,ref:n,"data-group-id":e.id,"data-node-selected":String(t),onMouseDown:o,onClick:e=>{o(e)},style:{width:u,height:c},children:(0,C.jsx)(b.l09,{control:d,children:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(nh,{onDrag:e=>{i(e),e.stopPropagation()},onFocus:r,onBlur:s,style:{height:30},children:(0,C.jsx)(nr,{})}),(0,C.jsx)(np,{}),(0,C.jsx)(o7,{node:e}),(0,C.jsx)(ng,{node:e,selected:t,style:{top:35,height:p-30-5}})]})})})},ny=e=>{let{bounds:t,children:o,flowSelectConfig:n,commandRegistry:i}=e;return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{style:{position:"absolute",left:t.right,top:t.top,transform:"translate(-100%, -100%)"},onMouseDown:e=>{e.stopPropagation()},children:(0,C.jsxs)(e_.ButtonGroup,{size:"small",style:{display:"flex",flexWrap:"nowrap",height:24},children:[(0,C.jsx)(e_.Tooltip,{content:"Collapse",children:(0,C.jsx)(e_.Button,{icon:(0,C.jsx)(o3.Z,{}),style:{height:24},type:"primary",theme:"solid",onMouseDown:e=>{i.executeCommand(eq.COLLAPSE)}})}),(0,C.jsx)(e_.Tooltip,{content:"Expand",children:(0,C.jsx)(e_.Button,{icon:(0,C.jsx)(od.Z,{}),style:{height:24},type:"primary",theme:"solid",onMouseDown:e=>{i.executeCommand(eq.EXPAND)}})}),(0,C.jsx)(e_.Tooltip,{content:"Create Group",children:(0,C.jsx)(e_.Button,{icon:(0,C.jsx)(o6,{size:14}),style:{height:24},type:"primary",theme:"solid",onClick:()=>{i.executeCommand(eV.Group)}})}),(0,C.jsx)(e_.Tooltip,{content:"Copy",children:(0,C.jsx)(e_.Button,{icon:(0,C.jsx)(o4.Z,{}),style:{height:24},type:"primary",theme:"solid",onClick:()=>{i.executeCommand(eq.COPY)}})}),(0,C.jsx)(e_.Tooltip,{content:"Delete",children:(0,C.jsx)(e_.Button,{type:"primary",theme:"solid",icon:(0,C.jsx)(o5.Z,{}),style:{height:24},onClick:()=>{i.executeCommand(eq.DELETE)}})})]})}),(0,C.jsx)("div",{children:o})]})};var nx=o(244897),nf=o(731932);let nv=e=>{let{header:t,defaultShowDetail:o,children:n,extraBtns:i=[]}=e,[r,s]=(0,L.useState)(o),{selectNode:l}=n_();return(0,C.jsxs)("div",{className:nf.Z["node-status-header"],onMouseDown:e=>e.stopPropagation(),children:[(0,C.jsxs)("div",{className:oC()(nf.Z["node-status-header-content"],r&&nf.Z["node-status-header-content-opened"]),onMouseDown:e=>e.stopPropagation(),onClick:e=>{e.stopPropagation(),l(e),s(!r)},children:[(0,C.jsxs)("div",{className:nf.Z["status-title"],children:[t,i.length>0?i:null]}),(0,C.jsx)("div",{className:nf.Z["status-btns"],children:(0,C.jsx)(nx.Z,{className:oC()({[nf.Z["is-show-detail"]]:r})})})]}),r?n:null]})},nj=e=>{let{className:t,style:o}=e;return(0,C.jsx)("svg",{className:t,style:o,width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:(0,C.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M23 12C23 18.0751 18.0751 23 12 23C5.92487 23 1 18.0751 1 12C1 5.92487 5.92487 1 12 1C18.0751 1 23 5.92487 23 12ZM11 8C11 7.44772 11.4477 7 12 7C12.5523 7 13 7.44772 13 8V13C13 13.5523 12.5523 14 12 14C11.4477 14 11 13.5523 11 13V8ZM11 16C11 15.4477 11.4477 15 12 15C12.5523 15 13 15.4477 13 16C13 16.5523 12.5523 17 12 17C11.4477 17 11 16.5523 11 16Z"})})},nC=e=>{let{className:t,style:o}=e;return(0,C.jsxs)("svg",{className:t,style:o,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"none",viewBox:"0 0 20 20",children:[(0,C.jsxs)("g",{clipPath:"url(#icon-workflow-run-success_svg__a)",children:[(0,C.jsx)("path",{fill:"#3EC254",d:"M.833 10A9.166 9.166 0 0 0 10 19.168a9.166 9.166 0 0 0 9.167-9.166A9.166 9.166 0 0 0 10 .834a9.166 9.166 0 0 0-9.167 9.167"}),(0,C.jsx)("path",{fill:"#fff",d:"M6.077 9.755a.833.833 0 0 0 0 1.179l2.357 2.357a.833.833 0 0 0 1.179 0l4.714-4.714a.833.833 0 1 0-1.178-1.179l-4.125 4.125-1.768-1.768a.833.833 0 0 0-1.179 0"})]}),(0,C.jsx)("defs",{children:(0,C.jsx)("clipPath",{id:"icon-workflow-run-success_svg__a",children:(0,C.jsx)("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]})};var nb=o(537363);let nN=e=>{let{report:t}=e,{status:o}=t,[n,i]=(0,L.useState)(0),r=t.snapshots||[],s=r[n]||r[0],l=o===tS.Pending,a=o===tS.Processing,d=o===tS.Failed,c=o===tS.Succeeded,u=o===tS.Cancelled,p=(0,L.useMemo)(()=>c?nb.Z.nodeStatusSucceed:d?nb.Z.nodeStatusFailed:a?nb.Z.nodeStatusProcessing:void 0,[c,d,a]);return t?(0,C.jsx)(nv,{header:(0,C.jsxs)(C.Fragment,{children:[a?(0,C.jsx)(ob,{spin:!0,className:oC()(nb.Z.icon,nb.Z.processing)}):c?(0,C.jsx)(nC,{}):(0,C.jsx)(nj,{className:oC()(p,nb.Z.round)}),(()=>{let e=(()=>{if(a)return"Running";if(l)return"Run terminated";if(c)return"Succeed";if(d)return"Failed";if(u)return"Cancelled"})();return e?(0,C.jsx)("p",{className:nb.Z.desc,children:e}):null})(),(0,C.jsx)(e_.Tag,{size:"small",className:p,children:(t.timeCost/1e3).toFixed(2)+"s"})]}),children:(0,C.jsxs)("div",{className:nb.Z.container,children:[d&&(null==s?void 0:s.error)&&(0,C.jsx)("div",{className:nb.Z.error,children:s.error}),(()=>{if(r.length<=1)return null;let e=(0,C.jsxs)("p",{className:nb.Z.count,children:["Total: ",r.length]});return r.length<=6?(0,C.jsxs)(C.Fragment,{children:[e,(0,C.jsx)("div",{className:nb.Z.snapshotNavigation,children:r.map((e,t)=>(0,C.jsx)(e_.Button,{size:"small",type:n===t?"primary":"tertiary",onClick:()=>i(t),className:oC()(nb.Z.snapshotButton,{[nb.Z.active]:n===t,[nb.Z.inactive]:n!==t}),children:t+1},t))})]}):(0,C.jsxs)(C.Fragment,{children:[e,(0,C.jsxs)("div",{className:nb.Z.snapshotNavigation,children:[r.slice(0,6).map((e,t)=>(0,C.jsx)(e_.Button,{size:"small",type:"tertiary",onClick:()=>i(t),className:oC()(nb.Z.snapshotButton,{[nb.Z.active]:n===t,[nb.Z.inactive]:n!==t}),children:t+1},t)),(0,C.jsx)(e_.Select,{value:n>=6?n:void 0,onChange:e=>i(e),className:oC()(nb.Z.snapshotSelect,{[nb.Z.active]:n>=6,[nb.Z.inactive]:n<6}),size:"small",placeholder:"Select",children:r.slice(6).map((e,t)=>{let o=t+6;return(0,C.jsx)(e_.Select.Option,{value:o,children:o+1},o)})})]})]})})(),(0,C.jsx)(oR,{title:"Inputs",data:null==s?void 0:s.inputs}),(0,C.jsx)(oR,{title:"Outputs",data:null==s?void 0:s.outputs}),(0,C.jsx)(oR,{title:"Branch",data:null==s?void 0:s.branch,optional:!0}),(0,C.jsx)(oR,{title:"Data",data:null==s?void 0:s.data,optional:!0})]})}):null},nw=()=>{let e=(()=>{let e=(0,b.PFB)(),[t,o]=(0,L.useState)(),n=(0,b.G2Z)(tE);return(0,L.useEffect)(()=>{let t=n.onNodeReportChange(t=>{t.id===e.id&&o(t)}),i=n.onReset(()=>{o(void 0)});return()=>{t.dispose(),i.dispose()}},[]),t})();return e?(0,C.jsx)(nN,{report:e}):null};var nM=o(676756);let nA=T.ZP.div`
  align-items: flex-start;
  background-color: #fff;
  border: 1px solid rgba(6, 7, 9, 0.15);
  border-radius: 8px;
  box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.04), 0 4px 12px 0 rgba(0, 0, 0, 0.02);
  display: flex;
  flex-direction: column;
  justify-content: center;
  position: relative;
  width: 360px;
  height: auto;

  &.selected {
    border: 1px solid #4e40e5;
  }
`,nS=()=>(0,C.jsx)(nM.Z,{style:{position:"absolute",color:"red",left:-6,top:-6,zIndex:1,background:"white",borderRadius:8}}),nk=e=>{let{children:t,isScrollToView:o=!1}=e,n=n_(),{node:i,selected:r,startDrag:s,ports:l,selectNode:a,nodeRef:d,onFocus:c,onBlur:u,readonly:p}=n,[h,g]=(0,L.useState)(!1),m=n.form,y=(0,b.sX$)(),x=n0(),f=i.getNodeMeta(),{open:v}=tF(),j=l.map(e=>(0,C.jsx)(b.Jbc,{entity:e,onClick:p?void 0:x},e.id));return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(nA,{className:r?"selected":"",ref:d,draggable:!0,onDragStart:e=>{s(e),g(!0)},onTouchStart:e=>{s(e),g(!0)},onClick:e=>{a(e),!h&&(v({nodeId:n.node.id}),o&&function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:448,n=t.transform.bounds;e.playground.scrollToView({bounds:n,scrollDelta:{x:o/2,y:0},zoom:1,scrollToCenter:!0})}(y,n.node))},onMouseUp:()=>g(!1),onFocus:c,onBlur:u,"data-node-selected":String(r),style:{...f.wrapperStyle,outline:(null==m?void 0:m.state.invalid)?"1px solid red":"none"},children:t}),j]})},nT=e=>{let{node:t}=e,o=(0,b.PVB)(),n=(0,b.sX$)(),i=o.form,r=(0,L.useCallback)(()=>n.playground.node.querySelector(".gedit-flow-render-layer"),[]);return(0,C.jsx)(e_.ConfigProvider,{getPopupContainer:r,children:(0,C.jsxs)(oU.Provider,{value:o,children:[(0,C.jsxs)(nk,{children:[(null==i?void 0:i.state.invalid)&&(0,C.jsx)(nS,{}),null==i?void 0:i.render()]}),(0,C.jsx)(nw,{})]})})};o(643930);let nD=()=>(0,C.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,C.jsxs)("g",{id:"add",children:[(0,C.jsx)("path",{id:"background",fill:"#ffffff",fillRule:"evenodd",stroke:"none",d:"M 24 12 C 24 5.372583 18.627417 0 12 0 C 5.372583 0 -0 5.372583 -0 12 C -0 18.627417 5.372583 24 12 24 C 18.627417 24 24 18.627417 24 12 Z"}),(0,C.jsx)("path",{id:"content",fill:"currentColor",fillRule:"evenodd",stroke:"none",d:"M 22 12.005 C 22 6.482153 17.522848 2.004999 12 2.004999 C 6.477152 2.004999 2 6.482153 2 12.005 C 2 17.527847 6.477152 22.004999 12 22.004999 C 17.522848 22.004999 22 17.527847 22 12.005 Z"}),(0,C.jsx)("path",{id:"cross",fill:"#ffffff",stroke:"none",d:"M 11.411996 16.411797 C 11.411996 16.736704 11.675362 17 12.00023 17 C 12.325109 17 12.588474 16.736704 12.588474 16.411797 L 12.588474 12.58826 L 16.41201 12.58826 C 16.736919 12.58826 17.000216 12.324894 17.000216 12.000015 C 17.000216 11.675147 16.736919 11.411781 16.41201 11.411781 L 12.588474 11.411781 L 12.588474 7.588234 C 12.588474 7.263367 12.325109 7 12.00023 7 C 11.675362 7 11.411996 7.263367 11.411996 7.588234 L 11.411996 11.411781 L 7.588449 11.411781 C 7.263581 11.411781 7.000215 11.675147 7.000215 12.000015 C 7.000215 12.324894 7.263581 12.58826 7.588449 12.58826 L 11.411996 12.58826 L 11.411996 16.411797 Z"})]})}),nI=e=>{let{line:t,selected:o,hovered:n,color:i}=e,r=(e=>{let t=(0,b.Dcz)(),{line:o,selected:n=!1,hovered:i}=e;return!o.disposed&&!t.config.readonly&&(!!n||!!i)})({line:t,selected:o,hovered:n}),s=(0,b.G2Z)(eo),l=(0,b.G2Z)(b.L4w),a=(0,b.G2Z)(b.iwM),d=(0,b.G2Z)(b.dmf),c=(0,b.G2Z)(b.qpv),{fromPort:u,toPort:p}=t,h=(0,L.useCallback)(async()=>{let e={x:(t.position.from.x+t.position.to.x)/2,y:(t.position.from.y+t.position.to.y)/2},o=u.node.parent,n=await s.singleSelectNodePanel({position:e,containerNode:o,panelProps:{enableScrollClose:!0,fromPort:u}});if(!n)return;let{nodeType:i,nodeJSON:r}=n,h=_({nodeType:i,position:e,fromPort:u,toPort:p,containerNode:o,document:l,dragService:a}),g=l.createWorkflowNodeByType(i,h,r??{},null==o?void 0:o.id);u&&p&&et({node:g,fromPort:u,toPort:p,containerNode:o,historyService:c,dragService:a,linesManager:d}),await (0,b.gw0)(20),$({fromPort:u,node:g,toPort:p,linesManager:d}),t.dispose()},[]);return r?(0,C.jsx)("div",{className:"line-add-button",style:{transform:`translate(-50%, -50%) translate(${t.center.labelX}px, ${t.center.labelY}px)`,color:i},"data-testid":"sdk.workflow.canvas.line.add","data-line-id":t.id,onClick:h,children:(0,C.jsx)(nD,{})}):(0,C.jsx)(C.Fragment,{})},nE=()=>(0,C.jsx)("div",{className:"node-placeholder","data-testid":"workflow.detail.node-panel.placeholder",children:(0,C.jsx)(e_.Skeleton,{className:"node-placeholder-skeleton",loading:!0,active:!0,placeholder:(0,C.jsxs)("div",{className:"",children:[(0,C.jsxs)("div",{className:"node-placeholder-hd",children:[(0,C.jsx)(e_.Skeleton.Avatar,{shape:"square",className:"node-placeholder-avatar"}),(0,C.jsx)(e_.Skeleton.Title,{style:{width:141}})]}),(0,C.jsxs)("div",{className:"node-placeholder-content",children:[(0,C.jsxs)("div",{className:"node-placeholder-footer",children:[(0,C.jsx)(e_.Skeleton.Title,{style:{width:85}}),(0,C.jsx)(e_.Skeleton.Title,{style:{width:241}})]}),(0,C.jsx)(e_.Skeleton.Title,{style:{width:220}})]})]})})}),nL=T.ZP.div`
  width: 100%;
  height: 32px;
  border-radius: 5px;
  display: flex;
  align-items: center;
  cursor: pointer;
  font-size: 19px;
  padding: 0 15px;
  &:hover {
    background-color: hsl(252deg 62% 55% / 9%);
    color: hsl(252 62% 54.9%);
  }
`,nP=T.ZP.div`
  font-size: 12px;
  margin-left: 10px;
`;function nZ(e){return(0,C.jsxs)(nL,{"data-testid":`demo-free-node-list-${e.label}`,onClick:e.disabled?void 0:e.onClick,style:e.disabled?{opacity:.3}:{},children:[(0,C.jsx)("div",{style:{fontSize:14},children:e.icon}),(0,C.jsx)(nP,{children:e.label})]})}let nz=T.ZP.div`
  max-height: 500px;
  overflow: auto;
  &::-webkit-scrollbar {
    display: none;
  }
`,nO=e=>{let{onSelect:t,containerNode:o,fromPort:n}=e,i=(0,b.sX$)();return console.log(">>> fromNode",null==n?void 0:n.node),(0,C.jsx)(nz,{style:{width:180},children:rs.filter(e=>!1!==e.meta.nodePanelVisible).filter(e=>e.meta.onlyInContainer?e.meta.onlyInContainer===(null==o?void 0:o.flowNodeType):!o||!!eJ(e.type,o.flowNodeType)).map(e=>{var o,n;return(0,C.jsx)(nZ,{disabled:!((null==(o=e.canAdd)?void 0:o.call(e,i))??!0),icon:(0,C.jsx)("img",{style:{width:10,height:10,borderRadius:4},src:null==(n=e.info)?void 0:n.icon}),label:e.type,onClick:o=>((e,o)=>{var n;let r=null==(n=o.onAdd)?void 0:n.call(o,i);t({nodeType:o.type,selectEvent:e,nodeJSON:r})})(o,e)},e.type)})})};o(84695);let nB=e=>{let{onSelect:t,position:o,onClose:n,containerNode:i,panelProps:r={}}=e,{enableNodePlaceholder:s,fromPort:l}=r,a=(0,L.useRef)(null);return(0,C.jsx)(e_.Popover,{trigger:"click",visible:!0,onVisibleChange:e=>e?null:n(),content:(0,C.jsx)(nO,{onSelect:t,containerNode:i,fromPort:l}),getPopupContainer:i?()=>a.current||document.body:void 0,placement:"right",popupAlign:{offset:[30,0]},overlayStyle:{padding:0},children:(0,C.jsx)("div",{ref:a,style:s?{position:"absolute",top:o.y-61.5,left:o.x,width:360,height:100}:{position:"absolute",top:o.y,left:o.x,width:0,height:0},children:s&&(0,C.jsx)(nE,{})})})};o(960882);var nR=((y={}).Size="size",y.Note="note",y),nV=((x={}).Init="init",x.Change="change",x.MultiSelect="multiSelect",x.Select="select",x.Blur="blur",x);class nF{get value(){return this.innerValue}setValue(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.initialized&&e!==this.innerValue&&(this.innerValue=e,this.syncEditorValue(),this.emitter.fire({type:nV.Change,value:this.innerValue}))}setInitValue(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.initialized&&e!==this.innerValue&&(this.innerValue=e,this.syncEditorValue(),this.emitter.fire({type:nV.Init,value:this.innerValue}))}set element(e){this.initialized||(this.editor=e)}get element(){return this.editor}setFocus(e){this.initialized&&(e&&!this.focused?this.editor.focus():!e&&this.focused&&(this.editor.blur(),this.deselect(),this.emitter.fire({type:nV.Blur})))}selectEnd(){if(!this.initialized)return;let e=this.editor.value.length;this.editor.setSelectionRange(e,e)}get focused(){return document.activeElement===this.editor}deselect(){let e=window.getSelection();e&&e.removeAllRanges()}get initialized(){return!!this.editor}syncEditorValue(){this.initialized&&(this.editor.value=this.innerValue)}constructor(){this.innerValue="",this.emitter=new b.Q5$,this.on=this.emitter.event}}var nQ=o(777758);let nU=e=>{var t;let{node:o,deleteNode:n,updateTitleEdit:i}=e,[r,s]=(0,L.useState)(!0),l=(0,b.sX$)(),a=o.getNodeRegistry(),d=(0,b.G2Z)(ev),c=(0,b.G2Z)(b.oJU),u=(0,b.G2Z)(b.iwM),p=d.canMoveOutContainer(o),h=(0,b.erw)(),g=(0,L.useCallback)(()=>{s(!1),requestAnimationFrame(()=>{s(!0)})},[]),m=(0,L.useCallback)(async e=>{e.stopPropagation();let t=o.parent;d.moveOutContainer({node:o}),await (0,b.gw0)(16),await d.clearInvalidLines({dragNode:o,sourceParent:t}),g(),c.selectNode(o),u.startDragSelectedNodes(e)},[d,o,g]),y=(0,L.useCallback)(e=>{let t=new e4(l),n=new e1(l),i=t.toClipboardData([o]);n.apply(i),e.stopPropagation()},[l,o]),x=(0,L.useCallback)(e=>{n(),e.stopPropagation()},[l,o]),f=(0,L.useCallback)(e=>{null==i||i(!0),e.stopPropagation()},[i]),v=(0,L.useCallback)(e=>{e.stopPropagation(),h.autoLayout({containerNode:o,enableAnimation:!0,animationDuration:1e3,disableFitView:!0})},[h]);return r?(0,C.jsx)(e_.Dropdown,{trigger:"hover",position:"bottomRight",render:(0,C.jsxs)(e_.Dropdown.Menu,{children:[(0,C.jsx)(e_.Dropdown.Item,{onClick:f,children:"Edit Title"}),p&&(0,C.jsx)(e_.Dropdown.Item,{onClick:m,children:"Move out"}),(0,C.jsx)(e_.Dropdown.Item,{onClick:y,disabled:!0===a.meta.copyDisable,children:"Create Copy"}),a.meta.isContainer&&(0,C.jsx)(e_.Dropdown.Item,{onClick:v,children:"Auto Layout"}),(0,C.jsx)(e_.Dropdown.Item,{onClick:x,disabled:!!((null==(t=a.canDelete)?void 0:t.call(a,l,o))||a.meta.deleteDisable),children:"Delete"})]}),children:(0,C.jsx)(e_.IconButton,{color:"secondary",size:"small",theme:"borderless",icon:(0,C.jsx)(nQ.Z,{}),onClick:e=>e.stopPropagation()})}):(0,C.jsx)(C.Fragment,{})},nH=e=>{let{node:t,focused:o,deleteNode:n}=e;return(0,C.jsx)("div",{className:`workflow-comment-more-button ${o?"workflow-comment-more-button-focused":""}`,children:(0,C.jsx)(nU,{node:t,deleteNode:n})})},nG=e=>{let{model:t,style:o,onChange:n}=e,i=(0,b.Dcz)(),r=(e=>{let{model:t}=e,[o,n]=(0,L.useState)("Enter a comment...");return(0,L.useEffect)(()=>{let e=t.on(e=>{(e.type===nV.Change||e.type===nV.Init)&&(e.value?n(void 0):n("Enter a comment..."))});return()=>{e.dispose()}},[t]),o})({model:t}),s=(0,L.useRef)(null);return(0,L.useEffect)(()=>{let e=t.on(e=>{e.type===nV.Change&&(null==n||n(t.value))});return()=>e.dispose()},[t,n]),(0,L.useEffect)(()=>{s.current&&(t.element=s.current)},[s]),(0,C.jsxs)("div",{className:"workflow-comment-editor",children:[(0,C.jsx)("p",{className:"workflow-comment-editor-placeholder",children:r}),(0,C.jsx)("textarea",{className:"workflow-comment-editor-textarea",ref:s,style:o,readOnly:i.config.readonly,onChange:e=>{let{value:o}=e.target;t.setValue(o)},onFocus:()=>{t.setFocus(!0)},onBlur:()=>{t.setFocus(!1)}})]})},nJ=e=>{let{model:t,stopEvent:o=!0,style:n}=e,i=(0,b.Dcz)(),{startDrag:r,onFocus:s,onBlur:l,selectNode:a}=(0,b.PVB)(),d=e=>{o&&(e.preventDefault(),e.stopPropagation()),t.setFocus(!1),r(e),a(e),i.node.focus()};return(0,C.jsx)("div",{className:"workflow-comment-drag-area","data-flow-editor-selectable":"false",draggable:!0,style:n,onMouseDown:d,onTouchStart:d,onFocus:s,onBlur:l})},nY=e=>{let{model:t,focused:o,overflow:n}=e,i=(0,b.Dcz)(),{selectNode:r}=(0,b.PVB)(),[s,l]=(0,L.useState)(!1);return(0,L.useEffect)(()=>{o||l(!1)},[o]),(0,C.jsx)("div",{className:"workflow-comment-content-drag-area",onMouseDown:e=>{if(s)return;e.preventDefault(),e.stopPropagation(),t.setFocus(!1),r(e),i.node.focus();let o=e.clientX,n=e.clientY,a=e=>{let t=e.clientX-o,i=e.clientY-n;5>Math.abs(t)&&5>Math.abs(i)&&l(!0),document.removeEventListener("mouseup",a),document.removeEventListener("click",a)};document.addEventListener("mouseup",a),document.addEventListener("click",a)},onWheel:e=>{let o=t.element;if(s||!n||!o)return;e.stopPropagation();let i=o.scrollHeight-o.clientHeight,r=Math.min(Math.max(o.scrollTop+e.deltaY,0),i);o.scroll(0,r)},style:{display:s?"none":void 0},children:(0,C.jsx)(nJ,{style:{position:"relative",width:"100%",height:"100%"},model:t,stopEvent:!1})})},nq=e=>{let{focused:t,children:o,style:n}=e;return(0,C.jsx)("div",{className:"workflow-comment-container","data-flow-editor-selectable":"false",style:{outline:t?"1px solid #FF811A":"1px solid #F2B600",backgroundColor:t?"#FFF3EA":"#FFFBED",scrollbarWidth:"thin",scrollbarColor:"rgb(159 159 158 / 65%) transparent","&:WebkitScrollbar":{width:"4px"},"&::WebkitScrollbarTrack":{background:"transparent"},"&::WebkitScrollbarThumb":{backgroundColor:"rgb(159 159 158 / 65%)",borderRadius:"20px",border:"2px solid transparent"},...n},children:o})},nX=e=>{let{model:t,onResize:o,getDelta:n,style:i}=e,r=(0,b.Dcz)(),{selectNode:s}=(0,b.PVB)(),l=e=>{if(b.UJL.preventDefault(e),e.stopPropagation(),!o)return;let{resizing:i,resizeEnd:l}=o();t.setFocus(!1),s(e),r.node.focus();let{clientX:a,clientY:d}=b.UJL.getEventCoord(e),c=e=>{let{clientX:t,clientY:o}=b.UJL.getEventCoord(e),r=null==n?void 0:n({x:t-a,y:o-d});r&&i&&i(r)},u=()=>{l(),document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",u),document.removeEventListener("click",u),document.removeEventListener("touchmove",c),document.removeEventListener("touchend",u),document.removeEventListener("touchcancel",u)};document.addEventListener("mousemove",c),document.addEventListener("mouseup",u),document.addEventListener("click",u),document.addEventListener("touchmove",c,{passive:!1}),document.addEventListener("touchend",u),document.addEventListener("touchcancel",u)};return(0,C.jsx)("div",{className:"workflow-comment-resize-area",style:i,"data-flow-editor-selectable":"false",onMouseDown:l,onTouchStart:l})},nW=e=>{let{model:t,overflow:o,onResize:n}=e;return(0,C.jsxs)("div",{style:{zIndex:999},children:[(0,C.jsx)(nJ,{style:{position:"absolute",left:-10,top:10,width:20,height:"calc(100% - 20px)"},model:t}),(0,C.jsx)(nJ,{style:{position:"absolute",right:-10,top:10,height:"calc(100% - 20px)",width:o?10:20},model:t}),(0,C.jsx)(nJ,{style:{position:"absolute",top:-10,left:10,width:"calc(100% - 20px)",height:20},model:t}),(0,C.jsx)(nJ,{style:{position:"absolute",bottom:-10,left:10,width:"calc(100% - 20px)",height:20},model:t}),(0,C.jsx)(nX,{style:{position:"absolute",left:0,top:0,cursor:"nwse-resize"},model:t,getDelta:e=>{let{x:t,y:o}=e;return{top:o,right:0,bottom:0,left:t}},onResize:n}),(0,C.jsx)(nX,{style:{position:"absolute",right:0,top:0,cursor:"nesw-resize"},model:t,getDelta:e=>{let{x:t,y:o}=e;return{top:o,right:t,bottom:0,left:0}},onResize:n}),(0,C.jsx)(nX,{style:{position:"absolute",right:0,bottom:0,cursor:"nwse-resize"},model:t,getDelta:e=>{let{x:t,y:o}=e;return{top:0,right:t,bottom:o,left:0}},onResize:n}),(0,C.jsx)(nX,{style:{position:"absolute",left:0,bottom:0,cursor:"nesw-resize"},model:t,getDelta:e=>{let{x:t,y:o}=e;return{top:0,right:0,bottom:o,left:t}},onResize:n})]})},nK=e=>{let{node:t}=e,o=(()=>{let e=(0,b.kmj)(),{selected:t}=(0,b.PVB)(),o=e.getData(b.Psq).getFormModel(),n=(0,L.useMemo)(()=>new nF,[]);return(0,L.useEffect)(()=>{t||n.setFocus(t)},[t,n]),(0,L.useEffect)(()=>{let e=o.getValueIn(nR.Note);n.setInitValue(e),n.selectEnd()},[o,n]),(0,L.useEffect)(()=>{let e=o.onFormValuesChange(e=>{let{name:t}=e;if(t!==nR.Note&&""!==t)return;let i=o.getValueIn(nR.Note);n.setValue(i)});return()=>e.dispose()},[o,n]),n})(),{selected:n,selectNode:i,nodeRef:r,deleteNode:s}=(0,b.PVB)(),l=t.getData(b.Psq).getFormModel(),a=null==l?void 0:l.formControl,{width:d,height:c,onResize:u}=(()=>{let e=(0,b.PFB)(),t=e.getNodeMeta(),o=(0,b.Dcz)(),n=(0,b.G2Z)(b.qpv),{size:i={width:240,height:150}}=t,r=e.getData(b.VOn),s=e.getData(b.Psq).getFormModel(),l=s.getValueIn(nR.Size),[a,d]=(0,L.useState)((null==l?void 0:l.width)??i.width),[c,u]=(0,L.useState)((null==l?void 0:l.height)??i.height);(0,L.useEffect)(()=>{s.getValueIn(nR.Size)||s.setValueIn(nR.Size,{width:a,height:c})},[s,a,c]),(0,L.useEffect)(()=>{let e=s.onFormValuesChange(e=>{let{name:t}=e;if(t!==nR.Size&&""!==t)return;let o=s.getValueIn(nR.Size);o&&(d(o.width),u(o.height))});return()=>e.dispose()},[s]);let p=(0,L.useCallback)(()=>{let t={width:a,height:c,originalWidth:a,originalHeight:c,positionX:r.position.x,positionY:r.position.y,offsetX:0,offsetY:0};return{resizing:e=>{if(!t)return;let{zoom:n}=o.config,i=e.top/n,s=e.right/n,l=e.bottom/n,a=e.left/n,c=Math.max(120,t.originalWidth+s-a),p=Math.max(80,t.originalHeight+l-i),h=(a>0||s<0)&&c<=120?t.offsetX:a/2+s/2,g=(i>0||l<0)&&p<=80?t.offsetY:i,m=t.positionX+h,y=t.positionY+g;t.width=c,t.height=p,t.offsetX=h,t.offsetY=g,d(c),u(p),r.update({position:{x:m,y:y}})},resizeEnd:()=>{n.transact(()=>{n.pushOperation({type:b.Nj8.dragNodes,value:{ids:[e.id],value:[{x:t.positionX+t.offsetX,y:t.positionY+t.offsetY}],oldValue:[{x:t.positionX,y:t.positionY}]}},{noApply:!0}),s.setValueIn(nR.Size,{width:t.width,height:t.height})})}}},[e,a,c,r,o,s,n]);return{width:a,height:c,onResize:p}})(),{overflow:p,updateOverflow:h}=(e=>{let{model:t,height:o}=e,n=(0,b.Dcz)(),[i,r]=(0,L.useState)(!1),s=(0,L.useCallback)(()=>!!t.element&&t.element.scrollHeight>t.element.clientHeight,[t,o,n]),l=(0,L.useCallback)(()=>{r(s())},[s]);return(0,L.useEffect)(()=>{l()},[o,l]),(0,L.useEffect)(()=>{let e=t.on(e=>{(e.type===nV.Change||e.type===nV.Init)&&l()});return()=>{e.dispose()}},[t,l]),{overflow:i,updateOverflow:l}})({model:o,height:c});return(0,C.jsx)("div",{className:"workflow-comment",style:{width:d,height:c},ref:r,"data-node-selected":String(n),onMouseEnter:h,onMouseDown:e=>{setTimeout(()=>{i(e)},20)},children:(0,C.jsx)(b.l09,{control:a,children:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(nq,{focused:n,style:{height:c},children:(0,C.jsx)(b.gNt,{name:nR.Note,children:e=>{let{field:i}=e;return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(nG,{model:o,value:i.value,onChange:i.onChange}),(0,C.jsx)(nY,{model:o,focused:n,overflow:p}),(0,C.jsx)(nH,{node:t,focused:n,deleteNode:s})]})}})}),(0,C.jsx)(nW,{model:o,overflow:p,onResize:u})]})})})};function n_(){return(0,L.useContext)(oU)}function n$(){return(0,L.useContext)(oH)}let n0=()=>{let e=(0,b.Dcz)(),t=(0,b.G2Z)(eo),o=(0,b.G2Z)(b.L4w),n=(0,b.G2Z)(b.iwM),i=(0,b.G2Z)(b.dmf);return(0,L.useCallback)(async(r,s)=>{if("input"===s.portType)return;let l=e.config.getPosFromMouseEvent(r),a=s.node.parent,d=await t.singleSelectNodePanel({position:l,containerNode:a,panelProps:{enableScrollClose:!0,fromPort:s}});if(!d)return;let{nodeType:c,nodeJSON:u}=d,p=_({nodeType:c,position:"bottom"===s.location?{x:l.x,y:l.y+100}:{x:l.x+100,y:l.y},fromPort:s,containerNode:a,document:o,dragService:n}),h=o.createWorkflowNodeByType(c,p,u??{},null==a?void 0:a.id);await (0,b.gw0)(20),$({fromPort:s,node:h,linesManager:i})},[])},n1=T.ZP.div`
  box-sizing: border-box;
  width: 100%;
  display: flex;
  flex-direction: column;
  gap: 6px;
  background-color: rgb(251, 251, 251);
  border-radius: 0 0 8px 8px;
  padding: 0 12px 12px;
`,n2=T.ZP.div`
  color: var(--semi-color-text-2);
  font-size: 12px;
  line-height: 20px;
  padding: 0px 4px;
  word-break: break-all;
  white-space: break-spaces;
`;function n3(e){var t;let{node:o,expanded:n}=n_(),i=n$(),r=o.getNodeRegistry();return(0,C.jsx)(n1,{children:(0,C.jsxs)(C.Fragment,{children:[i&&(0,C.jsx)(n2,{children:null==(t=r.info)?void 0:t.description}),(n||i)&&e.children]})})}var n4=o(637298),n5=o(510165);o(134754);let{Text:n9}=e_.Typography;function n6(e){let{children:t,name:o,required:n,description:i,type:r,labelWidth:s,labelStyle:l,vertical:a,style:d}=e,c=(0,L.useCallback)(e=>(0,C.jsx)("div",{style:{width:"0",display:"flex",flex:"1"},children:(0,C.jsxs)(n9,{style:{width:"100%"},ellipsis:{showTooltip:!!e},children:[o,n&&(0,C.jsx)("span",{style:{color:"#f93920",paddingLeft:"2px"},children:"*"})]})}),[]);return(0,C.jsxs)("div",{style:{fontSize:12,marginBottom:6,width:"100%",position:"relative",display:"flex",gap:8,...a?{flexDirection:"column"}:{justifyContent:"center",alignItems:"center"},...d},children:[(0,C.jsxs)("div",{style:{justifyContent:"center",alignItems:"center",color:"var(--semi-color-text-0)",width:s||118,minWidth:s||118,maxWidth:s||118,position:"relative",display:"flex",columnGap:4,flexShrink:0,...l},children:[r&&(0,C.jsx)(oD.s,{value:{type:r}}),i?(0,C.jsx)(e_.Tooltip,{content:i,children:c()}):c(!0)]}),(0,C.jsx)("div",{style:{flexGrow:1,minWidth:0},children:t})]})}function n8(){let{readonly:e}=n_();return(0,C.jsx)(b.gNt,{name:"inputs",children:t=>{var o,n;let{field:i}=t,r=(null==(o=i.value)?void 0:o.required)||[],s=null==(n=i.value)?void 0:n.properties;if(!s)return(0,C.jsx)(C.Fragment,{});let l=Object.keys(s).map(t=>{var o;let n=s[t],i=null==(o=n.extra)?void 0:o.formComponent,l=["prompt-editor"].includes(i||"");return(0,C.jsx)(b.gNt,{name:`inputsValues.${t}`,defaultValue:n.default,children:o=>{let{field:s,fieldState:a}=o;return(0,C.jsxs)(n6,{name:t,vertical:l,type:n.type,required:r.includes(t),children:["prompt-editor"===i&&(0,C.jsx)(n4.B,{value:s.value,onChange:s.onChange,readonly:e,hasError:Object.keys((null==a?void 0:a.errors)||{}).length>0}),!i&&(0,C.jsx)(n5.X,{value:s.value,onChange:s.onChange,readonly:e,hasError:Object.keys((null==a?void 0:a.errors)||{}).length>0,schema:n}),(0,C.jsx)(E,{errors:null==a?void 0:a.errors,warnings:null==a?void 0:a.warnings})]})}},t)});return(0,C.jsx)(C.Fragment,{children:l})}})}var n7=o(684265);let ie=T.ZP.div`
  box-sizing: border-box;
  display: flex;
  justify-content: flex-start;
  align-items: center;
  width: 100%;
  column-gap: 8px;
  border-radius: 8px 8px 0 0;
  cursor: move;

  background: linear-gradient(#f2f2ff 0%, rgb(251, 251, 251) 100%);
  overflow: hidden;

  padding: 8px;
`,it=T.ZP.div`
  font-size: 20px;
  flex: 1;
  width: 0;
`,io=T.ZP.img`
  width: 24px;
  height: 24px;
  scale: 0.8;
  border-radius: 4px;
`,ii=T.ZP.div`
  display: flex;
  align-items: center;
  column-gap: 4px;
`,{Text:ir}=e_.Typography;function is(e){let{readonly:t,titleEdit:o,updateTitleEdit:n}=e,i=(0,L.useRef)(),r=o&&!t;return(0,L.useEffect)(()=>{if(r){var e;null==(e=i.current)||e.focus()}},[r]),(0,C.jsx)(it,{children:(0,C.jsx)(b.gNt,{name:"title",children:e=>{let{field:{value:t,onChange:o},fieldState:s}=e;return(0,C.jsxs)("div",{style:{height:24},children:[r?(0,C.jsx)(e_.Input,{value:t,onChange:o,ref:i,onBlur:()=>n(!1)}):(0,C.jsx)(ir,{ellipsis:{showTooltip:!0},children:t}),(0,C.jsx)(E,{errors:null==s?void 0:s.errors})]})}})})}function il(){let{node:e,expanded:t,toggleExpand:o,readonly:n}=n_(),[i,r]=(0,L.useState)(!1),s=(0,b.sX$)(),l=n$(),{close:a}=tF();return(0,L.useEffect)(()=>{"loop"===e.flowNodeType&&function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.transform.collapsed;if(!t===e.transform.collapsed){if(!e.getNodeMeta().isContainer&&0!==e.blocks.length)return;let o=e.bounds.clone();e.transform.size={width:o.width,height:e.transform.collapsed===t?54:225},e.transform.transform.fireChange();return}let o=e.bounds.clone(),n={x:e.transform.position.x,y:e.transform.position.y};e.transform.collapsed=!t,t?e.transform.transform.update({position:{x:n.x+e.transform.padding.left,y:n.y+e.transform.padding.top},origin:{x:0,y:0}}):(e.transform.transform.clearChildren(),e.transform.transform.update({position:{x:n.x-e.transform.padding.left,y:n.y-e.transform.padding.top},origin:{x:0,y:0}}),e.transform.size={width:o.width,height:54}),e.blocks.forEach(e=>{e.lines.allLines.forEach(e=>{e.updateUIState({style:t?{...e.uiState.style,display:"block"}:{...e.uiState.style,display:"none"}})})})}(e,t)},[t]),(0,C.jsxs)(ie,{children:[(e=>{var t;let o=null==(t=e.getNodeRegistry().info)?void 0:t.icon;return o?(0,C.jsx)(io,{src:o}):null})(e),(0,C.jsx)(is,{readonly:n,updateTitleEdit:r,titleEdit:i}),e.renderData.expandable&&!l&&(0,C.jsx)(e_.Button,{type:"primary",icon:t?(0,C.jsx)(oL.Z,{}):(0,C.jsx)(n7.Z,{}),size:"small",theme:"borderless",onClick:e=>{o(),e.stopPropagation()}}),n?void 0:(0,C.jsx)(ii,{children:(0,C.jsx)(nU,{node:e,deleteNode:()=>{s.get(b.VDr).executeCommand(eq.DELETE,[e])},updateTitleEdit:r})}),l&&(0,C.jsx)(e_.Button,{type:"primary",icon:(0,C.jsx)(om.Z,{}),size:"small",theme:"borderless",onClick:()=>{a()}})]})}let ia=e=>{let{form:t}=e,o=n$();return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(il,{}),(0,C.jsx)(n3,{children:o?(0,C.jsx)(A.H,{name:"assign"}):(0,C.jsx)(S.L,{displayFromScope:!0})})]})},id={render:e=>(0,C.jsx)(ia,{...e}),effect:o2.effect,plugins:[(0,k.n)({assignKey:"assign",outputKey:"outputs"})]},ic=0,iu={type:w.Variable,info:{icon:M,description:"Variable Assign and Declaration"},meta:{size:{width:360,height:390}},onAdd:()=>({id:`variable_${(0,N.x0)(5)}`,type:"variable",data:{title:`Variable_${++ic}`,assign:[{operator:"declare",left:"sum",right:{type:"constant",content:0,schema:{type:"integer"}}}]}}),formMeta:id},ip=o.p+"static/image/icon-start.8353312d.jpg",ih={render:e=>{let{form:t}=e;return n$()?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(il,{}),(0,C.jsx)(n3,{children:(0,C.jsx)(b.gNt,{name:"outputs",render:e=>{let{field:{value:t,onChange:o}}=e;return(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(to._,{value:t,onChange:e=>o(e)})})}})})]}):(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(il,{}),(0,C.jsx)(n3,{children:(0,C.jsx)(S.L,{displayFromScope:!0})})]})},validateTrigger:b.C$T.onChange,validate:{title:e=>{let{value:t}=e;return t?void 0:"Title is required"}},effect:{title:oK.H,outputs:o_.X}},ig={type:w.Start,meta:{isStart:!0,deleteDisable:!0,copyDisable:!0,nodePanelVisible:!1,defaultPorts:[{type:"output"}],size:{width:360,height:211}},info:{icon:ip,description:"The starting node of the workflow, used to set the information needed to initiate the workflow."},formMeta:ih,canAdd:()=>!1},im=o.p+"static/image/icon-loop.89b07eed.jpg";var iy=o(683411),ix=o(332208),iv=o(316374),ij=o(48557);let iC={...o2,render:e=>{let{form:t}=e,o=n$(),{readonly:n}=n_(),i=(0,C.jsx)(b.gNt,{name:"loopFor",children:e=>{var t;let{field:o,fieldState:i}=e;return(0,C.jsxs)(n6,{name:"loopFor",type:"array",required:!0,children:[(0,C.jsx)(iy.u,{style:{width:"100%"},value:null==(t=o.value)?void 0:t.content,onChange:e=>o.onChange({type:"ref",content:e}),readonly:n,hasError:Object.keys((null==i?void 0:i.errors)||{}).length>0}),(0,C.jsx)(E,{errors:null==i?void 0:i.errors})]})}}),r=(0,C.jsx)(b.gNt,{name:"loopOutputs",children:e=>{let{field:t,fieldState:o}=e;return(0,C.jsxs)(n6,{name:"loopOutputs",type:"object",vertical:!0,children:[(0,C.jsx)(ix.U,{style:{width:"100%"},value:t.value,onChange:e=>t.onChange(e),readonly:n,hasError:Object.keys((null==o?void 0:o.errors)||{}).length>0}),(0,C.jsx)(E,{errors:null==o?void 0:o.errors})]})}});return o?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(il,{}),(0,C.jsxs)(n3,{children:[i,r]})]}):(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(il,{}),(0,C.jsxs)(n3,{children:[i,(0,C.jsx)(eP,{offsetY:-115}),(0,C.jsx)(S.L,{displayFromScope:!0})]})]})},effect:{loopFor:iv.l},plugins:[(0,ij.F)({outputKey:"loopOutputs",inferTargetKey:"outputs"})]},ib=0,iN={type:w.Loop,info:{icon:im,description:"Used to repeatedly execute a series of tasks by setting the number of iterations and logic."},meta:{isContainer:!0,size:{width:424,height:244},padding:e=>e.isContainer?{top:120,bottom:80,left:80,right:80}:{top:0,bottom:0,left:0,right:0},selectable:(e,t)=>!t||!e.getData(b.eGM).bounds.contains(t.x,t.y),wrapperStyle:{minWidth:"unset",width:"100%"}},onAdd:()=>({id:`loop_${(0,N.x0)(5)}`,type:w.Loop,data:{title:`Loop_${++ib}`},blocks:[{id:`block_start_${(0,N.x0)(5)}`,type:w.BlockStart,meta:{position:{x:32,y:0}},data:{}},{id:`block_end_${(0,N.x0)(5)}`,type:w.BlockEnd,meta:{position:{x:192,y:0}},data:{}}]}),formMeta:iC},iw=o.p+"static/image/icon-llm.de446995.jpg",iM=0,iA={type:w.LLM,info:{icon:iw,description:"Call the large language model and use variables and prompt words to generate responses."},meta:{size:{width:360,height:390}},onAdd:()=>({id:`llm_${(0,N.x0)(5)}`,type:"llm",data:{title:`LLM_${++iM}`,inputsValues:{modelName:{type:"constant",content:"gpt-3.5-turbo"},apiKey:{type:"constant",content:"sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"},apiHost:{type:"constant",content:"https://mock-ai-url/api/v3"},temperature:{type:"constant",content:.5},systemPrompt:{type:"template",content:"# Role\nYou are an AI assistant.\n"},prompt:{type:"template",content:""}},inputs:{type:"object",required:["modelName","apiKey","apiHost","temperature","prompt"],properties:{modelName:{type:"string"},apiKey:{type:"string"},apiHost:{type:"string"},temperature:{type:"number"},systemPrompt:{type:"string",extra:{formComponent:"prompt-editor"}},prompt:{type:"string",extra:{formComponent:"prompt-editor"}}}},outputs:{type:"object",properties:{result:{type:"string"}}}}})};var iS=o(401255);function ik(){let{readonly:e}=n_();return(0,C.jsxs)("div",{children:[(0,C.jsx)(n6,{name:"Timeout(ms)",required:!0,style:{flex:1},type:"number",children:(0,C.jsx)(b.gNt,{name:"timeout.timeout",defaultValue:1e4,children:t=>{let{field:o}=t;return(0,C.jsx)(e_.InputNumber,{size:"small",value:o.value,onChange:e=>{o.onChange(e)},disabled:e,style:{width:"100%"},min:0})}})}),(0,C.jsx)(n6,{name:"Retry Times",required:!0,type:"number",children:(0,C.jsx)(b.gNt,{name:"timeout.retryTimes",defaultValue:1,children:t=>{let{field:o}=t;return(0,C.jsx)(e_.InputNumber,{size:"small",value:o.value,onChange:e=>{o.onChange(e)},disabled:e,style:{width:"100%"},min:0})}})})]})}var iT=o(221191),iD=o(555328);function iI(){let{readonly:e}=n_();return n$()?(0,C.jsx)(n6,{name:"params",type:"object",vertical:!0,children:(0,C.jsx)(b.gNt,{name:"paramsValues",children:t=>{let{field:o}=t;return(0,C.jsx)(iD.P,{value:o.value,onChange:e=>o.onChange(e),readonly:e})}})}):(0,C.jsx)(n6,{name:"params",type:"object",vertical:!0,children:(0,C.jsx)(b.gNt,{name:"paramsValues",children:e=>{let{field:t}=e;return(0,C.jsx)(iT.y,{value:t.value})}})})}function iE(){let{readonly:e}=n_();return n$()?(0,C.jsx)(n6,{name:"headers",type:"object",vertical:!0,children:(0,C.jsx)(b.gNt,{name:"headersValues",children:t=>{let{field:o}=t;return(0,C.jsx)(iD.P,{value:o.value,onChange:e=>o.onChange(e),readonly:e})}})}):(0,C.jsx)(n6,{name:"headers",type:"object",vertical:!0,children:(0,C.jsx)(b.gNt,{name:"headersValues",children:e=>{let{field:t}=e;return(0,C.jsx)(iT.y,{value:t.value})}})})}var iL=o(800274);let iP=[{label:"None",value:"none"},{label:"JSON",value:"JSON"},{label:"Raw Text",value:"raw-text"}];function iZ(){let{readonly:e}=n_();return(0,C.jsx)(b.gNt,{name:"body.bodyType",defaultValue:"JSON",children:t=>{let{field:o}=t;return(0,C.jsx)("div",{style:{marginTop:5},children:(0,C.jsxs)(n6,{name:"Body",vertical:!0,type:"object",children:[(0,C.jsx)(e_.Select,{value:o.value,onChange:e=>{o.onChange(e)},style:{width:"100%",marginBottom:10},disabled:e,size:"small",optionList:iP}),(t=>{switch(t){case"JSON":return(0,C.jsx)(b.gNt,{name:"body.json",children:t=>{var o;let{field:n}=t;return(0,C.jsx)(iL.s,{value:null==(o=n.value)?void 0:o.content,readonly:e,activeLinePlaceholder:"use var by '@'",onChange:e=>{n.onChange({type:"template",content:e})}})}});case"raw-text":return(0,C.jsx)(b.gNt,{name:"body.rawText",children:t=>{let{field:o}=t;return(0,C.jsx)(n4.B,{disableMarkdownHighlight:!0,readonly:e,style:{flexGrow:1},placeholder:"Input raw text, use var by '{'",onChange:e=>{o.onChange(e)}})}});default:return null}})(o.value)]})})}})}function iz(){let{readonly:e}=n_();return(0,C.jsx)("div",{children:(0,C.jsx)(n6,{name:"API",required:!0,vertical:!0,type:"string",children:(0,C.jsxs)("div",{style:{display:"flex",gap:5},children:[(0,C.jsx)(b.gNt,{name:"api.method",defaultValue:"GET",children:t=>{let{field:o}=t;return(0,C.jsx)(e_.Select,{value:o.value,onChange:e=>{o.onChange(e)},style:{width:85,maxWidth:85,minWidth:85},size:"small",disabled:e,optionList:[{label:"GET",value:"GET"},{label:"POST",value:"POST"},{label:"PUT",value:"PUT"},{label:"DELETE",value:"DELETE"},{label:"PATCH",value:"PATCH"},{label:"HEAD",value:"HEAD"}]})}}),(0,C.jsx)(b.gNt,{name:"api.url",children:t=>{let{field:o}=t;return(0,C.jsx)(n4.B,{disableMarkdownHighlight:!0,readonly:e,style:{flexGrow:1},placeholder:"Input URL, use var by '{'",value:o.value,onChange:e=>{o.onChange(e)}})}})]})})})}let iO=e=>{let{form:t}=e;return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(il,{}),(0,C.jsxs)(n3,{children:[(0,C.jsx)(iz,{}),(0,C.jsx)(e_.Divider,{}),(0,C.jsx)(iE,{}),(0,C.jsx)(e_.Divider,{}),(0,C.jsx)(iI,{}),(0,C.jsx)(e_.Divider,{}),(0,C.jsx)(iZ,{}),(0,C.jsx)(e_.Divider,{}),(0,C.jsx)(ik,{}),(0,C.jsx)(e_.Divider,{}),(0,C.jsx)(S.L,{displayFromScope:!0})]})]})},iB={render:e=>(0,C.jsx)(iO,{...e}),effect:o2.effect,plugins:[(0,iS.k)({sourceKey:"headersValues",targetKey:"headers"}),(0,iS.k)({sourceKey:"paramsValues",targetKey:"params"})]},iR=0,iV={type:w.HTTP,info:{icon:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDQwIDQwIiBmaWxsPSJub25lIj4KICA8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIKICAgIGQ9Ik0yMC4wMDYgNEMyMi4xNDUgNCAyMy45ODUzIDcuMzk4NTUgMjQuNzY1MSAxMi4yNDFIMTUuMjQ2OUMxNi4wMjY3IDcuMzk4NTUgMTcuODY3IDQgMjAuMDA2IDRaTTE1LjAyMSAyMC45MTE5QzE0LjkwOCAxOS44MDIzIDE0Ljg0MjQgMTguNjQ4NiAxNC44NDI0IDE3LjQ0MzZDMTQuODQyNCAxNi4yNDIxIDE0LjkwOCAxNS4wODQ4IDE1LjAyMSAxMy45NzUySDI0Ljk4MzdDMjUuMDk2NiAxNS4wODQ4IDI1LjE2MjMgMTYuMjQyMSAyNS4xNjIzIDE3LjQ0MzZDMjUuMTYyMyAxOC42NDUgMjUuMDk2NiAxOS43OTg3IDI0Ljk4MzcgMjAuOTExOUgxNS4wMjFaTTIzLjgwNDQgNC41NjE5OUMyNy42NTI1IDUuNzExOTkgMzAuNzY0NCA4LjU1OTQyIDMyLjMwMjIgMTIuMjQwOUgyNi40OTM2QzI2LjAxOTkgOS4xNTQ2MyAyNS4xMTYyIDYuMzk1MzcgMjMuODA0NCA0LjU2MTk5Wk0xNi4xOTcxIDQuNTYxOTlDMTIuMzU2MyA1LjcxMTk5IDkuMjM3MDEgOC41NTk0MiA3LjcwNjUyIDEyLjI0MDlIMTMuNTE1MUMxMy45ODE1IDkuMTU0NjMgMTQuODg1MiA2LjM5NTM3IDE2LjE5NzEgNC41NjE5OVpNMjYuNzExOSAxMy45NzUySDMyLjg3NzZDMzMuMTY5MSAxNS4wODQ4IDMzLjMzNjggMTYuMjQyMSAzMy4zMzY4IDE3LjQ0MzZDMzMuMzM2OCAxOC42NDUgMzMuMTY5MSAxOS43OTg3IDMyLjg3NCAyMC45MTE5SDI2LjcxMTlDMjYuODI0OSAxOS43NzY2IDI2Ljg5MDYgMTguNjA4MyAyNi44OTA2IDE3LjQ0MzZDMjYuODkwNiAxNi4yNzg5IDI2LjgyNDkgMTUuMTE0MiAyNi43MTE5IDEzLjk3NTJaTTEzLjEyMiAxNy40NDM2QzEzLjEyMiAxNi4yNzg5IDEzLjE4NzYgMTUuMTEwNSAxMy4zMDA2IDEzLjk3NTJINy4xMzEyN0M2LjgzOTc1IDE1LjA4ODUgNi42Njg0OCAxNi4yNDIxIDYuNjY4NDggMTcuNDQzNkM2LjY2ODQ4IDE4LjY0NSA2LjgzOTc1IDE5LjgwMjMgNy4xMzEyNyAyMC45MTJIMTMuMjkzM0MxMy4xODc2IDE5Ljc3NjcgMTMuMTIyIDE4LjYxMTkgMTMuMTIyIDE3LjQ0MzZaTTQgMjUuMzM3M0M0IDIzLjgwMDUgNS4yNDU4MiAyMi41NTQ3IDYuNzgyNjEgMjIuNTU0N0gzMy4yMTc0QzM0Ljc1NDIgMjIuNTU0NyAzNiAyMy44MDA1IDM2IDI1LjMzNzNWMzMuMjE3NEMzNiAzNC43NTQyIDM0Ljc1NDIgMzYgMzMuMjE3NCAzNkg2Ljc4MjYxQzUuMjQ1ODIgMzYgNCAzNC43NTQyIDQgMzMuMjE3NFYyNS4zMzczWk0xMC45MTA5IDI4LjE1NjlIOC40ODY2NlYyNS45MTYxSDYuNjY4NDhWMzIuNjM4OEg4LjQ4NjY2VjI5LjgzNzZIMTAuOTEwOVYzMi42Mzg4SDEyLjcyOTFWMjUuOTE2MUgxMC45MTA5VjI4LjE1NjlaTTEzLjk0MTIgMjcuNTk2OEgxNS43NTk0VjMyLjYzODhIMTcuNTc3NlYyNy41OTY4SDE5LjM5NThWMjUuOTE2MUgxMy45NDEyVjI3LjU5NjhaTTIwLjYwNzkgMjcuNTk2OEgyMi40MjZWMzIuNjM4OEgyNC4yNDQyVjI3LjU5NjhIMjYuMDYyNVYyNS45MTYxSDIwLjYwNzlWMjcuNTk2OFpNMzEuNTE2OSAyNS45MTYxSDI3LjI3NDZWMzIuNjM4OEgyOS4wOTI3VjMwLjM5NzlIMzEuNTE2OUMzMi41NDcyIDMwLjM5NzkgMzMuMzM1MSAyOS42Njk2IDMzLjMzNTEgMjguNzE3MlYyNy41OTY4QzMzLjMzNTEgMjYuNjQ0NSAzMi41NDcyIDI1LjkxNjEgMzEuNTE2OSAyNS45MTYxWk0zMS41MTY5IDI4LjcxNzJIMjkuMDkyN1YyNy41OTY4SDMxLjUxNjlWMjguNzE3MloiCiAgICBmaWxsPSIjMzM3MEZGIiAvPgo8L3N2Zz4K",description:"Call the HTTP API"},meta:{size:{width:360,height:390}},onAdd:()=>({id:`http_${(0,N.x0)(5)}`,type:"http",data:{title:`HTTP_${++iR}`,api:{method:"GET"},body:{bodyType:"JSON"},headers:{},params:{},outputs:{type:"object",properties:{body:{type:"string"},headers:{type:"object"},statusCode:{type:"integer"}}}}}),formMeta:iB},iF=0,iQ={type:b.SyX.GROUP,meta:{renderKey:b.SyX.GROUP,defaultPorts:[],isContainer:!0,disableSideBar:!0,size:{width:560,height:400},padding:()=>({top:80,bottom:40,left:65,right:65}),selectable:(e,t)=>!t||!e.getData(b.eGM).bounds.contains(t.x,t.y),expandable:!1,nodePanelVisible:!1},formMeta:{render:()=>(0,C.jsx)(C.Fragment,{})},onAdd:()=>({type:b.SyX.GROUP,id:`group_${(0,b.x0q)(5)}`,meta:{position:{x:0,y:0}},data:{color:"Green",title:`Group_${++iF}`}})},iU=o.p+"static/image/icon-end.ac3dc81e.jpg",iH={...o2,render:()=>n$()?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(il,{}),(0,C.jsx)(n3,{children:(0,C.jsx)(b.gNt,{name:"inputsValues",children:e=>{let{field:{value:t,onChange:o}}=e;return(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(iD.P,{value:t,onChange:e=>o(e)})})}})})]}):(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(il,{}),(0,C.jsx)(n3,{children:(0,C.jsx)(b.gNt,{name:"inputsValues",children:e=>{let{field:{value:t}}=e;return(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(iT.y,{value:t})})}})})]}),plugins:[(0,iS.k)({sourceKey:"inputsValues",targetKey:"inputs"})]},iG={type:w.End,meta:{deleteDisable:!0,copyDisable:!0,nodePanelVisible:!1,defaultPorts:[{type:"input"}],size:{width:360,height:211}},info:{icon:iU,description:"The final node of the workflow, used to return the result information after the workflow is run."},formMeta:iH,canAdd:()=>!1},iJ=o.p+"static/image/icon-continue.4d103752.jpg",iY={...o2,render:()=>(n$(),(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(il,{}),(0,C.jsx)(n3,{})]}))},iq=0,iX={type:w.Continue,meta:{defaultPorts:[{type:"input"}],sidebarDisabled:!0,size:{width:360,height:54},expandable:!1,onlyInContainer:w.Loop},info:{icon:iJ,description:"The final node of the workflow, used to return the result information after the workflow is run."},formMeta:iY,onAdd:()=>({id:`continue_${(0,N.x0)(5)}`,type:"continue",data:{title:`Continue_${++iq}`}})};var iW=o(318036),iK=o(562913);let i_=T.ZP.div`
  position: absolute;
  right: -12px;
  top: 50%;
`;function i$(){let{node:e,readonly:t}=n_();return(0,L.useLayoutEffect)(()=>{window.requestAnimationFrame(()=>{e.ports.updateDynamicPorts()})},[e]),(0,C.jsx)(b.F26,{name:"conditions",children:e=>{let{field:o}=e;return(0,C.jsxs)(C.Fragment,{children:[o.map((e,n)=>(0,C.jsx)(b.gNt,{name:e.name,children:e=>{let{field:i,fieldState:r}=e;return(0,C.jsxs)(n6,{name:"if",type:"boolean",required:!0,labelWidth:50,children:[(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,C.jsx)(iW.i,{readonly:t,style:{flexGrow:1,overflow:"hidden"},value:i.value.value,onChange:e=>i.onChange({value:e,key:i.value.key})}),!t&&(0,C.jsx)(e_.Button,{theme:"borderless",disabled:t,icon:(0,C.jsx)(iK.Z,{}),onClick:()=>o.delete(n)})]}),(0,C.jsx)(E,{errors:null==r?void 0:r.errors,invalid:null==r?void 0:r.invalid}),(0,C.jsx)(i_,{"data-port-id":i.value.key,"data-port-type":"output"})]})}},e.name)),(0,C.jsx)(n6,{name:"else",type:"boolean",required:!0,labelWidth:100,children:(0,C.jsx)(i_,{"data-port-id":"else","data-port-type":"output"})}),!t&&(0,C.jsx)("div",{children:(0,C.jsx)(e_.Button,{theme:"borderless",icon:(0,C.jsx)(tJ.Z,{}),onClick:()=>o.append({key:`if_${(0,N.x0)(6)}`,value:{type:"expression",content:""}}),children:b.oci.t("Add")})})]})}})}let i0={render:e=>{let{form:t}=e;return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(il,{}),(0,C.jsx)(n3,{children:(0,C.jsx)(i$,{})})]})},validateTrigger:b.C$T.onChange,validate:{title:e=>{let{value:t}=e;return t?void 0:"Title is required"},"conditions.*":e=>{let{value:t}=e;if(!(null==t?void 0:t.value))return"Condition is required"}},effect:{conditions:o$.g}},i1={type:w.Condition,info:{icon:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iNDQiIGhlaWdodD0iNDUiIHZpZXdCb3g9IjAgMCA0NCA0NSIgZmlsbD0ibm9uZSIgY2xhc3M9ImluamVjdGVkLXN2ZyIgZGF0YS1zcmM9Imh0dHBzOi8vbGYzLXN0YXRpYy5ieXRlZG5zZG9jLmNvbS9vYmovZWRlbi1jbi91dnBhaHR2YWJoX2xtX3poaHdoL2xqaHdadGhsYXVramxrdWx6bHAvYWN0aXZpdHlfaWNvbnMvZXhjbHVzaXZlLXNwbGl0LTA1MTguc3ZnIj4KICA8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTE2LjQ3MDUgMTQuMDE1MkMxNS4yOTkgMTIuODQzNiAxNS4yOTkgMTAuOTQ0IDE2LjQ3MDUgOS43NzI0NEwyMC43MTMxIDUuNTI5N0MyMS44ODQ2IDQuMzU4MSAyMy43ODQgNC4zNTgxIDI0Ljk1NTYgNS41Mjk3TDI5LjE5ODEgOS43NzI0NEMzMC4zNjk3IDEwLjk0NCAzMC4zNjk3IDEyLjg0MzYgMjkuMTk4MSAxNC4wMTUyTDI1LjEyMDYgMTguMDkyOUgzMi42Njc0QzM2LjUzMzQgMTguMDkyOSAzOS42Njc0IDIxLjIyNjkgMzkuNjY3NCAyNS4wOTI5VjMzLjE1NFYzMy4zMjcxVjM3LjE1NEMzOS42Njc0IDM4LjI1ODUgMzguNzcxOSAzOS4xNTQgMzcuNjY3NCAzOS4xNTRIMzMuNjY3NEMzMi41NjI4IDM5LjE1NCAzMS42Njc0IDM4LjI1ODUgMzEuNjY3NCAzNy4xNTRWMzMuMzI3MVYzMy4xNTRWMjYuMDkyOUgyMy41OTQ4SDE1LjY2NzRWMzMuMTMyN0wxNy4yNjg1IDMzLjEyNDRDMTguODM5NyAzMy4xMTYzIDE5LjYzMjIgMzUuMDE1NiAxOC41MjEyIDM2LjEyNjZMMTIuNzM3NCA0MS45MTAzQzEyLjA1MDYgNDIuNTk3MSAxMC45MzcxIDQyLjU5NzEgMTAuMjUwMyA0MS45MTAzTDQuNTI1ODggMzYuMTg1OUMzLjQyMTA3IDM1LjA4MTEgNC4xOTc5NyAzMy4xOTE3IDUuNzYwMzggMzMuMTgzN0w3LjY2NzM3IDMzLjE3MzlWMjUuMDkyOUM3LjY2NzM3IDIxLjIyNyAxMC44MDE0IDE4LjA5MjkgMTQuNjY3NCAxOC4wOTI5SDIwLjU0ODFMMTYuNDcwNSAxNC4wMTUyWiIgZmlsbD0idXJsKCNwYWludDBfbGluZWFyXzI3NTJfMTgzNzAyLTcpIi8+CiAgPGRlZnM+CiAgICA8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50MF9saW5lYXJfMjc1Ml8xODM3MDItNyIgeDE9IjM4LjUyIiB5MT0iNDMuMzkxNSIgeDI9IjguMDk2ODYiIHkyPSI0LjY5ODIiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KICAgICAgPHN0b3Agc3RvcC1jb2xvcj0iIzMzNzBGRiIvPgogICAgICA8c3RvcCBvZmZzZXQ9IjAuOTk3OTA4IiBzdG9wLWNvbG9yPSIjMzNBOUZGIi8+CiAgICA8L2xpbmVhckdyYWRpZW50PgogIDwvZGVmcz4KPC9zdmc+Cg==",description:"Connect multiple downstream branches. Only the corresponding branch will be executed if the set conditions are met."},meta:{defaultPorts:[{type:"input"}],useDynamicPort:!0,expandable:!1,size:{width:360,height:210}},formMeta:i0,onAdd:()=>({id:`condition_${(0,N.x0)(5)}`,type:"condition",data:{title:"Condition",conditions:[{key:`if_${(0,N.x0)(5)}`,value:{}},{key:`if_${(0,N.x0)(5)}`,value:{}}]}})},i2={type:w.Comment,meta:{sidebarDisabled:!0,nodePanelVisible:!1,defaultPorts:[],renderKey:w.Comment,size:{width:240,height:150}},formMeta:{render:()=>(0,C.jsx)(C.Fragment,{})},getInputPoints:()=>[],getOutputPoints:()=>[]};function i3(){let{readonly:e}=n_();return n$()?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(e_.Divider,{}),(0,C.jsx)(n6,{name:"outputs",type:"object",vertical:!0,children:(0,C.jsx)(b.gNt,{name:"outputs",children:t=>{let{field:o}=t;return(0,C.jsx)(to._,{readonly:e,value:o.value,onChange:e=>o.onChange(e)})}})})]}):(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(e_.Divider,{}),(0,C.jsx)(b.gNt,{name:"outputs",children:e=>{let{field:t}=e;return(0,C.jsx)(S.L,{value:t.value})}})]})}function i4(){let e=n$(),{readonly:t}=n_();return e?(0,C.jsx)(n6,{name:"inputs",type:"object",vertical:!0,children:(0,C.jsx)(b.gNt,{name:"inputsValues",children:e=>{let{field:o}=e;return(0,C.jsx)(iD.P,{value:o.value,onChange:e=>o.onChange(e),readonly:t})}})}):(0,C.jsx)(b.gNt,{name:"inputsValues",children:e=>{let{field:t}=e;return(0,C.jsx)(iT.y,{value:t.value})}})}var i5=o(168059);function i9(){let e=n$(),{readonly:t}=n_();return e?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(e_.Divider,{}),(0,C.jsx)(b.gNt,{name:"script.content",children:e=>{let{field:o}=e;return(0,C.jsx)(i5.T,{value:o.value,onChange:e=>o.onChange(e),readonly:t})}})]}):null}let i6=e=>{let{form:t}=e;return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(il,{}),(0,C.jsxs)(n3,{children:[(0,C.jsx)(i4,{}),(0,C.jsx)(i9,{}),(0,C.jsx)(i3,{})]})]})},i8={render:e=>(0,C.jsx)(i6,{...e}),effect:o2.effect,validate:o2.validate,plugins:[(0,iS.k)({sourceKey:"inputsValues",targetKey:"inputs"})]},i7=0,re=`// Here, you can retrieve input variables from the node using 'params' and output results using 'ret'.
// 'params' has been correctly injected into the environment.
// Here's an example of getting the value of the parameter named 'input' from the node input:
// const input = params.input;
// Here's an example of outputting a 'ret' object containing multiple data types:
// const ret = { "name": 'Xiaoming', "hobbies": ["Reading", "Traveling"] };

async function main({ params }) {
  // Build the output object
  const ret = {
    key0: params.input + params.input, // Concatenate the input parameter 'input' twice
    key1: ["hello", "world"], // Output an array
    key2: { // Output an Object
      key21: "hi"
    },
  };

  return ret;
}`,rt={type:w.Code,info:{icon:"data:image/png;base64,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",description:"Run the Script"},meta:{size:{width:360,height:390}},onAdd:()=>({id:`code_${(0,N.x0)(5)}`,type:"code",data:{title:`Code_${++i7}`,inputsValues:{input:{type:"constant",content:""}},script:{language:"javascript",content:re},outputs:{type:"object",properties:{key0:{type:"string"},key1:{type:"array",items:{type:"string"}},key2:{type:"object",properties:{key21:{type:"string"}}}}}}}),formMeta:i8},ro=o.p+"static/image/icon-break.362f1db9.jpg",rn={...o2,render:()=>(n$(),(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(il,{}),(0,C.jsx)(n3,{})]}))},ri=0,rr={type:w.Break,meta:{defaultPorts:[{type:"input"}],sidebarDisabled:!0,size:{width:360,height:54},expandable:!1,onlyInContainer:w.Loop},info:{icon:ro,description:"The final node of the workflow, used to return the result information after the workflow is run."},formMeta:rn,onAdd:()=>({id:`break_${(0,N.x0)(5)}`,type:"break",data:{title:`Break_${++ri}`}})},rs=[i1,ig,iG,iA,iN,i2,{type:w.BlockStart,meta:{isStart:!0,deleteDisable:!0,copyDisable:!0,sidebarDisabled:!0,nodePanelVisible:!1,defaultPorts:[{type:"output"}],size:{width:100,height:100},wrapperStyle:{minWidth:"unset",width:"100%",borderWidth:2,borderRadius:12,cursor:"move"}},info:{icon:ip,description:"The starting node of the block."},formMeta:{render:e=>{let{form:t}=e;return(0,C.jsx)(C.Fragment,{children:(0,C.jsx)("div",{style:{width:60,height:60,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,C.jsx)(e_.Avatar,{shape:"circle",style:{width:40,height:40,borderRadius:"50%",cursor:"move"},alt:"Icon",src:ip})})})}},canAdd:()=>!1},{type:w.BlockEnd,meta:{isNodeEnd:!0,deleteDisable:!0,copyDisable:!0,sidebarDisabled:!0,nodePanelVisible:!1,defaultPorts:[{type:"input"}],size:{width:100,height:100},wrapperStyle:{minWidth:"unset",width:"100%",borderWidth:2,borderRadius:12,cursor:"move"}},info:{icon:ip,description:"The final node of the block."},formMeta:{render:e=>{let{form:t}=e;return(0,C.jsx)(C.Fragment,{children:(0,C.jsx)("div",{style:{width:60,height:60,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,C.jsx)(e_.Avatar,{shape:"circle",style:{width:40,height:40,borderRadius:"50%",cursor:"move"},alt:"Icon",src:iU})})})}},canAdd:()=>!1},iV,rt,iX,rr,iu,iQ],rl={nodes:[{id:"start_0",type:"start",meta:{position:{x:180,y:601.2}},data:{title:"Start",outputs:{type:"object",properties:{query:{type:"string",default:"Hello Flow."},enable:{type:"boolean",default:!0},array_obj:{type:"array",items:{type:"object",properties:{int:{type:"number"},str:{type:"string"}}}}}}}},{id:"condition_0",type:"condition",meta:{position:{x:1100,y:546.2}},data:{title:"Condition",conditions:[{key:"if_0",value:{left:{type:"ref",content:["start_0","query"]},operator:"contains",right:{type:"constant",content:"Hello Flow."}}}]}},{id:"end_0",type:"end",meta:{position:{x:2968,y:601.2}},data:{title:"End",inputsValues:{success:{type:"constant",content:!0,schema:{type:"boolean"}},query:{type:"ref",content:["start_0","query"]}},inputs:{type:"object",properties:{success:{type:"boolean"},query:{type:"string"}}}}},{id:"159623",type:"comment",meta:{position:{x:180,y:775.2}},data:{size:{width:240,height:150},note:"hi ~\n\nthis is a comment node\n\n- flowgram.ai"}},{id:"http_rDGIH",type:"http",meta:{position:{x:640,y:421.35}},data:{title:"HTTP_1",outputs:{type:"object",properties:{body:{type:"string"},headers:{type:"object"},statusCode:{type:"integer"}}},api:{method:"GET",url:{type:"template",content:""}},body:{bodyType:"JSON"},timeout:{timeout:1e4,retryTimes:1}}},{id:"loop_Ycnsk",type:"loop",meta:{position:{x:1460,y:0}},data:{title:"Loop_1",loopFor:{type:"ref",content:["start_0","array_obj"]},loopOutputs:{acm:{type:"ref",content:["llm_6aSyo","result"]}},outputs:{type:"object",required:[],properties:{acm:{type:"array",items:{type:"string"}}}}},blocks:[{id:"llm_6aSyo",type:"llm",meta:{position:{x:344,y:0}},data:{title:"LLM_3",inputsValues:{modelName:{type:"constant",content:"gpt-3.5-turbo"},apiKey:{type:"constant",content:"sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"},apiHost:{type:"constant",content:"https://mock-ai-url/api/v3"},temperature:{type:"constant",content:.5},systemPrompt:{type:"template",content:"# Role\nYou are an AI assistant.\n"},prompt:{type:"template",content:""}},inputs:{type:"object",required:["modelName","apiKey","apiHost","temperature","prompt"],properties:{modelName:{type:"string"},apiKey:{type:"string"},apiHost:{type:"string"},temperature:{type:"number"},systemPrompt:{type:"string",extra:{formComponent:"prompt-editor"}},prompt:{type:"string",extra:{formComponent:"prompt-editor"}}}},outputs:{type:"object",properties:{result:{type:"string"}}}}},{id:"llm_ZqKlP",type:"llm",meta:{position:{x:804,y:0}},data:{title:"LLM_4",inputsValues:{modelName:{type:"constant",content:"gpt-3.5-turbo"},apiKey:{type:"constant",content:"sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"},apiHost:{type:"constant",content:"https://mock-ai-url/api/v3"},temperature:{type:"constant",content:.5},systemPrompt:{type:"template",content:"# Role\nYou are an AI assistant.\n"},prompt:{type:"template",content:""}},inputs:{type:"object",required:["modelName","apiKey","apiHost","temperature","prompt"],properties:{modelName:{type:"string"},apiKey:{type:"string"},apiHost:{type:"string"},temperature:{type:"number"},systemPrompt:{type:"string",extra:{formComponent:"prompt-editor"}},prompt:{type:"string",extra:{formComponent:"prompt-editor"}}}},outputs:{type:"object",properties:{result:{type:"string"}}}}},{id:"block_start_PUDtS",type:"block-start",meta:{position:{x:32,y:167.1}},data:{}},{id:"block_end_leBbs",type:"block-end",meta:{position:{x:1116,y:167.1}},data:{}}],edges:[{sourceNodeID:"block_start_PUDtS",targetNodeID:"llm_6aSyo"},{sourceNodeID:"llm_6aSyo",targetNodeID:"llm_ZqKlP"},{sourceNodeID:"llm_ZqKlP",targetNodeID:"block_end_leBbs"}]},{id:"group_nYl6D",type:"group",meta:{position:{x:1624,y:698.2}},data:{parentID:"root",blockIDs:["llm_8--A3","llm_vTyMa"]}},{id:"llm_8--A3",type:"llm",meta:{position:{x:180,y:0}},data:{title:"LLM_1",inputsValues:{modelName:{type:"constant",content:"gpt-3.5-turbo"},apiKey:{type:"constant",content:"sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"},apiHost:{type:"constant",content:"https://mock-ai-url/api/v3"},temperature:{type:"constant",content:.5},systemPrompt:{type:"template",content:"# Role\nYou are an AI assistant.\n"},prompt:{type:"template",content:"# User Input\nquery:{{start_0.query}}\nenable:{{start_0.enable}}"}},inputs:{type:"object",required:["modelName","apiKey","apiHost","temperature","prompt"],properties:{modelName:{type:"string"},apiKey:{type:"string"},apiHost:{type:"string"},temperature:{type:"number"},systemPrompt:{type:"string",extra:{formComponent:"prompt-editor"}},prompt:{type:"string",extra:{formComponent:"prompt-editor"}}}},outputs:{type:"object",properties:{result:{type:"string"}}}}},{id:"llm_vTyMa",type:"llm",meta:{position:{x:640,y:10}},data:{title:"LLM_2",inputsValues:{modelName:{type:"constant",content:"gpt-3.5-turbo"},apiKey:{type:"constant",content:"sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"},apiHost:{type:"constant",content:"https://mock-ai-url/api/v3"},temperature:{type:"constant",content:.5},systemPrompt:{type:"template",content:"# Role\nYou are an AI assistant.\n"},prompt:{type:"template",content:"# LLM Input\nresult:{{llm_8--A3.result}}"}},inputs:{type:"object",required:["modelName","apiKey","apiHost","temperature","prompt"],properties:{modelName:{type:"string"},apiKey:{type:"string"},apiHost:{type:"string"},temperature:{type:"number"},systemPrompt:{type:"string",extra:{formComponent:"prompt-editor"}},prompt:{type:"string",extra:{formComponent:"prompt-editor"}}}},outputs:{type:"object",properties:{result:{type:"string"}}}}}],edges:[{sourceNodeID:"start_0",targetNodeID:"http_rDGIH"},{sourceNodeID:"http_rDGIH",targetNodeID:"condition_0"},{sourceNodeID:"condition_0",targetNodeID:"loop_Ycnsk",sourcePortID:"if_0"},{sourceNodeID:"condition_0",targetNodeID:"llm_8--A3",sourcePortID:"else"},{sourceNodeID:"llm_vTyMa",targetNodeID:"end_0"},{sourceNodeID:"loop_Ycnsk",targetNodeID:"end_0"},{sourceNodeID:"llm_8--A3",targetNodeID:"llm_vTyMa"}],globalVariable:{type:"object",required:[],properties:{userId:{type:"string"}}}},ra=()=>{let e=(0,L.useMemo)(()=>({background:!0,playground:{preventGlobalGesture:!0},readonly:!1,twoWayConnection:!0,initialData:rl,nodeRegistries:rs,getNodeDefaultRegistry:e=>({type:e,meta:{defaultExpanded:!0},formMeta:o2}),fromNodeJSON:(e,t)=>t,toNodeJSON:(e,t)=>t,lineColor:{hidden:"var(--g-workflow-line-color-hidden,transparent)",default:"var(--g-workflow-line-color-default,#4d53e8)",drawing:"var(--g-workflow-line-color-drawing, #5DD6E3)",hovered:"var(--g-workflow-line-color-hover,#37d0ff)",selected:"var(--g-workflow-line-color-selected,#37d0ff)",error:"var(--g-workflow-line-color-error,red)",flowing:"var(--g-workflow-line-color-flowing,#4d53e8)"},canAddLine(e,t,o){var n,i,r,s;return t.node!==o.node&&((null==(n=t.node.parent)?void 0:n.id)===(null==(i=o.node.parent)?void 0:i.id)||!![null==(r=t.node.parent)?void 0:r.flowNodeType,null==(s=o.node.parent)?void 0:s.flowNodeType].includes(b.SyX.GROUP))&&!t.node.lines.allInputNodes.includes(o.node)},canDeleteLine:(e,t,o,n)=>!0,canDeleteNode:(e,t)=>!0,canDropToNode:(e,t)=>eJ(t.dragNodeType,t.dropNodeType),canResetLine:(e,t,o)=>!0,onDragLineEnd:eG,selectBox:{SelectorBoxPopover:ny},scroll:{enableScrollLimit:!1},materials:{components:{},renderDefaultNode:nT,renderNodes:{[w.Comment]:nK}},nodeEngine:{enable:!0},variableEngine:{enable:!0},history:{enable:!0,enableChangeNode:!0},onContentChange:(0,P.Z)((e,t)=>{e.document.disposed||console.log("Auto Save: ",t,{...e.document.toJSON(),globalVariable:e.get(tc)()})},1e3),isFlowingLine:(e,t)=>e.get(tE).isFlowingLine(t),shortcuts:e9,onBind:e=>{let{bind:t}=e;t(e8).toSelf().inSingletonScope(),t(e7).toSelf().inSingletonScope()},onInit(e){console.log("--- Playground init ---")},onAllLayersRendered(e){e.tools.fitView(!1),console.log("--- Playground rendered ---")},onDispose(){console.log("---- Playground Dispose ----")},i18n:{locale:navigator.language,languages:{"zh-CN":{"Never Remind":"不再提示","Hold {{key}} to drag node out":"按住 {{key}} 可以将节点拖出"},"en-US":{}}},plugins:()=>[(0,z.createFreeStackPlugin)({sortNodes:e=>{let t=[],o=[];return e.forEach(e=>{e.flowNodeType===w.Comment?t.push(e):o.push(e)}),[...t,...o]}}),(0,er.J2)({renderInsideLine:nI}),(0,Z.qP)({disableLayer:!0,canvasStyle:{canvasWidth:182,canvasHeight:102,canvasPadding:50,canvasBackground:"rgba(242, 243, 245, 1)",canvasBorderRadius:10,viewportBackground:"rgba(255, 255, 255, 1)",viewportBorderRadius:4,viewportBorderColor:"rgba(6, 7, 9, 0.10)",viewportBorderWidth:1,viewportBorderDashLength:void 0,nodeColor:"rgba(0, 0, 0, 0.10)",nodeBorderRadius:2,nodeBorderWidth:.145,nodeBorderColor:"rgba(6, 7, 9, 0.10)",overlayColor:"rgba(255, 255, 255, 0.55)"}}),(0,O.Z)({edgeColor:"#00B2B2",alignColor:"#00B2B2",edgeLineWidth:1,alignLineWidth:1,alignCrossWidth:8}),ei({renderer:nB}),ej({}),eH({groupNodeRender:nm}),tP({}),tZ({mode:"browser"}),tu({initialData:rl.globalVariable}),(0,tz.eg)({factories:[oY,oq,oX],layerProps:{children:(0,C.jsx)(ov,{})}})]}),[]);return(0,C.jsx)("div",{className:"doc-free-feature-overview",children:(0,C.jsx)(b.EhS,{...e,children:(0,C.jsx)("div",{className:"demo-container",children:(0,C.jsx)(b.R6T,{className:"demo-editor"})})})})}},240835:function(e,t,o){o.d(t,{Id:()=>a,J_:()=>l});var n=o(110239),i=o(908600),r=o(906387);let s=(0,i.createContext)({rules:{},ops:r.s}),l=e=>{let{rules:t,ops:o}=e;return(0,n.jsx)(s.Provider,{value:{rules:t,ops:o},children:e.children})},a=()=>(0,i.useContext)(s)},548034:function(e,t,o){o.d(t,{k:()=>l});var n=o(908600),i=o(950454),r=o(164910),s=o(240835);function l(e){let{leftSchema:t,operator:o,onClearOp:l,onClearRight:a,ruleConfig:d}=e,c=(0,r.M)(),{rules:u,ops:p}=(0,s.Id)(),h=(0,n.useMemo)(()=>(null==d?void 0:d.rules)||u||{},[u,null==d?void 0:d.rules]),g=(0,n.useMemo)(()=>(null==d?void 0:d.ops)||p||{},[p,null==d?void 0:d.ops]),m=(0,n.useMemo)(()=>t?c.getTypeBySchema(t):void 0,[t,c]),y=(0,n.useMemo)(()=>{if(m)return h[m.type]?h[m.type]:"function"==typeof m.conditionRule?m.conditionRule(t):m.conditionRule},[h,t,m]),x=(0,n.useMemo)(()=>Object.keys(y||{}).filter(e=>g[e]).map(e=>{var t;return{...(null==g?void 0:g[e])||{},value:e,label:i.oci.t((null==g||null==(t=g[e])?void 0:t.label)||e)}}),[y,g]);(0,n.useEffect)(()=>{o&&y&&(x.find(e=>e.value===o)||null==l||l())},[o,x,l]);let f=(0,n.useMemo)(()=>{let e=(null==y?void 0:y[o||""])||null;if(e)return"string"==typeof e?{type:e,extra:{weak:!0}}:e},[y,o]),v=(0,n.useRef)(void 0);return(0,n.useEffect)(()=>{var e;if(!v.current){v.current=f;return}(null==(e=v.current)?void 0:e.type)!==(null==f?void 0:f.type)&&(null==a||a()),v.current=f},[f,a]),{rule:y,opConfig:(0,n.useMemo)(()=>g[o||""],[o,g]),opOptionList:x,targetSchema:f}}},318036:function(e,t,o){o.d(t,{i:()=>p});var n=o(110239),i=o(908600),r=o(937643),s=o(950454),l=o(653378),a=o(521419),d=o(857527),c=o(510165),u=o(548034);function p(e){var t;let{style:o,value:p,onChange:h,readonly:g,ruleConfig:m}=e,{left:y,operator:x,right:f}=p||{},v=(0,s.rVg)(),j=(0,i.useMemo)(()=>{if(y)return v.getByKeyPath(y.content)},[v,y]),C=(0,i.useMemo)(()=>{if(j)return r.Kz.astToSchema(j.type,{drilldown:!1})},[null==j||null==(t=j.type)?void 0:t.hash]),{rule:b,opConfig:N,opOptionList:w,targetSchema:M}=(0,u.k)({leftSchema:C,operator:x,ruleConfig:m,onClearOp(){h({...p,operator:void 0})},onClearRight(){h({...p,right:void 0})}});return(0,n.jsxs)("div",{className:"gedit-m-condition-row-container",style:o,children:[(0,n.jsx)("div",{className:"gedit-m-condition-row-operator",children:(0,n.jsx)(l.Select,{style:{height:22},disabled:g,size:"small",value:x,optionList:w,onChange:e=>{h({...p,operator:e})},triggerRender:e=>{let{value:t}=e;return(0,n.jsx)(l.Button,{size:"small",disabled:!b,children:(null==N?void 0:N.abbreviation)||(0,n.jsx)(a.Z,{size:"small"})})}})}),(0,n.jsxs)("div",{className:"gedit-m-condition-row-values",children:[(0,n.jsx)("div",{className:"gedit-m-condition-row-left",children:(0,n.jsx)(d.NB,{readonly:g,style:{width:"100%"},value:null==y?void 0:y.content,onChange:e=>h({...p,left:{type:"ref",content:e}})})}),(0,n.jsx)("div",{className:"gedit-m-condition-row-right",children:M?(0,n.jsx)(c.t,{readonly:g||!b,value:f,schema:M,onChange:e=>h({...p,right:e})}):(0,n.jsx)(l.Input,{size:"small",disabled:!0,style:{pointerEvents:"none"},value:(null==N?void 0:N.rightDisplay)||s.oci.t("Empty")})})]})]})}o(781634)},789220:function(e,t,o){o.d(t,{V:()=>r});var n=o(937643),i=o(950454);let r=e=>[{event:i.zEJ.onValueInitOrChange,effect:t=>{let{context:o,value:r}=t;if((null==r?void 0:r.type)!=="ref")return()=>null;let s=(0,i.k6H)(o.node).available.trackByKeyPath((null==r?void 0:r.content)||[],o=>{e({...t,schema:n.Kz.astToSchema(o)})},{selector:e=>null==e?void 0:e.type});return()=>{s.dispose()}}}]},183173:function(e,t,o){o.d(t,{S:()=>i});var n=o(950454);let i=function(){let{scope:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[{event:n.zEJ.onValueInit,effect:t=>{let{context:o,form:i,name:r}=t,s=("private"===e?(0,n.u$R)(o.node):(0,n.k6H)(o.node)).available.onListOrAnyVarChange(()=>{Object.entries(i.state.errors||{}).filter(e=>{let[t,o]=e;return(null==o?void 0:o.length)>0}).filter(e=>{let[t]=e;return t.startsWith(r)||r.startsWith(t)}).map(e=>{let[t]=e;return t}).length>0&&i.validate()});return()=>s.dispose()}}]}},769424:function(e,t,o){o.d(t,{n:()=>a});var n=o(689478),i=o(241787),r=o(383909),s=o(937643),l=o(950454);let a=(0,l.CR5)({onSetupFormMeta(e,t){let{addFormatOnSubmit:o,mergeEffect:a}=e,{assignKey:d,outputKey:c}=t;d&&c&&(a({[d]:(0,l.W2M)({parse:(e,t)=>{var o,r,a;let d=(a=e.filter(e=>"declare"===e.operator&&e.left&&e.right),a&&a.length?(0,i.Z)(a,(0,n.Z)("left",2)):[]);return[l.qRT.createVariableDeclaration({key:`${t.node.id}`,meta:{title:null==(o=t.node.form)?void 0:o.getValueIn("title"),icon:null==(r=t.node.getNodeRegistry().info)?void 0:r.icon},type:l.qRT.createObject({properties:d.map(e=>{var t,o,n,i;return l.qRT.createProperty({key:e.left,type:(null==(t=e.right)?void 0:t.type)==="constant"?s.Kz.schemaToAST((null==(o=e.right)?void 0:o.schema)||{}):void 0,initializer:(null==(n=e.right)?void 0:n.type)==="ref"?l.qRT.createKeyPathExpression({keyPath:(null==(i=e.right)?void 0:i.content)||[]}):{}})})})})]}})}),o((e,t)=>{var o,n;return(0,r.Z)(e,c,s.Kz.astToSchema(null==(n=(0,l.k6H)(t.node).output.variables)||null==(o=n[0])?void 0:o.type)),e}))}})},38643:function(e,t,o){o.d(t,{W:()=>s});var n=o(863875),i=o(950454),r=o(687252);function s(e,t){let{node:o,required:s,errorMessages:l}=t,{required:a="Field is required",unknownVariable:d="Unknown Variable"}=l||{};if(s&&((0,n.Z)(e)||(0,n.Z)(null==e?void 0:e.content)||(null==e?void 0:e.content)===""))return{level:i.Odm.Error,message:a};if((null==e?void 0:e.type)==="ref"&&!(0,i.k6H)(o).available.getByKeyPath((null==e?void 0:e.content)||[]))return{level:i.Odm.Error,message:d};if((null==e?void 0:e.type)==="template"){for(let t of r.U.getTemplateKeyPaths(e))if(!(0,i.k6H)(o).available.getByKeyPath(t))return{level:i.Odm.Error,message:d}}}}}]);