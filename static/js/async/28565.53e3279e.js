"use strict";(self.webpackChunk_flowgram_ai_docs=self.webpackChunk_flowgram_ai_docs||[]).push([["28565"],{607026:function(e,s,n){n.r(s),n.d(s,{default:()=>P});var r=n(110239),i=n(437562),l=n(420188),d=n(659722),o=n(423324),c=n(764897),a=n(938682),h=n(670703),t=n(818610),x=n(545917),j=n(983088),p=n(138359),k=n(761254),u=n(360771),y=n(310767),m=n(441909),g=n(917072),f=n(350491),v=n(363788),N=n(152097),w=n(805510),b=n(834698),S=n(992842),R=n(674626),E=n(699594),F=n(930570);function A(e){let s={a:"a",blockquote:"blockquote",code:"code",div:"div",h1:"h1",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",span:"span",ul:"ul",...(0,i.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.h1,{id:"自由布局",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#自由布局",children:"#"}),"自由布局"]}),"\n","\n",(0,r.jsxs)(s.h2,{id:"step0---安装依赖",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#step0---安装依赖",children:"#"}),"Step.0 - 安装依赖"]}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsx)(s.li,{children:"安装编辑器包"}),"\n"]}),"\n",(0,r.jsx)(l.SU,{command:{npm:"npm install @flowgram.ai/free-layout-editor",pnpm:"pnpm add @flowgram.ai/free-layout-editor",yarn:"yarn add @flowgram.ai/free-layout-editor",bun:"bun add @flowgram.ai/free-layout-editor"}}),"\n",(0,r.jsxs)(s.ol,{start:"2",children:["\n",(0,r.jsx)(s.li,{children:"安装 styled-components（若尚未安装）"}),"\n"]}),"\n",(0,r.jsx)(l.SU,{command:{npm:"npm install styled-components",pnpm:"pnpm add styled-components",yarn:"yarn add styled-components",bun:"bun add styled-components"}}),"\n",(0,r.jsxs)(s.h2,{id:"step1---引入画布组件",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#step1---引入画布组件",children:"#"}),"Step.1 - 引入画布组件"]}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"引入样式文件，确保基础样式生效："}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-highlighted",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",children:(0,r.jsx)(s.code,{className:"language-tsx",children:(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" '@flowgram.ai/free-layout-editor/index.css'"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:";"})]})})})}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:["使用 ",(0,r.jsx)(s.code,{children:"FreeLayoutEditorProvider"})," 提供编辑器上下文，",(0,r.jsx)(s.code,{children:"EditorRenderer"})," 负责渲染画布："]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-highlighted",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",children:(0,r.jsxs)(s.code,{className:"language-tsx",children:[(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" FlowGramApp"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" () "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" ("})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  <"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"FreeLayoutEditorProvider"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:">"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"    <"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"EditorRenderer"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" />"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  </"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"FreeLayoutEditorProvider"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:">"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:");"})})]})})}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"其余文件保持默认导出即可。"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsx)(s.p,{children:"预期效果：页面加载后仅展示一个空白画布，无任何节点或连线。"}),"\n"]}),"\n",(0,r.jsx)(d.G,{files:{"/App.tsx":o}}),"\n",(0,r.jsxs)(s.h2,{id:"step2---实现节点组件并注册",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#step2---实现节点组件并注册",children:"#"}),"Step.2 - 实现节点组件并注册"]}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"导入节点渲染相关 Hook 与组件："}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"useNodeRender"}),"：获取节点上下文（如表单）。"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"WorkflowNodeProps"})," & ",(0,r.jsx)(s.code,{children:"WorkflowNodeRenderer"}),"：定义并渲染节点外壳。"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:["创建 ",(0,r.jsx)(s.code,{children:"NodeRender"})," 组件，自定义节点尺寸与样式："]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-highlighted",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",children:(0,r.jsxs)(s.code,{className:"language-tsx",children:[(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" NodeRender"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" (props"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" WorkflowNodeProps"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:") "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"  const"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" { "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"form"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" } "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" useNodeRender"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"();"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"  return"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" ("})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"    <"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"WorkflowNodeRenderer"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"      style"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"{{ width"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" 280"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" height"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" 88"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" background"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" '#fff'"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" borderRadius"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" 8"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" ..."}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" }}"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"      node"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"{"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"props"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:".node}"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"    >"})}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"      {"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"form"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"?.render"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"()}"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"    </"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"WorkflowNodeRenderer"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:">"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  );"})}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"};"})})]})})}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:["在 ",(0,r.jsx)(s.code,{children:"FreeLayoutEditorProvider"})," 中注册："]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"materials.renderDefaultNode"})," 指定默认节点渲染器。"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"nodeRegistries"})," 声明可用节点类型（示例为 ",(0,r.jsx)(s.code,{children:"custom"}),"）。"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"initialData"})," 提供一个初始节点，位置 ",(0,r.jsx)(s.code,{children:"{ x: 250, y: 100 }"}),"。"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsx)(s.p,{children:"预期效果：画布中出现一个可拖拽的自定义样式节点。"}),"\n"]}),"\n",(0,r.jsx)(d.G,{files:{"/App.tsx":c}}),"\n",(0,r.jsxs)(s.h2,{id:"step3---添加多节点与连线",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#step3---添加多节点与连线",children:"#"}),"Step.3 - 添加多节点与连线"]}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:["新增 ",(0,r.jsx)(s.code,{children:"onAllLayersRendered"})," 回调，在所有图层渲染完成后调用 ",(0,r.jsx)(s.code,{children:"ctx.tools.fitView(false)"}),"，让画布自动适配内容。"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:["新增 ",(0,r.jsx)(s.code,{children:"canDeleteNode"})," & ",(0,r.jsx)(s.code,{children:"canDeleteLine"})," 回调，返回 ",(0,r.jsx)(s.code,{children:"true"})," 允许删除节点与连线。"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:["扩展 ",(0,r.jsx)(s.code,{children:"initialData"}),"："]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["再增加一个同类型节点，位置 ",(0,r.jsx)(s.code,{children:"{ x: 400, y: 0 }"}),"。"]}),"\n",(0,r.jsxs)(s.li,{children:["在 ",(0,r.jsx)(s.code,{children:"edges"})," 数组中添加一条连线，连接节点 ",(0,r.jsx)(s.code,{children:"1"})," 与节点 ",(0,r.jsx)(s.code,{children:"2"}),"。"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsx)(s.p,{children:"预期效果："}),"\n",(0,r.jsx)(s.p,{children:"• 画布展示两个相连节点，并自动居中/缩放到合适视图。"}),"\n",(0,r.jsx)(s.p,{children:"• 选中任意节点或连线，键盘删除键可删除选中元素。"}),"\n"]}),"\n",(0,r.jsx)(d.G,{files:{"/App.tsx":a}}),"\n",(0,r.jsxs)(s.h2,{id:"step4---引入插件",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#step4---引入插件",children:"#"}),"Step.4 - 引入插件"]}),"\n",(0,r.jsxs)(s.div,{className:"rspress-directive info",children:[(0,r.jsx)(s.div,{className:"rspress-directive-title",children:"INFO"}),(0,r.jsx)(s.div,{className:"rspress-directive-content",children:(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"@flowgram.ai/free-snap-plugin"}),"：节点对齐插件，使节点在网格上对齐。"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"@flowgram.ai/minimap-plugin"}),"：迷你地图插件，提供画布的小地图视图。"]}),"\n"]})})]}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsx)(s.li,{children:"安装插件依赖"}),"\n"]}),"\n",(0,r.jsx)(l.SU,{command:{npm:"npm install @flowgram.ai/free-snap-plugin @flowgram.ai/minimap-plugin",pnpm:"pnpm add @flowgram.ai/free-snap-plugin @flowgram.ai/minimap-plugin",yarn:"yarn add @flowgram.ai/free-snap-plugin @flowgram.ai/minimap-plugin",bun:"bun add @flowgram.ai/free-snap-plugin @flowgram.ai/minimap-plugin"}}),"\n",(0,r.jsxs)(s.ol,{start:"2",children:["\n",(0,r.jsx)(s.li,{children:"从对应包导入插件创建函数："}),"\n"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"createFreeSnapPlugin"})," 用于节点网格对齐。"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"createMinimapPlugin"})," 用于生成画布缩略图。"]}),"\n"]}),"\n",(0,r.jsxs)(s.ol,{start:"3",children:["\n",(0,r.jsxs)(s.li,{children:["在 ",(0,r.jsx)(s.code,{children:"FreeLayoutEditorProvider"})," 的 ",(0,r.jsx)(s.code,{children:"plugins"})," 属性中注册插件："]}),"\n"]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-highlighted",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",children:(0,r.jsxs)(s.code,{className:"language-tsx",children:[(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"plugins"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"{() => ["})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"  createMinimapPlugin"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"({})"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"  createFreeSnapPlugin"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"({})"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"]}"})})]})})}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsx)(s.p,{children:"预期效果:"}),"\n",(0,r.jsx)(s.p,{children:"• 画布右上角出现可拖拽/缩放的迷你地图，点击或拖拽缩略图可快速定位主画布。"}),"\n",(0,r.jsx)(s.p,{children:"• 拖拽节点时，节点会自动吸附到附近节点，便于快速对齐。"}),"\n"]}),"\n",(0,r.jsx)(d.G,{files:{"/App.tsx":h}}),"\n",(0,r.jsxs)(s.h2,{id:"step5---拆分文件",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#step5---拆分文件",children:"#"}),"Step.5 - 拆分文件"]}),"\n",(0,r.jsx)(s.p,{children:"为避免单个文件代码行数过长，我们需要将原本集中在一个组件中的编辑器配置、节点渲染、初始化数据等拆分为独立文件，便于维护、复用与协作。"}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-highlighted",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",children:(0,r.jsxs)(s.code,{className:"language-sh",children:[(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"-"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" use-editor-props.ts"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" # 画布配置"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"-"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" node-render.tsx"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" # 节点渲染"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"-"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" initial-data.ts"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" # 初始化数据"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"-"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" node-registries.ts"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" # 节点配置"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"-"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" App.tsx"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" # 画布入口"})]})]})})}),"\n",(0,r.jsx)(s.p,{children:"文件职责说明"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"use-editor-props.tsx"}),"：集中管理 FreeLayoutEditorProvider 的所有 props（插件、视图适配、材料、节点注册与初始数据）。"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"node-render.tsx"}),"：定义自定义节点渲染器 NodeRender，负责外观与内部表单渲染。"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"initial-data.ts"}),"：提供初始节点与连线。当前示例包含 5 个 custom 节点及多条连接关系。"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"node-registries.tsx"}),"：声明节点类型集合（示例为仅注册 'custom'）。"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"App.tsx"}),"：应用入口，从 useEditorProps 获取配置并挂载 EditorRenderer。"]}),"\n"]}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsx)(s.p,{children:"预期效果: 通过拆分文件，代码结构更清晰、职责更明确，后续代码更易扩展"}),"\n"]}),"\n",(0,r.jsx)(d.G,{files:{"/App.tsx":t,"/use-editor-props.tsx":j,"/initial-data.ts":x,"/node-registries.tsx":k,"/node-render.tsx":p}}),"\n",(0,r.jsxs)(s.h2,{id:"step6---接入表单与历史记录",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#step6---接入表单与历史记录",children:"#"}),"Step.6 - 接入表单与历史记录"]}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsx)(s.li,{children:"节点注册与端口配置"}),"\n"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"start"}),"：起始节点，不可删除，默认只有输出端口。"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"end"}),"：结束节点，不可删除，默认只有输入端口。"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"custom"}),"：普通节点，默认同时拥有输入与输出端口。"]}),"\n"]}),"\n",(0,r.jsxs)(s.ol,{start:"2",children:["\n",(0,r.jsx)(s.li,{children:"启用表单与历史记录"}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["在 ",(0,r.jsx)(s.code,{children:"useEditorProps.tsx"})," 中："]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"nodeEngine.enable = true"}),"：开启节点引擎，允许为节点类型配置 ",(0,r.jsx)(s.code,{children:"formMeta"}),"。"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"history.enable = true"})," 与 ",(0,r.jsx)(s.code,{children:"history.enableChangeNode = true"}),"：启用撤销/重做，并监听节点数据变化（例如表单变更）。"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"getNodeDefaultRegistry(type)"}),"：为未显式注册的类型提供默认配置：","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"meta.defaultExpanded = true"}),"：默认展开节点的内部内容区域。"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"formMeta.render"}),"：渲染表单。本示例通过 ",(0,r.jsx)(s.code,{children:'<Field<string> name="title">'})," 渲染标题字段。"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.ol,{start:"3",children:["\n",(0,r.jsx)(s.li,{children:"初始化数据与渲染"}),"\n"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["在 ",(0,r.jsx)(s.code,{children:"initial-data.ts"})," 中，为每个节点设置 ",(0,r.jsx)(s.code,{children:"data.title"}),"（如 ",(0,r.jsx)(s.code,{children:"Start Node"}),"、",(0,r.jsx)(s.code,{children:"Custom Node A/B/C"}),"、",(0,r.jsx)(s.code,{children:"End Node"}),"）。"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"NodeRender"})," 中的 ",(0,r.jsx)(s.code,{children:"form?.render()"})," 会将表单内容渲染进节点外壳，展示各节点的标题。"]}),"\n"]}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsx)(s.p,{children:"预期效果:"}),"\n",(0,r.jsxs)(s.p,{children:["• 画布包含 ",(0,r.jsx)(s.code,{children:"start"}),"、多个 ",(0,r.jsx)(s.code,{children:"custom"})," 与 ",(0,r.jsx)(s.code,{children:"end"})," 节点，连接关系与初始数据一致。"]}),"\n",(0,r.jsxs)(s.p,{children:["• 每个节点显示其 ",(0,r.jsx)(s.code,{children:"title"}),"；选中节点时可扩展为展示更多表单字段与交互。"]}),"\n",(0,r.jsx)(s.p,{children:"• 撤销/重做快捷键可用，可通过删除、移动节点操作进行验证。"}),"\n"]}),"\n",(0,r.jsx)(d.G,{activeFile:"/use-editor-props.tsx",files:{"/App.tsx":u,"/use-editor-props.tsx":m,"/initial-data.ts":y,"/node-registries.tsx":f,"/node-render.tsx":g}}),"\n",(0,r.jsxs)(s.h2,{id:"step7---创建工具栏",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#step7---创建工具栏",children:"#"}),"Step.7 - 创建工具栏"]}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsx)(s.li,{children:"引入工具栏组件"}),"\n"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["在 ",(0,r.jsx)(s.code,{children:"App.tsx"})," 中引入 ",(0,r.jsx)(s.code,{children:"<Tools />"}),"，与 ",(0,r.jsx)(s.code,{children:"<EditorRenderer />"})," 同级放置于 ",(0,r.jsx)(s.code,{children:"FreeLayoutEditorProvider"})," 内，使其能够访问编辑器上下文与工具方法。"]}),"\n"]}),"\n",(0,r.jsxs)(s.ol,{start:"2",children:["\n",(0,r.jsx)(s.li,{children:"通过工具方法操控画布"}),"\n"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["使用 ",(0,r.jsx)(s.code,{children:"usePlaygroundTools()"})," 获取画布操作方法：",(0,r.jsx)(s.code,{children:"zoomin/zoomout"}),"、",(0,r.jsx)(s.code,{children:"fitView"}),"、",(0,r.jsx)(s.code,{children:"autoLayout"}),"、",(0,r.jsx)(s.code,{children:"switchLineType"})," 等。"]}),"\n",(0,r.jsxs)(s.li,{children:["切换连线样式：通过 ",(0,r.jsx)(s.code,{children:"switchLineType"})," 在 ",(0,r.jsx)(s.code,{children:"LineType.BEZIER"}),"（贝塞尔）与 ",(0,r.jsx)(s.code,{children:"LineType.LINE_CHART"}),"（折线）之间切换。"]}),"\n",(0,r.jsxs)(s.li,{children:["实时显示缩放比例：读取 ",(0,r.jsx)(s.code,{children:"tools.zoom"}),"，展示当前画布缩放百分比。"]}),"\n"]}),"\n",(0,r.jsxs)(s.ol,{start:"3",children:["\n",(0,r.jsx)(s.li,{children:"接入撤销/重做状态"}),"\n"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["使用 ",(0,r.jsx)(s.code,{children:"useClientContext()"})," 获取 ",(0,r.jsx)(s.code,{children:"history"}),"，并监听 ",(0,r.jsx)(s.code,{children:"history.undoRedoService.onChange"})," 更新 ",(0,r.jsx)(s.code,{children:"canUndo/canRedo"})," 按钮状态。"]}),"\n",(0,r.jsxs)(s.li,{children:["在 ",(0,r.jsx)(s.code,{children:"use-editor-props.tsx"})," 中确保开启历史：",(0,r.jsx)(s.code,{children:"history.enable = true"})," 与 ",(0,r.jsx)(s.code,{children:"history.enableChangeNode = true"}),"，使撤销/重做对节点数据变化生效。"]}),"\n"]}),"\n",(0,r.jsxs)(s.ol,{start:"5",children:["\n",(0,r.jsx)(s.li,{children:"扩展组件（可选）"}),"\n"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Minimap：通过自定义 ",(0,r.jsx)(s.code,{children:"MinimapRender"})," 容器样式将缩略图固定在右下角，提升定位效率。"]}),"\n",(0,r.jsxs)(s.li,{children:["AddNode：提供快速新增节点按钮，通过 ",(0,r.jsx)(s.code,{children:"WorkflowDocument.createWorkflowNodeByType"})," 在画布中心创建并选中节点。"]}),"\n"]}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsx)(s.p,{children:"预期效果:"}),"\n",(0,r.jsx)(s.p,{children:"• 页面右下角出现工具栏，支持 ZoomIn/ZoomOut、FitView、AutoLayout 等常用操作，实时显示缩放比例。"}),"\n",(0,r.jsx)(s.p,{children:"• 可切换连线样式（贝塞尔/折线），撤销/重做按钮会随历史状态自动启用/禁用。"}),"\n",(0,r.jsx)(s.p,{children:"• 搭配 Minimap 与 AddNode 组件，形成完整的编辑工具区，操作更高效。"}),"\n"]}),"\n",(0,r.jsx)(d.G,{activeFile:"/tools.tsx",files:{"/App.tsx":v,"/use-editor-props.tsx":w,"/initial-data.ts":N,"/node-registries.tsx":S,"/tools.tsx":R,"/add-node.tsx":E,"/minimap.tsx":F,"/node-render.tsx":b}}),"\n",(0,r.jsxs)(s.h2,{id:"step8---了解更多",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#step8---了解更多",children:"#"}),"Step.8 - 了解更多"]}),"\n",(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"2rem",marginTop:"1rem"},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(s.p,{children:"了解更多自由布局用法："}),(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"/guide/free-layout/load.html",children:"加载与保存"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"/guide/free-layout/node.html",children:"节点"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"/guide/free-layout/line.html",children:"线条"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"/guide/free-layout/port.html",children:"端口"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"/guide/free-layout/sub-canvas.html",children:"子画布"})}),"\n"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(s.p,{children:"了解 FlowGram.AI 更多功能："}),(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"/guide/form/form.html",children:"表单"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"/guide/variable/basic.html",children:"变量"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"/materials/introduction.html",children:"物料"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"/guide/runtime/introduction.html",children:"运行时"})}),"\n"]})]})]})]})}function P(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}={...(0,i.a)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(A,{...e})}):A(e)}P.__RSPRESS_PAGE_META={},P.__RSPRESS_PAGE_META["zh%2Fguide%2Fgetting-started%2Ffree-layout.mdx"]={toc:[{id:"step0---安装依赖",text:"Step.0 - 安装依赖",depth:2},{id:"step1---引入画布组件",text:"Step.1 - 引入画布组件",depth:2},{id:"step2---实现节点组件并注册",text:"Step.2 - 实现节点组件并注册",depth:2},{id:"step3---添加多节点与连线",text:"Step.3 - 添加多节点与连线",depth:2},{id:"step4---引入插件",text:"Step.4 - 引入插件",depth:2},{id:"step5---拆分文件",text:"Step.5 - 拆分文件",depth:2},{id:"step6---接入表单与历史记录",text:"Step.6 - 接入表单与历史记录",depth:2},{id:"step7---创建工具栏",text:"Step.7 - 创建工具栏",depth:2},{id:"step8---了解更多",text:"Step.8 - 了解更多",depth:2}],title:"自由布局",headingTitle:"自由布局",frontmatter:{}}}}]);