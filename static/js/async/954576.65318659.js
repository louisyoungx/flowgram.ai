"use strict";(self.webpackChunk_flowgram_ai_docs=self.webpackChunk_flowgram_ai_docs||[]).push([["954576"],{238681:function(e,s,n){n.r(s),n.d(s,{default:()=>c});var r=n(110239),i=n(437562),l=n(441332),o=n(365689),a=n(544372);function t(e){let s={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",span:"span",strong:"strong",ul:"ul",...(0,i.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.h1,{id:"autorenameref",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#autorenameref",children:"#"}),"autoRenameRef"]}),"\n",(0,r.jsx)(s.p,{children:"autoRenameRef 是一个自动重命名引用效果，当表单字段的键名发生变化时，自动更新所有引用该字段的引用值和模板值。"}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsxs)("div",{children:[(0,r.jsx)("img",{loading:"lazy",src:"/materials/auto-rename-ref.gif",alt:"autoRenameRef 效果",style:{width:"80%"}}),(0,r.jsx)(s.p,{children:(0,r.jsx)(s.em,{children:"query 变量名变化时，自动重命名下游 inputs 中的引用"})})]}),"\n",(0,r.jsxs)(s.h2,{id:"案例演示",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#案例演示",children:"#"}),"案例演示"]}),"\n",(0,r.jsxs)(s.h3,{id:"基本使用",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#基本使用",children:"#"}),"基本使用"]}),"\n",(0,r.jsx)(a.w,{}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-highlighted",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",title:"form-meta.tsx",children:(0,r.jsxs)(s.code,{className:"language-tsx",children:[(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" { autoRenameRefEffect } "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" '@flowgram.ai/form-materials'"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,r.jsx)(s.span,{className:"line"}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" formMeta"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  effects"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'    "inputsValues"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" autoRenameRefEffect"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  }"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"  render"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" () "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" ("})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"    <>"})}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"      <"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"FormHeader"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" />"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"      <"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Field"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"<"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"any"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"> "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"name"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"inputsValues"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:">"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"        {({ field }) "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" ("})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"          <"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"InputsValues"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" value"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"{"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"field"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:".value} "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"onChange"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"{(value) "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" field"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".onChange"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"(value)} />"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"        )}"})}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"      </"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Field"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:">"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"    </>"})}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  )"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"}"})})]})})}),"\n",(0,r.jsxs)(s.h3,{id:"在复杂表单中使用",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#在复杂表单中使用",children:"#"}),"在复杂表单中使用"]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-highlighted",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",title:"form-meta.tsx",children:(0,r.jsxs)(s.code,{className:"language-tsx",children:[(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" { autoRenameRefEffect } "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" '@flowgram.ai/form-materials'"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,r.jsx)(s.span,{className:"line"}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" formMeta"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  effects"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"    // 为多个字段应用自动重命名效果"})}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'    "inputsValues"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" autoRenameRefEffect"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'    "outputsValues"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" autoRenameRefEffect"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'    "config.data"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" autoRenameRefEffect"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  }"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"  render"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" () "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" ("})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"    <>"})}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"      <"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"FormHeader"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" />"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"      <"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Field"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"<"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"any"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"> "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"name"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"inputsValues"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"> {"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"/* inputsValues 实现 */"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"} </"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Field"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:">"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"      <"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Field"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"<"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"any"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"> "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"name"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"outputsValues"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"> {"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"/* outputsValues 实现 */"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"} </"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Field"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:">"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"      <"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Field"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"<"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"any"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"> "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"name"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"config.data"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"> {"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"/* config.data 实现 */"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"} </"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Field"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:">"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"    </>"})}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  )"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"}"})})]})})}),"\n",(0,r.jsxs)(s.h2,{id:"api-介绍",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#api-介绍",children:"#"}),"API 介绍"]}),"\n",(0,r.jsxs)(s.h3,{id:"支持的值类型",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#支持的值类型",children:"#"}),"支持的值类型"]}),"\n",(0,r.jsx)(s.p,{children:"当指定 key 下对应的数据满足以下条件时，autoRenameEffect 的自动重命名才会被触发："}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"引用值 (ref)"}),"：",(0,r.jsx)(s.code,{children:"{ type: 'ref', content: ['field', 'path'] }"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"模板值 (template)"}),"：",(0,r.jsx)(s.code,{children:"{ type: 'template', content: 'Hello {{user.name}}' }"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"包含引用值和模板值的复杂结构"}),"：","\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-highlighted",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",children:(0,r.jsxs)(s.code,{className:"language-json",children:[(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"{"})}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:'  "a"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:'    "type"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "ref"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:'    "content"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" ["}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"start_0"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "str"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"]"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  }"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:'  "b"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:'    "c"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:'      "type"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "template"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:'      "content"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "Hello {{a}}"'})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"    }"})}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  }"})}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"}"})})]})})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.h2,{id:"源码导读",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#源码导读",children:"#"}),"源码导读"]}),"\n",(0,r.jsx)(o.ZB,{href:"https://github.com/bytedance/flowgram.ai/tree/main/packages/materials/form-materials/src/effects/auto-rename-ref"}),"\n",(0,r.jsx)(s.p,{children:"使用 CLI 命令可以复制源代码到本地："}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-highlighted",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",children:(0,r.jsx)(s.code,{className:"language-bash",children:(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"npx"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" @flowgram.ai/cli@latest"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" materials"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" effects/auto-rename-ref"})]})})})}),"\n",(0,r.jsxs)(s.h3,{id:"核心流程",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#核心流程",children:"#"}),"核心流程"]}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"监听重命名事件"}),"：通过 ",(0,r.jsx)(s.code,{children:"VariableFieldKeyRenameService"})," 监听字段键名变更"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"遍历引用值"}),"：查找所有引用值和模板值"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"匹配键路径"}),"：检查引用路径是否与变更前的路径匹配"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"更新引用"}),"：将匹配的引用路径更新为新的键路径"]}),"\n"]}),"\n",(0,r.jsx)(l.Z,{code:"graph TD\n    A[监听重命名事件] --\x3e B[renameService.onRename触发]\n    B --\x3e C[遍历所有值 traverseRef]\n\n    C --\x3e D{值类型判断}\n\n    D --\x3e|ref类型| E[检查路径匹配\n    isKeyPathMatch]\n\n    D --\x3e|template类型| F[检查模板路径匹配\n    遍历+isKeyPathMatch]\n\n    E --\x3e|匹配| G[更新引用路径\n    value.content = newPath]\n\n    E --\x3e|不匹配| I\n\n    F --\x3e|匹配| H[替换模板内容\n    value.content.replace]\n\n    F --\x3e|不匹配| I\n\n    G --\x3e I[更新表单值\n    form.setValueIn]\n\n    H --\x3e I\n\n    I --\x3e J{还有值需要处理?}\n    J --\x3e|是| C\n    J --\x3e|否| K[完成]\n\n    style A fill:#e1f5fe\n    style K fill:#e8f5e8\n    style B fill:#fff3e0\n    style G fill:#ffebee\n    style H fill:#ffebee",config:{}}),"\n",(0,r.jsxs)(s.h3,{id:"使用到的核心-api",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#使用到的核心-api",children:"#"}),"使用到的核心 API"]}),"\n",(0,r.jsxs)(s.h4,{id:"flowgramaivariable-core",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#flowgramaivariable-core",children:"#"}),"@flowgram.ai/variable-core"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"VariableFieldKeyRenameService"}),": 字段键名重命名监听"]}),"\n"]}),"\n",(0,r.jsxs)(s.h4,{id:"flowgramainode",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#flowgramainode",children:"#"}),"@flowgram.ai/node"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"DataEvent.onValueInit"}),": 值初始化事件"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"Effect"}),": 效果类型定义"]}),"\n"]}),"\n",(0,r.jsxs)(s.h4,{id:"flowvalueutils",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#flowvalueutils",children:"#"}),"FlowValueUtils"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"FlowValueUtils.getTemplateKeyPaths()"}),": 提取模板中的所有键路径"]}),"\n"]})]})}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}={...(0,i.a)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(t,{...e})}):t(e)}c.__RSPRESS_PAGE_META={},c.__RSPRESS_PAGE_META["zh%2Fmaterials%2Feffects%2Fauto-rename-ref.mdx"]={toc:[{id:"案例演示",text:"案例演示",depth:2},{id:"基本使用",text:"基本使用",depth:3},{id:"在复杂表单中使用",text:"在复杂表单中使用",depth:3},{id:"api-介绍",text:"API 介绍",depth:2},{id:"支持的值类型",text:"支持的值类型",depth:3},{id:"源码导读",text:"源码导读",depth:2},{id:"核心流程",text:"核心流程",depth:3},{id:"使用到的核心-api",text:"使用到的核心 API",depth:3},{id:"flowgramaivariable-core",text:"@flowgram.ai/variable-core",depth:4},{id:"flowgramainode",text:"@flowgram.ai/node",depth:4},{id:"flowvalueutils",text:"FlowValueUtils",depth:4}],title:"autoRenameRef",headingTitle:"autoRenameRef",frontmatter:{}}},544372:function(e,s,n){n.d(s,{w:()=>c});var r=n(110239),i=n(908600),l=n(623631),o=n(916530),a=n(132288);let t=i.lazy(()=>Promise.all([n.e("386212"),n.e("133914"),n.e("227692"),n.e("135674"),n.e("942362"),n.e("254129"),n.e("260790"),n.e("46854"),n.e("795751"),n.e("84257")]).then(n.bind(n,929024)).then(e=>({default:e.InputsValues}))),c=()=>(0,r.jsx)(a.y,{filterEndNode:!0,formMeta:{effect:{inputsValues:l.g},render:()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.p,{}),(0,r.jsx)(o.gNt,{name:"inputsValues",defaultValue:{a:{type:"ref",content:["start_0","str"]}},children:e=>{let{field:s}=e;return(0,r.jsx)(t,{value:s.value,onChange:e=>s.onChange(e)})}})]})}})},132288:function(e,s,n){n.d(s,{p:()=>o,y:()=>a});var r=n(110239),i=n(908600);let l=i.lazy(()=>Promise.all([n.e("386212"),n.e("133914"),n.e("227692"),n.e("135674"),n.e("254129"),n.e("428647"),n.e("260790"),n.e("46854"),n.e("787220")]).then(n.bind(n,654296)).then(e=>({default:e.FreeFormMetaStoryBuilder}))),o=i.lazy(()=>Promise.all([n.e("386212"),n.e("133914"),n.e("227692"),n.e("135674"),n.e("254129"),n.e("428647"),n.e("260790"),n.e("46854"),n.e("787220")]).then(n.bind(n,654296)).then(e=>({default:e.FormHeader}))),a=e=>(0,r.jsx)("div",{style:{position:"relative",height:e.height||400},children:(0,r.jsx)(l,{...e})})},623631:function(e,s,n){n.d(s,{g:()=>l});var r=n(950454),i=n(687252);let l=[{event:r.zEJ.onValueInit,effect:e=>{let{context:s,form:n,name:l}=e,a=s.node.getService(r.qmw).onRename(e=>{let{before:s,after:r}=e,a=[...s.parentFields.map(e=>e.key).reverse(),s.key],t=[...r.parentFields.map(e=>e.key).reverse(),r.key];var c=l,h=n.getValueIn(l),d=(e,s)=>{if("ref"===s.type){if(o(s.content,a)){var r;s.content=[...t,...null==(r=s.content||[])?void 0:r.slice(a.length)],n.setValueIn(e,s)}}else if("template"===s.type){let r=i.U.getTemplateKeyPaths(s),l=!1;r.forEach(e=>{if(o(e,a)){var n,r;l=!0;let i=[...t,...null==(n=e||[])?void 0:n.slice(a.length)];s.content=null==(r=s.content)?void 0:r.replace(`{{${e.join(".")}}`,`{{${i.join(".")}}`)}}),l&&n.setValueIn(e,{...s})}};for(let{value:e,path:s}of i.U.traverse(h,{includeTypes:["ref","template"],path:c}))d(s,e)});return()=>{a.dispose()}}}];function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],s=arguments.length>1?arguments[1]:void 0;return s.every((s,n)=>s===e[n])}},687252:function(e,s,n){n.d(s,{U:()=>r});var r,i=n(111886),l=n(13721),o=n(721855),a=n(325486),t=n(937643),c=n(123387);let h=c.ZP.object({index:c.ZP.number().optional()}).optional(),d=c.ZP.object({type:c.ZP.literal("constant"),content:c.ZP.any().optional(),schema:c.ZP.any().optional(),extra:h}),p=c.ZP.object({type:c.ZP.literal("ref"),content:c.ZP.array(c.ZP.string()).optional(),extra:h}),x=c.ZP.object({type:c.ZP.literal("expression"),content:c.ZP.string().optional(),extra:h}),k=c.ZP.object({type:c.ZP.literal("template"),content:c.ZP.string().optional(),extra:h});!function(e){function s(e){return d.safeParse(e).success}function n(e){return p.safeParse(e).success}function r(e){return x.safeParse(e).success}function c(e){return k.safeParse(e).success}function h(e){return(null==e?void 0:e.schema)?e.schema:"string"==typeof e.content?{type:"string"}:"number"==typeof e.content?{type:"number"}:"boolean"==typeof e.content?{type:"boolean"}:(0,a.Z)(e.content)?{type:"object"}:void 0}e.isConstant=s,e.isRef=n,e.isExpression=r,e.isTemplate=c,e.isConstantOrRef=function(e){return s(e)||n(e)},e.isFlowValue=function(e){return s(e)||n(e)||r(e)||c(e)},e.traverse=function* e(o,a){let{includeTypes:t=["ref","template","expression","constant"],path:h="",pathArr:d=[]}=a||{};if((0,i.Z)(o)){if(n(o)&&t.includes("ref")||c(o)&&t.includes("template")||r(o)&&t.includes("expression")||s(o)&&t.includes("constant"))return void(yield{value:o,path:h,pathArr:d});for(let[s,n]of Object.entries(o))yield*e(n,{...a,path:h?`${h}.${s}`:s,pathArr:[...d,s]});return}if((0,l.Z)(o))for(let[s,n]of o.entries())yield*e(n,{...a,path:h?`${h}[${s}]`:`[${s}]`,pathArr:[...d,`[${s}]`]})},e.getTemplateKeyPaths=function(e){var s;return(0,o.Z)((null==(s=e.content)?void 0:s.match(/\{\{([^\}\{]+)\}\}/g))||[]).map(e=>e.slice(2,-2).split("."))},e.inferConstantJsonSchema=h,e.inferJsonSchema=function e(r,l){if((0,i.Z)(r)){if(s(r))return h(r);if(n(r)){let e=l.available.getByKeyPath(null==r?void 0:r.content);return(null==e?void 0:e.type)?t.Kz.astToSchema(null==e?void 0:e.type):void 0}return c(r)?{type:"string"}:{type:"object",properties:Object.keys(r).reduce((s,n)=>{let i=e(r[n],l);return i&&(s[n]=i),s},{})}}}}(r||(r={}))}}]);