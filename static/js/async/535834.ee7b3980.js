"use strict";(self.webpackChunk_flowgram_ai_docs=self.webpackChunk_flowgram_ai_docs||[]).push([["535834"],{113710:function(e,s,n){n.r(s),n.d(s,{default:()=>c});var r=n(110239),i=n(437562),l=n(368449),o=n(944529);function a(e){let s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",span:"span",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.h1,{id:"listenrefschemachange",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#listenrefschemachange",children:"#"}),"listenRefSchemaChange"]}),"\n",(0,r.jsx)(s.p,{children:"监听引用变量类型的 json schema 变化，并在变化时触发回调函数。"}),"\n",(0,r.jsxs)(s.h2,{id:"案例演示",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#案例演示",children:"#"}),"案例演示"]}),"\n","\n",(0,r.jsxs)(s.h3,{id:"基本使用",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#基本使用",children:"#"}),"基本使用"]}),"\n",(0,r.jsx)(l.w,{}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-highlighted",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",title:"form-meta.tsx",children:(0,r.jsxs)(s.code,{className:"language-tsx",children:[(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" { listenRefSchemaChange } "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" '@flowgram.ai/form-materials'"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,r.jsx)(s.span,{className:"line"}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" formMeta"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  effect"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"    'inputsValues.*'"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" listenRefSchemaChange"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"(({ name"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" schema"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" form"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" formValues }) "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"      form"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".setValueIn"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"        `log`"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"        `"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"${"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"form"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".getValueIn"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"`log`"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:") "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"||"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" ''"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"}"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"* "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"${"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"name"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"}"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:": "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"${"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"JSON"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".stringify"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"(schema)"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"}"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" \\n`"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"      );"})}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"    })"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  }"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"  render"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" () "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" ("})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"    <>"})}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"      <"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"FormHeader"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" />"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"      <"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Field"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"<"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"Record"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"<"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"string"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" any"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"> "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" undefined"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:">"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"        name"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"inputsValues"'})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"        defaultValue"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"{{"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"          a"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"            type"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'ref'"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"            content"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" ["}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'start_0'"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'str'"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"]"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"          }"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"        }}"})}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"      >"})}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"        {({ field }) "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" ("})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"          <"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"InputsValues"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" value"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"{"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"field"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:".value} "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"onChange"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"{(value) "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" field"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".onChange"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"(value)} />"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"        )}"})}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"      </"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Field"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:">"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"      <"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"br"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" />"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"      <"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Field"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"<"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"any"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"> "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"name"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"log"'}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" defaultValue"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"{"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'When schema updated, log changes:\\n'"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"}>"})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"        {({ field }) "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" ("})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"          <"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"pre"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" style"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"{{ padding"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" 4"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" background"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" '#f5f5f5'"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" fontSize"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" 12"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" }}>{"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"field"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:".value}</"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"pre"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:">"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"        )}"})}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"      </"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"Field"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:">"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"    </>"})}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  )"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"}"})})]})})}),"\n",(0,r.jsxs)(s.h2,{id:"api-介绍",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#api-介绍",children:"#"}),"API 介绍"]}),"\n",(0,r.jsxs)(s.h3,{id:"listenrefschemachange-1",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#listenrefschemachange-1",children:"#"}),"listenRefSchemaChange"]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-highlighted",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",children:(0,r.jsxs)(s.code,{className:"language-typescript",children:[(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"listenRefSchemaChange"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("})]}),"\n",(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  cb: (props"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" EffectFuncProps"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"<"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"IFlowRefValue"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"> "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"&"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" { schema"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" IJsonSchema"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" }) "}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" void"})]}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"): EffectOptions[]"})})]})})}),"\n",(0,r.jsxs)(s.h4,{id:"参数",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#参数",children:"#"}),"参数"]}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"参数"}),(0,r.jsx)(s.th,{children:"类型"}),(0,r.jsx)(s.th,{children:"描述"})]})}),(0,r.jsx)(s.tbody,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"cb"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"(props: EffectFuncProps<IFlowRefValue> & { schema?: IJsonSchema }) => void"})}),(0,r.jsx)(s.td,{children:"回调函数，当引用的 schema 发生变化时触发"})]})})]}),"\n",(0,r.jsxs)(s.h4,{id:"回调函数参数",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#回调函数参数",children:"#"}),"回调函数参数"]}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"参数"}),(0,r.jsx)(s.th,{children:"类型"}),(0,r.jsx)(s.th,{children:"描述"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"name"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"string"})}),(0,r.jsx)(s.td,{children:"字段名称"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"value"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"IFlowRefValue"})}),(0,r.jsx)(s.td,{children:"引用值对象"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"form"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"IForm"})}),(0,r.jsx)(s.td,{children:"表单实例"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"schema"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"IJsonSchema"})}),(0,r.jsx)(s.td,{children:"转换后的 JSON Schema"})]})]})]}),"\n",(0,r.jsxs)(s.h3,{id:"支持值类型",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#支持值类型",children:"#"}),"支持值类型"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"IFlowRefValue"}),"：引用类型值，包含 ",(0,r.jsx)(s.code,{children:"type: 'ref'"})," 和 ",(0,r.jsx)(s.code,{children:"content: string[]"})]}),"\n"]}),"\n",(0,r.jsxs)(s.h2,{id:"源码导读",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#源码导读",children:"#"}),"源码导读"]}),"\n","\n",(0,r.jsx)(o.ZB,{href:"https://github.com/bytedance/flowgram.ai/tree/main/packages/materials/form-materials/src/effects/listen-ref-schema-change"}),"\n",(0,r.jsx)(s.p,{children:"使用 CLI 命令可以复制源代码到本地："}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-highlighted",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",children:(0,r.jsx)(s.code,{className:"language-bash",children:(0,r.jsxs)(s.span,{className:"line",children:[(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"npx"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" @flowgram.ai/cli@latest"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" materials"}),(0,r.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" effects/listen-ref-schema-change"})]})})})}),"\n",(0,r.jsxs)(s.h3,{id:"目录结构",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#目录结构",children:"#"}),"目录结构"]}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.pre,{className:"shiki css-variables has-highlighted",style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0",children:(0,r.jsxs)(s.code,{className:"language-txt",children:[(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{children:"listen-ref-schema-change/"})}),"\n",(0,r.jsx)(s.span,{className:"line",children:(0,r.jsx)(s.span,{children:"└── index.ts          # 主入口文件"})})]})})}),"\n",(0,r.jsxs)(s.h3,{id:"工作原理",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#工作原理",children:"#"}),"工作原理"]}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"监听值变化"}),"：监听 ",(0,r.jsx)(s.code,{children:"DataEvent.onValueInitOrChange"})," 事件"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"类型检查"}),"：检查值是否为 ",(0,r.jsx)(s.code,{children:"ref"})," 类型"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"路径跟踪"}),"：使用 ",(0,r.jsx)(s.code,{children:"trackByKeyPath"})," 跟踪引用路径"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Schema 转换"}),"：将 AST 类型转换为 JSON Schema"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"回调触发"}),"：当引用的类型发生变化时触发回调"]}),"\n"]}),"\n",(0,r.jsxs)(s.h3,{id:"使用到的-flowgram-api",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#使用到的-flowgram-api",children:"#"}),"使用到的 flowgram API"]}),"\n",(0,r.jsxs)(s.h4,{id:"flowgramaivariable-core",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#flowgramaivariable-core",children:"#"}),"@flowgram.ai/variable-core"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"getNodeScope(context.node).available.trackByKeyPath"}),": 跟踪指定路径的值变化，当路径对应的值发生变化时触发回调。"]}),"\n"]}),"\n",(0,r.jsxs)(s.h4,{id:"flowgramaijson-schema",children:[(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#flowgramaijson-schema",children:"#"}),"@flowgram.ai/json-schema"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"JsonSchemaUtils.astToSchema"}),": 将 AST 类型节点转换为 JSON Schema 对象。"]}),"\n"]})]})}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}={...(0,i.a)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}c.__RSPRESS_PAGE_META={},c.__RSPRESS_PAGE_META["zh%2Fmaterials%2Feffects%2Flisten-ref-schema-change.mdx"]={toc:[{id:"案例演示",text:"案例演示",depth:2},{id:"基本使用",text:"基本使用",depth:3},{id:"api-介绍",text:"API 介绍",depth:2},{id:"listenrefschemachange",text:"listenRefSchemaChange",depth:3},{id:"参数",text:"参数",depth:4},{id:"回调函数参数",text:"回调函数参数",depth:4},{id:"支持值类型",text:"支持值类型",depth:3},{id:"源码导读",text:"源码导读",depth:2},{id:"目录结构",text:"目录结构",depth:3},{id:"工作原理",text:"工作原理",depth:3},{id:"使用到的-flowgram-api",text:"使用到的 flowgram API",depth:3},{id:"flowgramaivariable-core",text:"@flowgram.ai/variable-core",depth:4},{id:"flowgramaijson-schema",text:"@flowgram.ai/json-schema",depth:4}],title:"listenRefSchemaChange",headingTitle:"listenRefSchemaChange",frontmatter:{}}},368449:function(e,s,n){n.d(s,{w:()=>h});var r=n(110239),i=n(908600),l=n(789220),o=n(916530),a=n(132288);let c=i.lazy(()=>Promise.all([n.e("386212"),n.e("133914"),n.e("227692"),n.e("838147"),n.e("933451"),n.e("942362"),n.e("254129"),n.e("135691"),n.e("46854"),n.e("378665"),n.e("449983")]).then(n.bind(n,129148)).then(e=>({default:e.InputsValues}))),h=()=>(0,r.jsx)(a.y,{filterEndNode:!0,formMeta:{effect:{"inputsValues.*":(0,l.V)(e=>{let{name:s,schema:n,form:r,formValues:i}=e;r.setValueIn("log",`${r.getValueIn("log")||""}${s}: ${JSON.stringify(n)}
`)})},render:()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.p,{}),(0,r.jsx)(o.gNt,{name:"inputsValues",defaultValue:{a:{type:"ref",content:["start_0","str"]}},children:e=>{let{field:s}=e;return(0,r.jsx)(c,{value:s.value,onChange:e=>s.onChange(e)})}}),(0,r.jsx)("br",{}),(0,r.jsx)(o.gNt,{name:"log",defaultValue:"When schema updated, log changes:\n",children:e=>{let{field:s}=e;return(0,r.jsx)("pre",{style:{width:500,padding:4,background:"#f5f5f5",fontSize:12,whiteSpace:"pre-wrap"},children:s.value})}})]})}})},132288:function(e,s,n){n.d(s,{p:()=>o,y:()=>a});var r=n(110239),i=n(908600);let l=i.lazy(()=>Promise.all([n.e("386212"),n.e("133914"),n.e("227692"),n.e("933451"),n.e("254129"),n.e("428647"),n.e("135691"),n.e("46854"),n.e("690536")]).then(n.bind(n,654296)).then(e=>({default:e.FreeFormMetaStoryBuilder}))),o=i.lazy(()=>Promise.all([n.e("386212"),n.e("133914"),n.e("227692"),n.e("933451"),n.e("254129"),n.e("428647"),n.e("135691"),n.e("46854"),n.e("690536")]).then(n.bind(n,654296)).then(e=>({default:e.FormHeader}))),a=e=>(0,r.jsx)("div",{style:{position:"relative",height:e.height||400},children:(0,r.jsx)(l,{...e})})},789220:function(e,s,n){n.d(s,{V:()=>l});var r=n(937643),i=n(950454);let l=e=>[{event:i.zEJ.onValueInitOrChange,effect:s=>{let{context:n,value:l}=s;if((null==l?void 0:l.type)!=="ref")return()=>null;let o=(0,i.k6H)(n.node).available.trackByKeyPath((null==l?void 0:l.content)||[],n=>{e({...s,schema:r.Kz.astToSchema(n)})},{selector:e=>null==e?void 0:e.type});return()=>{o.dispose()}}}]}}]);