"use strict";(self.webpackChunk_flowgram_ai_docs=self.webpackChunk_flowgram_ai_docs||[]).push([["442348"],{649414:function(e,t,i){i.r(t),i.d(t,{fieldWrapperCss:()=>f,DEFAULT_FORM_META:()=>g,FieldTitle:()=>h,DEFAULT_DEMO_REGISTRY:()=>p,DEFAULT_INITIAL_DATA:()=>u,defaultInitialDataTs:()=>y,fieldWrapperTs:()=>v,Editor:()=>m,FieldWrapper:()=>c});var r=i(110239),s=i(640898),o=i(908600),n=i(330893),a=i(773898),l=i(653378),d=i(461249);let h=d.ZP.div`
  padding-bottom: 4px;
`;i(100282);let c=e=>{let{required:t,title:i,children:s,error:o,note:n}=e;return(0,r.jsxs)("div",{className:"field-wrapper",children:[(0,r.jsxs)("div",{className:"field-title",children:[i,n?(0,r.jsx)("p",{className:"field-note",children:n}):null,t?(0,r.jsx)("span",{className:"required",children:"*"}):null]}),s,(0,r.jsx)("p",{className:"error-message",children:o}),n?(0,r.jsx)("br",{}):null]})},g={render:()=>(0,r.jsxs)("div",{className:"demo-node-content",children:[(0,r.jsx)("div",{className:"demo-node-title",children:"Basic Node"}),(0,r.jsx)(s.gNt,{name:"name",children:e=>{var t,i;let{field:s,fieldState:o}=e;return(0,r.jsx)(c,{required:!0,title:"Name",error:null==(i=o.errors)||null==(t=i[0])?void 0:t.message,children:(0,r.jsx)(l.Input,{size:"small",...s})})}}),(0,r.jsx)(s.gNt,{name:"city",children:e=>{var t,i;let{field:s,fieldState:o}=e;return(0,r.jsx)(c,{required:!0,title:"City",error:null==(i=o.errors)||null==(t=i[0])?void 0:t.message,children:(0,r.jsx)(l.Input,{size:"small",...s})})}})]}),defaultValues:{name:"Tina",city:"Hangzhou"},validateTrigger:s.C$T.onChange,validate:{name:e=>{let{value:t}=e;if(!t)return"Name is required"},city:e=>{let{value:t}=e;if(!t)return"City is required"}}},p={type:"custom",meta:{},defaultPorts:[{type:"output"},{type:"input"}],formMeta:g},u={nodes:[{id:"node_0",type:"custom",meta:{position:{x:400,y:0}}}],edges:[]};i(530371),i(259283);let m=e=>{let{registries:t,initialData:i}=e,l=(e=>{let{registries:t=[p],initialData:i=u}=e;return(0,o.useMemo)(()=>({background:!0,readonly:!1,initialData:i,nodeRegistries:t,getNodeDefaultRegistry:e=>({type:e,meta:{defaultExpanded:!0},formMeta:{render:()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.gNt,{name:"title",children:e=>{let{field:t}=e;return(0,r.jsx)("div",{className:"demo-free-node-title",children:t.value})}}),(0,r.jsx)("div",{className:"demo-free-node-content",children:(0,r.jsx)(s.gNt,{name:"content",children:(0,r.jsx)("input",{})})})]})}}),materials:{renderDefaultNode:e=>{let{form:t}=(0,s.PVB)();return(0,r.jsx)(s.IxS,{className:"demo-free-node",node:e.node,children:null==t?void 0:t.render()})}},onContentChange(e,t){},nodeEngine:{enable:!0},history:{enable:!0,enableChangeNode:!0},onInit:e=>{},onAllLayersRendered(e){e.document.fitView(!1)},onDispose(){console.log("---- Playground Dispose ----")},plugins:()=>[(0,n.qP)({disableLayer:!0,canvasStyle:{canvasWidth:182,canvasHeight:102,canvasPadding:50,canvasBackground:"rgba(245, 245, 245, 1)",canvasBorderRadius:10,viewportBackground:"rgba(235, 235, 235, 1)",viewportBorderRadius:4,viewportBorderColor:"rgba(201, 201, 201, 1)",viewportBorderWidth:1,viewportBorderDashLength:2,nodeColor:"rgba(255, 255, 255, 1)",nodeBorderRadius:2,nodeBorderWidth:.145,nodeBorderColor:"rgba(6, 7, 9, 0.10)",overlayColor:"rgba(255, 255, 255, 0)"}}),(0,a.Z)({edgeColor:"#00B2B2",alignColor:"#00B2B2",edgeLineWidth:1,alignLineWidth:1,alignCrossWidth:8})]}),[])})({registries:t,initialData:i});return(0,r.jsx)(s.EhS,{...l,children:(0,r.jsx)("div",{className:"demo-free-container",children:(0,r.jsx)("div",{className:"demo-free-layout",children:(0,r.jsx)(s.R6T,{className:"demo-free-editor"})})})})},v=`import React from 'react';

import './field-wrapper.css';

interface FieldWrapperProps {
  required?: boolean;
  title?: string;
  children?: React.ReactNode;
  error?: string;
  note?: string;
}

export const FieldWrapper = ({ required, title, children, error, note }: FieldWrapperProps) => (
  <div className="field-wrapper">
    <div className="field-title">
      {title}
      {note ? <p className="field-note">{note}</p> : null}
      {required ? <span className="required">*</span> : null}
    </div>
    {children}
    <p className="error-message">{error}</p>
    {note ? <br /> : null}
  </div>
);
`,f=`.error-message {
  color: #f5222d !important;
}

.required {
  color: #f5222d !important;
  padding-left: 4px
}

.field-wrapper {
  width: 100%;
  margin-bottom: 12px;
}

.field-title {
  margin-bottom: 6px;
}

.field-note{
  color: #a3a0a0 !important;
  font-size: 12px;
  margin: 6px 0;
}
`,y=`import { WorkflowJSON } from '@flowgram.ai/free-layout-editor';

export const DEFAULT_INITIAL_DATA: WorkflowJSON = {
  nodes: [
    {
      id: 'node_0',
      type: 'custom',
      meta: {
        position: { x: 400, y: 0 },
      },
    },
  ],
  edges: [],
};`},262922:function(e,t,i){i.d(t,{M:()=>r});let r=i(908600).lazy(()=>Promise.resolve().then(i.bind(i,649414)).then(e=>({default:e.Editor})))},954272:function(e,t,i){i.d(t,{g:()=>a});var r=i(110239),s=i(908600),o=i(744260),n=i(173567);let a=e=>{let{files:t,children:i,previewStyle:a,dependencies:l,editorStyle:d,codeInRight:h}=e,c=(0,o.e7)(),g=(0,s.useMemo)(()=>c?"dark":"light",[c]),p=h?(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(n.sp,{style:{width:"100%",display:"flex"},children:[(0,r.jsx)("div",{className:"light-mode preview-ediitor",style:a,children:i}),(0,r.jsx)(n._V,{style:d,readOnly:!0})]})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.sp,{style:a,children:(0,r.jsx)("div",{className:"light-mode preview-ediitor",children:i})}),(0,r.jsx)(n.sp,{children:(0,r.jsx)(n._V,{style:d,readOnly:!0})})]});return(0,r.jsx)(n.oT,{template:"react",theme:g,customSetup:{dependencies:l},files:{...t,"/App.js":{code:"",hidden:!0}},onChange:e=>{console.log("debugger",e)},children:p})}},773898:function(e,t,i){i.d(t,{Z:()=>x});var r=i(893740),s=i(9163),o=i(832176),n=i(336330),a=i(579962),l=i(908600),d=Object.defineProperty,h=Object.getOwnPropertyDescriptor,c=(e,t,i,r)=>{for(var s,o=r>1?void 0:r?h(t,i):t,n=e.length-1;n>=0;n--)(s=e[n])&&(o=(r?s(t,i,o):s(o))||o);return r&&o&&d(t,i,o),o},g={enableEdgeSnapping:!0,edgeThreshold:7,enableGridSnapping:!1,gridSize:20,enableMultiSnapping:!0,enableOnlyViewportSnapping:!0,edgeColor:"#4E40E5",alignColor:"#4E40E5",edgeLineWidth:2,alignLineWidth:2,alignCrossWidth:16},p=(e,t)=>void 0!==e&&void 0!==t&&1e-5>Math.abs(e-t),u=(e,t)=>void 0!==e&&void 0!==t&&t-e>1e-5,m=(e,t)=>void 0!==e&&void 0!==t&&e-t>1e-5,v=(e,t)=>p(e,t)||u(e,t),f=e=>"number"==typeof e&&!isNaN(e),y=class{init(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options={...g,...e},this.mountListener()}dispose(){this.disposers.forEach(e=>e.dispose())}get disabled(){return this._disabled}disable(){this._disabled||(this._disabled=!0,this.clear())}enable(){this._disabled&&(this._disabled=!1,this.clear())}mountListener(){let e=this.dragService.registerPosAdjuster(e=>{let{selectedNodes:t,position:i}=e,r=!this.options.enableMultiSnapping&&1!==t.length;return this._disabled||!this.options.enableEdgeSnapping||r?{x:0,y:0}:this.snapping({targetNodes:t,position:i})}),t=this.dragService.onNodesDrag(e=>{"onDragEnd"===e.type&&!this._disabled&&(this.options.enableGridSnapping&&this.gridSnapping({targetNodes:e.nodes,gridSize:this.options.gridSize}),this.options.enableEdgeSnapping&&this.clear())});this.disposers.push(e,t)}snapping(e){let{targetNodes:t,position:i}=e,r=this.getBounds(t),s=new o.Ae(i.x,i.y,r.width,r.height),n=this.getSnapNodeRects({targetNodes:t,targetRect:s}),{alignOffset:a,alignRects:l,alignSpacing:d}=this.calcAlignOffset({targetRect:s,alignThreshold:this.options.edgeThreshold,snapNodeRects:n}),{snapOffset:h,snapEdgeLines:c}=this.calcSnapOffset({targetRect:s,edgeThreshold:this.options.edgeThreshold,snapNodeRects:n}),g={x:h.x||a.x,y:h.y||a.y},p=new o.Ae(i.x+g.x,i.y+g.y,s.width,s.height);return this.snapEmitter.fire({snapRect:p,snapEdgeLines:c,alignRects:l,alignSpacing:d}),g}calcSnapOffset(e){let{snapNodeRects:t,edgeThreshold:i,targetRect:r}=e,s=this.getSnapLines({snapNodeRects:t}),o=s.horizontal.find(e=>v(Math.abs(e.y-r.top),i)),n=s.horizontal.find(e=>v(Math.abs(e.y-r.bottom),i)),a=s.vertical.find(e=>v(Math.abs(e.x-r.left),i)),l=s.vertical.find(e=>v(Math.abs(e.x-r.right),i)),d=s.midHorizontal.find(e=>v(Math.abs(e.y-r.center.y),i)),h=s.midVertical.find(e=>v(Math.abs(e.x-r.center.x),i)),c=null==o?void 0:o.y,g=f(null==n?void 0:n.y)?n.y-r.height:void 0,u=null==a?void 0:a.x,m=f(null==l?void 0:l.x)?l.x-r.width:void 0,y=f(null==d?void 0:d.y)?d.y-r.height/2:void 0,b=f(null==h?void 0:h.x)?h.x-r.width/2:void 0,x={x:b??u??m??r.x,y:y??c??g??r.y};return{snapOffset:{x:x.x-r.x,y:x.y-r.y},snapEdgeLines:{top:p(c,x.y)?o:void 0,bottom:p(g,x.y)?n:void 0,left:p(u,x.x)?a:void 0,right:p(m,x.x)?l:void 0,midVertical:p(b,x.x)?h:void 0,midHorizontal:p(y,x.y)?d:void 0}}}gridSnapping(e){let{gridSize:t,targetNodes:i}=e,r=this.getBounds(i),s=e=>Math.round(e/t)*t,o={x:s(r.x),y:s(r.y)},n={x:o.x-r.x,y:o.y-r.y};i.forEach(e=>this.updateNodePositionWithOffset({node:e,offset:n}))}clear(){this.snapEmitter.fire({snapEdgeLines:{},snapRect:o.Ae.EMPTY,alignRects:{top:[],bottom:[],left:[],right:[]},alignSpacing:{}})}getSnapLines(e){let{snapNodeRects:t}=e,i=[],r=[],s=[],o=[];return t.forEach(e=>{let t=e.rect,n=t.center,a={y:t.top,sourceNodeId:e.id},l={y:t.bottom,sourceNodeId:e.id},d={x:t.left,sourceNodeId:e.id},h={x:t.right,sourceNodeId:e.id},c={y:n.y,sourceNodeId:e.id},g={x:n.x,sourceNodeId:e.id};i.push(a,l),r.push(d,h),s.push(c),o.push(g)}),{horizontal:i,vertical:r,midHorizontal:s,midVertical:o}}getAvailableNodes(e){var t;let{targetNodes:i,targetRect:r}=e,s=r.center,o=(null==(t=i[0].parent)?void 0:t.id)??this.document.root.id,n=i.map(e=>e.id);return n.push(a.Sy.ROOT),this.nodes.filter(e=>{var t;return(null==(t=e.parent)?void 0:t.id)===o}).filter(e=>!n.includes(e.id)).sort((e,t)=>{let i=e.getData(a.eG).bounds.center,r=t.getData(a.eG).bounds.center;return Math.abs(i.x-s.x)+Math.abs(i.y-s.y)-(Math.abs(r.x-s.x)+Math.abs(r.y-s.y))})}viewRect(){let{width:e,height:t,scrollX:i,scrollY:r,zoom:s}=this.playgroundConfig.config;return new o.Ae(i/s,r/s,e/s,t/s)}getSnapNodeRects(e){let t=this.getAvailableNodes(e),i=this.viewRect();return t.map(e=>{var t;let r={id:e.id,rect:e.getData(a.eG).bounds,entity:e};if(!this.options.enableOnlyViewportSnapping||(null==(t=e.parent)?void 0:t.flowNodeType)!==a.Sy.ROOT||o.Ae.intersects(i,r.rect))return r}).filter(Boolean)}get nodes(){return this.entityManager.getEntities(n.CT)}getBounds(e){return 0===e.length?o.Ae.EMPTY:o.Ae.enlarge(e.map(e=>e.getData(a.eG).bounds))}updateNodePositionWithOffset(e){let{node:t,offset:i}=e,s=t.getData(r.VO),o={x:s.position.x+i.x,y:s.position.y+i.y};s.update({position:o}),this.document.layout.updateAffectedTransform(t)}calcAlignOffset(e){let t,i,r,s,o,n,{snapNodeRects:a,targetRect:l,alignThreshold:d}=e,h=this.getAlignRects({targetRect:l,snapNodeRects:a}),c=this.calcAlignSpacing({targetRect:l,alignRects:h});if(c.top){let e=h.top[0].rect.bottom+c.top;v(Math.abs(l.top-e),d)?t=e:c.top=void 0}if(c.bottom){let e=h.bottom[0].rect.top-c.bottom;u(Math.abs(l.bottom-e),d)?i=e-l.height:c.bottom=void 0}if(c.left){let e=h.left[0].rect.right+c.left;v(Math.abs(l.left-e),d)?r=e:c.left=void 0}if(c.right){let e=h.right[0].rect.left-c.right;v(Math.abs(l.right-e),d)?s=e-l.width:c.right=void 0}if(c.midHorizontal){let e=h.left[0].rect.right+c.midHorizontal;v(Math.abs(l.left-e),d)?n=e:c.midHorizontal=void 0}if(c.midVertical){let e=h.top[0].rect.bottom+c.midVertical;v(Math.abs(l.top-e),d)?o=e:c.midVertical=void 0}let g={x:n??r??s??l.x,y:o??t??i??l.y};return{alignOffset:{x:g.x-l.x,y:g.y-l.y},alignRects:h,alignSpacing:c}}calcAlignSpacing(e){var t,i,r,s;let{targetRect:o,alignRects:n}=e,a=this.getDirectionAlignSpacing({rects:n.top,isHorizontal:!1}),l=this.getDirectionAlignSpacing({rects:n.bottom,isHorizontal:!1}),d=this.getDirectionAlignSpacing({rects:n.left,isHorizontal:!0}),h=this.getDirectionAlignSpacing({rects:n.right,isHorizontal:!0});return{top:a,bottom:l,left:d,right:h,midHorizontal:this.getMidAlignSpacing({rectA:null==(t=n.left[0])?void 0:t.rect,rectB:null==(i=n.right[0])?void 0:i.rect,targetRect:o,isHorizontal:!0}),midVertical:this.getMidAlignSpacing({rectA:null==(r=n.top[0])?void 0:r.rect,rectB:null==(s=n.bottom[0])?void 0:s.rect,targetRect:o,isHorizontal:!1})}}getAlignRects(e){let{targetRect:t,snapNodeRects:i}=e,r=[],s=[],o=[],n=[];return i.forEach(e=>{let i=e.rect,{isVerticalIntersection:a,isHorizontalIntersection:l,isIntersection:d}=this.intersection(i,t);!d&&(a?m(i.center.y,t.center.y)?s.push({rect:i,sourceNodeId:e.id}):r.push({rect:i,sourceNodeId:e.id}):l&&(m(i.center.x,t.center.x)?n.push({rect:i,sourceNodeId:e.id}):o.push({rect:i,sourceNodeId:e.id})))}),{top:r,bottom:s,left:o,right:n}}getMidAlignSpacing(e){let{rectA:t,rectB:i,targetRect:r,isHorizontal:s}=e;if(!t||!i)return;let{isVerticalIntersection:o,isHorizontalIntersection:n,isIntersection:a}=this.intersection(t,i);if(!a){if(s&&n&&!o)return(Math.min(Math.abs(t.left-i.right),Math.abs(t.right-i.left))-r.width)/2;else if(!s&&o&&!n)return(Math.min(Math.abs(t.top-i.bottom),Math.abs(t.bottom-i.top))-r.height)/2}}getDirectionAlignSpacing(e){let{rects:t,isHorizontal:i}=e;if(t.length<2)return;let r=t[0].rect,s=t[1].rect,{isVerticalIntersection:o,isHorizontalIntersection:n,isIntersection:a}=this.intersection(r,s);if(!a){if(i&&n&&!o)return Math.min(Math.abs(r.left-s.right),Math.abs(r.right-s.left));else if(!i&&o&&!n)return Math.min(Math.abs(r.top-s.bottom),Math.abs(r.bottom-s.top))}}intersection(e,t){let i=u(e.left,t.right)&&m(e.right,t.left),r=u(e.top,t.bottom)&&m(e.bottom,t.top);return{isHorizontalIntersection:r,isVerticalIntersection:i,isIntersection:r&&i}}constructor(){this.disposers=[],this.snapEmitter=new o.Q5,this.onSnap=this.snapEmitter.event,this._disabled=!1}};c([(0,s.f3)(n.L4)],y.prototype,"document",2),c([(0,s.f3)(r.v2)],y.prototype,"entityManager",2),c([(0,s.f3)(n.iw)],y.prototype,"dragService",2),c([(0,s.f3)(r.ER)],y.prototype,"playgroundConfig",2),y=c([(0,s.b2)()],y);var b=class extends r.mh{onReady(){this.node.style.zIndex="9999",this.toDispose.pushAll([this.service.onSnap(e=>{this.edgeLines=this.calcEdgeLines(e),this.alignLines=this.calcAlignLines(e),this.render()})])}render(){return l.createElement(l.Fragment,null,this.alignLines.length>0&&l.createElement("div",{className:"workflow-snap-align-lines"},this.renderAlignLines()),this.edgeLines.length>0&&l.createElement("div",{className:"workflow-snap-edge-lines"},this.renderEdgeLines()))}onZoom(e){this.node.style.transform=`scale(${e})`}renderEdgeLines(){return this.edgeLines.map(e=>{let{className:t,sourceNode:i,top:r,left:s,width:o,height:n,dashed:a}=e,d=`${t}-${i}-${r}-${s}-${o}-${n}`,h=o<n,c=`${this.options.edgeLineWidth}px ${a?"dashed":"solid"} ${this.options.edgeColor}`;return l.createElement("div",{className:`workflow-snap-edge-line ${t}`,"data-testid":"sdk.workflow.canvas.snap.edgeLine","data-snap-line-id":d,"data-snap-line-source-node":i,key:d,style:{top:r,left:s,width:o,height:n,position:"absolute",borderLeft:h?c:"none",borderTop:h?"none":c}})})}renderAlignLines(){return this.alignLines.map(e=>{let t=`${e.className}-${e.sourceNode}-${e.top}-${e.left}-${e.width}-${e.height}`,i=m(e.width,e.height),r=this.options.alignLineWidth,s=this.options.alignCrossWidth,o=i?e.top-r/2:e.top,n=i?e.left:e.left-r/2;return l.createElement("div",{className:`workflow-snap-align-line ${e.className}`,"data-testid":"sdk.workflow.canvas.snap.alignLine","data-snap-line-id":t,"data-snap-line-source-node":e.sourceNode,key:t,style:{position:"absolute"}},l.createElement("div",{style:{position:"absolute",top:o,left:n,width:i?e.width:r,height:i?r:e.height,backgroundColor:this.options.alignColor}}),l.createElement("div",{style:{position:"absolute",top:i?o-(s-r)/2:o,left:i?n:n-(s-r)/2,width:i?r:s,height:i?s:r,backgroundColor:this.options.alignColor}}),l.createElement("div",{style:{position:"absolute",top:i?o-(s-r)/2:o+e.height-r,left:i?n+e.width-r:n-(s-r)/2,width:i?r:s,height:i?s:r,backgroundColor:this.options.alignColor}}))})}calcEdgeLines(e){let{alignRects:t,snapRect:i,snapEdgeLines:r}=e,s=[],o=this.directionFullAlign({alignRects:t.top,targetRect:i,isVertical:!0}),n=this.directionFullAlign({alignRects:t.bottom,targetRect:i,isVertical:!0}),l=this.directionFullAlign({alignRects:t.left,targetRect:i,isVertical:!1}),d=this.directionFullAlign({alignRects:t.right,targetRect:i,isVertical:!1});if(o){let e=o.rect.top,t=n?i.bottom-i.height/2-e:i.bottom-e,r={top:e,width:this.options.edgeLineWidth,height:t};s.push({className:"edge-full-top-left",sourceNode:o.sourceNodeId,left:i.left,...r}),s.push({className:"edge-full-top-right",sourceNode:o.sourceNodeId,left:i.right,...r}),s.push({className:"edge-full-top-mid",sourceNode:o.sourceNodeId,left:i.left+i.width/2,dashed:!0,...r})}if(n){let e=o?i.top+i.height/2:i.top,t=n.rect.bottom-e,r={top:e,width:this.options.edgeLineWidth,height:t};s.push({className:"edge-full-bottom-left",sourceNode:n.sourceNodeId,left:i.left,...r}),s.push({className:"edge-full-bottom-right",sourceNode:n.sourceNodeId,left:i.right,...r}),s.push({className:"edge-full-bottom-mid",sourceNode:n.sourceNodeId,left:i.left+i.width/2,dashed:!0,...r})}if(l){let e=l.rect.left,t=d?i.right-i.width/2-e:i.right-e,r={left:e,width:t,height:this.options.edgeLineWidth};s.push({className:"edge-full-left-top",sourceNode:l.sourceNodeId,top:i.top,...r}),s.push({className:"edge-full-left-bottom",sourceNode:l.sourceNodeId,top:i.bottom,...r}),s.push({className:"edge-full-left-mid",sourceNode:l.sourceNodeId,top:i.top+i.height/2,dashed:!0,...r})}if(d){let e=l?i.left+i.width/2:i.left,t=d.rect.right-e,r={left:e,width:t,height:this.options.edgeLineWidth};s.push({className:"edge-full-right-top",sourceNode:d.sourceNodeId,top:i.top,...r}),s.push({className:"edge-full-right-bottom",sourceNode:d.sourceNodeId,top:i.bottom,...r}),s.push({className:"edge-full-right-mid",sourceNode:d.sourceNodeId,top:i.top+i.height/2,dashed:!0,...r})}let h=Object.entries(r).map(e=>{let[t,r]=e;if(!r)return;let s=this.document.getNode(r.sourceNodeId);if(!s)return;let h=s.getData(a.eG).bounds;if(f(r.x)){let e=Math.min(h.top,i.top),s=Math.max(h.bottom,i.bottom),a=r.x,l=this.options.edgeLineWidth,d={className:`edge-snapped-${t}`,sourceNode:r.sourceNodeId,top:e,left:a,width:l,height:s-e,dashed:"midVertical"===t},c=e===h.top;if(c&&o||!c&&n)return;return d}if(f(r.y)){let e=Math.min(h.left,i.left),s=Math.max(h.right,i.right),o=r.y,n=this.options.edgeLineWidth,a={className:`edge-snapped-${t}`,sourceNode:r.sourceNodeId,top:o,left:e,width:s-e,height:n,dashed:"midHorizontal"===t},c=e===h.left;if(c&&l||!c&&d)return;return a}}).filter(Boolean);return s.push(...h),s}directionFullAlign(e){let{alignRects:t,targetRect:i,isVertical:r}=e,s=-1;for(let e=0;e<t.length;e++){var o;let n=t[e],a=(null==(o=t[e-1])?void 0:o.rect)??i;if(!this.rectFullAlign(n.rect,a,r))break;s=e}return t[s]}rectFullAlign(e,t,i){return i?p(e.left,t.left)&&p(e.right,t.right):p(e.top,t.top)&&p(e.bottom,t.bottom)}calcAlignLines(e){let{alignRects:t,alignSpacing:i,snapRect:r}=e,s=this.calcDirectionAlignLines({alignRects:t.top,targetRect:r,isVertical:!0,spacing:i.midVertical??i.top}),o=this.calcDirectionAlignLines({alignRects:t.bottom,targetRect:r,isVertical:!0,spacing:i.midVertical??i.bottom});return[...s,...o,...this.calcDirectionAlignLines({alignRects:t.left,targetRect:r,isVertical:!1,spacing:i.midHorizontal??i.left}),...this.calcDirectionAlignLines({alignRects:t.right,targetRect:r,isVertical:!1,spacing:i.midHorizontal??i.right})]}calcDirectionAlignLines(e){let{alignRects:t,targetRect:i,isVertical:r,spacing:s}=e,o=[];if(!s)return o;for(let e=0;e<t.length;e++){var n;let a=t[e],l=a.rect,d=(null==(n=t[e-1])?void 0:n.rect)??i;if(!p(r?Math.min(Math.abs(d.top-l.bottom),Math.abs(d.bottom-l.top)):Math.min(Math.abs(d.left-l.right),Math.abs(d.right-l.left)),s))break;if(r){let e=this.calcHorizontalIntersectionCenter(l,i);o.push({className:"align-vertical",sourceNode:a.sourceNodeId,top:Math.min(l.bottom,d.bottom),left:e,width:1,height:s})}else{let e=this.calcVerticalIntersectionCenter(l,i);o.push({className:"align-horizontal",sourceNode:a.sourceNodeId,top:e,left:Math.min(l.right,d.right),width:s,height:1})}}return o}calcVerticalIntersectionCenter(e,t){return(Math.max(e.top,t.top)+Math.min(e.bottom,t.bottom))/2}calcHorizontalIntersectionCenter(e,t){return(Math.max(e.left,t.left)+Math.min(e.right,t.right))/2}constructor(){super(...arguments),this.node=o.xF.createDivWithClass("gedit-playground-layer gedit-flow-snap-layer"),this.edgeLines=[],this.alignLines=[]}};b.type="WorkflowSnapLayer",c([(0,s.f3)(n.L4)],b.prototype,"document",2),c([(0,s.f3)(y)],b.prototype,"service",2),b=c([(0,s.b2)()],b);var x=(0,r.M1)({onBind(e){let{bind:t}=e;t(y).toSelf().inSingletonScope()},onInit(e,t){let i={...g,...t};e.playground.registerLayer(b,i),e.get(y).init(i)},onDispose(e){e.get(y).dispose()}})},330893:function(e,t,i){i.d(t,{Zd:()=>b,qP:()=>N});var r,s=i(908600),o=i(893740),n=i(661881),a=i(9163),l=i(832176),d=i(579962),h=Object.defineProperty,c=Object.getOwnPropertyDescriptor,g=(e,t,i,r)=>{for(var s,o=r>1?void 0:r?c(t,i):t,n=e.length-1;n>=0;n--)(s=e[n])&&(o=(r?s(t,i,o):s(o))||o);return r&&o&&h(t,i,o),o},p=r||(r={});let u=e=>e.width>0&&e.height>0;p.clear=e=>{let{canvas:t,context:i}=e;i.clearRect(0,0,t.width,t.height)},p.backgroundColor=e=>{let{canvas:t,context:i,color:r}=e;i.fillStyle=r,i.fillRect(0,0,t.width,t.height)},p.rectangle=e=>{let{context:t,rect:i,color:r}=e;u(i)&&(t.fillStyle=r,t.fillRect(i.x,i.y,i.width,i.height))},p.roundRectangle=e=>{let{context:t,rect:i,color:r,radius:s,borderColor:o,borderDashLength:n,borderWidth:a=0}=e,{x:l,y:d,width:h,height:c}=i;u(i)&&(t.beginPath(),t.moveTo(l+s,d),t.lineTo(l+h-s,d),t.quadraticCurveTo(l+h,d,l+h,d+s),t.lineTo(l+h,d+c-s),t.quadraticCurveTo(l+h,d+c,l+h-s,d+c),t.lineTo(l+s,d+c),t.quadraticCurveTo(l,d+c,l,d+c-s),t.lineTo(l,d+s),t.quadraticCurveTo(l,d,l+s,d),t.closePath(),t.fillStyle=r,t.fill(),o&&a>0&&(t.strokeStyle=o,t.lineWidth=a,n?t.setLineDash([n,n]):t.setLineDash([]),t.stroke(),t.setLineDash([])))},p.overlay=e=>{let{canvas:t,context:i,offset:r,scale:s,rect:o,color:n}=e;u(o)&&(i.fillStyle=n,i.fillRect(0,0,t.width,(o.y+r.y)*s),i.fillRect(0,(o.y+o.height+r.y)*s,t.width,t.height-(o.y+o.height+r.y)*s),i.fillRect(0,(o.y+r.y)*s,(o.x+r.x)*s,o.height*s),i.fillRect((o.x+o.width+r.x)*s,(o.y+r.y)*s,t.width-(o.x+o.width+r.x)*s,o.height*s))};var m={canvasWidth:250,canvasHeight:250,canvasPadding:50,canvasBackground:"rgba(242, 243, 245, 1)",canvasBorderRadius:10,viewportBackground:"rgba(255, 255, 255, 1)",viewportBorderRadius:4,viewportBorderColor:"rgba(6, 7, 9, 0.10)",viewportBorderWidth:1,viewportBorderDashLength:void 0,nodeColor:"rgba(0, 0, 0, 0.10)",nodeBorderRadius:2,nodeBorderWidth:.145,nodeBorderColor:"rgba(6, 7, 9, 0.10)",overlayColor:"rgba(255, 255, 255, 0.55)"},v={scale:.7,opacity:1,translateX:15,translateY:15},f={canvasStyle:m,canvasClassName:"gedit-minimap-canvas",enableDisplayAllNodes:!1,activeThrottleTime:0,inactiveThrottleTime:24},y=class{init(e){this.options=f,Object.assign(this.options,e),this.setThrottle(this.options.inactiveThrottleTime),this.initStyle()}dispose(){this.toDispose.dispose(),this.initialized=!1,this.activated=!1,this.removeEventListeners()}setVisible(e){this.visible=e}setActivate(e){e!==this.activated&&(e||!this.isDragging)&&(this.activated=e,e?(this.setThrottle(this.options.activeThrottleTime),this.addEventListeners()):(this.setThrottle(this.options.inactiveThrottleTime),this.removeEventListeners()),this.render(),this.onActiveCallbacks.forEach(t=>t(e)))}initStyle(){if(!this.initialized)return;let{canvasClassName:e,canvasStyle:t}=this.options;this.canvas.className=e,this.style={...m,...t},this.canvas.width=this.style.canvasWidth,this.canvas.height=this.style.canvasHeight,this.canvas.style.borderRadius=this.style.canvasBorderRadius?`${this.style.canvasBorderRadius}px`:"unset"}setThrottle(e){this.render=(0,n.Z)(this._render,e)}_render(){if(!this.initialized||!this.visible)return;let e=this.createRenderContext();this.renderCanvas(e)}createRenderContext(){let{canvas:e,context2D:t}=this,i=this.transformVisibles.map(e=>e.bounds),r=this.viewRect(),s=this.renderRect(i).withPadding({top:this.style.canvasPadding,bottom:this.style.canvasPadding,left:this.style.canvasPadding,right:this.style.canvasPadding}),o=l.Ae.enlarge([r,s]),{scale:n,offset:a}=this.calculateScaleAndOffset({canvasRect:o});return{canvas:e,context2D:t,nodeRects:i,canvasRect:o,viewRect:r,renderRect:s,scale:n,offset:a}}renderCanvas(e){let{canvas:t,context2D:i,nodeRects:s,viewRect:o,scale:n,offset:a}=e;r.clear({canvas:t,context:i}),r.backgroundColor({canvas:t,context:i,color:this.style.canvasBackground}),r.roundRectangle({context:i,rect:this.rectOnCanvas({rect:o,scale:n,offset:a}),color:this.style.viewportBackground,radius:this.style.viewportBorderRadius}),s.forEach(e=>{r.roundRectangle({context:i,rect:this.rectOnCanvas({rect:e,scale:n,offset:a}),color:this.style.nodeColor,radius:this.style.nodeBorderRadius,borderWidth:this.style.nodeBorderWidth,borderColor:this.style.nodeBorderColor})}),r.roundRectangle({context:i,rect:this.rectOnCanvas({rect:o,scale:n,offset:a}),color:"rgba(255, 255, 255, 0)",radius:this.style.viewportBorderRadius,borderColor:this.style.viewportBorderColor,borderWidth:this.style.viewportBorderWidth,borderDashLength:this.style.viewportBorderDashLength}),r.overlay({canvas:t,context:i,offset:a,scale:n,rect:o,color:this.style.overlayColor})}calculateScaleAndOffset(e){let{canvasRect:t}=e,{width:i,height:r}=this.canvas,s=Math.min(i/t.width,r/t.height),o=t.width*s,n=t.height*s,a={x:(i-o)/2/s-t.x,y:(r-n)/2/s-t.y};return{scale:s,offset:a}}get transformVisibles(){return this.document.getRenderDatas(d.eG,!1).filter(e=>{let t=e.entity;return!t.hidden&&(t.flowNodeType===d.Sy.ROOT?void 0:!!this.options.enableDisplayAllNodes||!t.parent||t.parent.flowNodeType===d.Sy.ROOT||void 0)})}renderRect(e){return l.Ae.enlarge(e)}viewRect(){let{width:e,height:t,scrollX:i,scrollY:r,zoom:s}=this.playgroundConfig.config;return new l.Ae(i/s,r/s,e/s,t/s)}rectOnCanvas(e){let{rect:t,scale:i,offset:r}=e;return new l.Ae((t.x+r.x)*i,(t.y+r.y)*i,t.width*i,t.height*i)}isPointInRect(e){let{point:t,rect:i}=e;return t.x>=i.x&&t.x<=i.x+i.width&&t.y>=i.y&&t.y<=i.y+i.height}addEventListeners(){this.canvas.addEventListener("wheel",this.handleWheel),this.canvas.addEventListener("mousedown",this.handleStartDrag),this.canvas.addEventListener("touchstart",this.handleStartDrag,{passive:!1}),this.canvas.addEventListener("mousemove",this.handleCursor)}removeEventListeners(){this.canvas.removeEventListener("wheel",this.handleWheel),this.canvas.removeEventListener("mousedown",this.handleStartDrag),this.canvas.removeEventListener("touchstart",this.handleStartDrag),this.canvas.removeEventListener("mousemove",this.handleCursor)}isMouseInCanvas(e){let t=this.canvas.getBoundingClientRect(),{clientX:i,clientY:r}=o.UJ.getEventCoord(e);return i>=t.left&&i<=t.right&&r>=t.top&&r<=t.bottom}updateScrollPosition(e,t){let{scrollX:i,scrollY:r,zoom:s}=this.playgroundConfig.config;this.playgroundConfig.updateConfig({scrollX:i+e*s,scrollY:r+t*s})}constructor(){this.visible=!1,this.onActive=e=>(this.onActiveCallbacks.add(e),{dispose:()=>{this.onActiveCallbacks.delete(e)}}),this.render=this._render,this.handleWheel=e=>{},this.handleStartDrag=e=>{o.UJ.preventDefault(e),e.stopPropagation();let{viewRect:t,scale:i,offset:r}=this.createRenderContext(),s=this.canvas.getBoundingClientRect(),{clientX:n,clientY:a}=o.UJ.getEventCoord(e),l={x:n-s.left,y:a-s.top},d=this.rectOnCanvas({rect:t,scale:i,offset:r});this.isPointInRect({point:l,rect:d})&&(this.isDragging=!0,this.dragStart=l,document.addEventListener("mousemove",this.handleDragging),document.addEventListener("mouseup",this.handleEndDrag),document.addEventListener("touchmove",this.handleDragging,{passive:!1}),document.addEventListener("touchend",this.handleEndDrag),document.addEventListener("touchcancel",this.handleEndDrag))},this.handleDragging=e=>{if(!this.isDragging||!this.dragStart)return;o.UJ.preventDefault(e),e.stopPropagation();let{scale:t}=this.createRenderContext(),i=this.canvas.getBoundingClientRect(),{clientX:r,clientY:s}=o.UJ.getEventCoord(e),n=r-i.left,a=s-i.top,l=(n-this.dragStart.x)/t,d=(a-this.dragStart.y)/t;this.updateScrollPosition(l,d),this.dragStart={x:n,y:a},this.render()},this.handleEndDrag=e=>{o.UJ.preventDefault(e),e.stopPropagation(),document.removeEventListener("mousemove",this.handleDragging),document.removeEventListener("mouseup",this.handleEndDrag),document.removeEventListener("touchmove",this.handleDragging),document.removeEventListener("touchend",this.handleEndDrag),document.removeEventListener("touchcancel",this.handleEndDrag),this.isDragging=!1,this.dragStart=void 0,this.setActivate(this.isMouseInCanvas(e))},this.handleCursor=e=>{if(!this.activated)return;let{viewRect:t,scale:i,offset:r}=this.createRenderContext(),s=this.canvas.getBoundingClientRect(),o={x:e.clientX-s.left,y:e.clientY-s.top},n=this.rectOnCanvas({rect:t,scale:i,offset:r});this.isPointInRect({point:o,rect:n})?this.canvas.style.cursor="grab":this.canvas.style.cursor="default"},this.canvas=document.createElement("canvas"),this.context2D=this.canvas.getContext("2d"),this.initialized=!!this.context2D,this.onActiveCallbacks=new Set,this.toDispose=new l.K4,this.render=this._render,this.activated=!1,this.isDragging=!1}};g([(0,a.f3)(d.pQ)],y.prototype,"document",2),g([(0,a.f3)(o.ER)],y.prototype,"playgroundConfig",2),y=g([(0,a.b2)()],y);var b=e=>{let{panelStyles:t={},containerStyles:i={},inactiveStyle:r={}}=e,n={...v,...r},a=(0,o.KU)(),l=e.service||(null==a?void 0:a.get(y)),d=(0,s.useRef)(null),[h,c]=(0,s.useState)(!1);(0,s.useEffect)(()=>{let e=d.current;e&&l.canvas&&e.appendChild(l.canvas);let t=l.onActive(e=>{c(e)});return l.setVisible(!0),l.render(),()=>{t.dispose(),l.setVisible(!1)}},[l]);let g=h?1:n.scale,p=h?1:n.opacity,u=h?0:n.translateX,m=h?0:n.translateY;return s.createElement("div",{className:"minimap-container",style:{position:"fixed",right:30,bottom:70,transition:"all 0.3s ease",transform:`scale(${g}) translate(${u}px, ${m}px)`,opacity:p,transformOrigin:"bottom right",...i}},s.createElement("div",{className:"minimap-panel",style:{display:"flex",width:"100%",height:"100%",borderRadius:"10px",backgroundColor:"rgba(255, 255, 255, 1)",border:"0.572px solid rgba(6, 7, 9, 0.10)",overflow:"hidden",boxShadow:"0px 2.289px 6.867px 0px rgba(0, 0, 0, 0.08), 0px 4.578px 13.733px 0px rgba(0, 0, 0, 0.04)",boxSizing:"border-box",padding:8,...t},"data-flow-editor-selectable":"false",ref:d,onMouseEnter:()=>{l.setActivate(!0)},onMouseLeave:()=>{l.setActivate(!1)},onTouchStartCapture:()=>{l.setActivate(!0)},onTouchEndCapture:()=>{l.setActivate(!1)}}))},x=class extends o.mh{render(){return this.documentTransformer.loading||(this.documentTransformer.refresh(),this.service.render(),this.options.disableLayer)?s.createElement(s.Fragment,null):s.createElement(b,{service:this.service,panelStyles:this.options.panelStyles,containerStyles:this.options.containerStyles,inactiveStyle:this.options.inactiveStyle})}constructor(){super(),this.className="gedit-minimap-layer gedit-playground-layer",this.node=l.xF.createDivWithClass(this.className),this.node.style.zIndex="9999"}};x.type="FlowMinimapLayer",g([(0,a.f3)(y)],x.prototype,"service",2),g([(0,o.aI)(d.GA,d.eG)],x.prototype,"transformDatas",2),g([(0,o.O0)(o.ER)],x.prototype,"configEntity",2),g([(0,o.O0)(d.Vl)],x.prototype,"documentTransformer",2),x=g([(0,a.b2)()],x);var N=(0,o.M1)({onBind:e=>{let{bind:t}=e;t(y).toSelf().inSingletonScope()},onInit:(e,t)=>{e.playground.registerLayer(x,t),e.get(y).init(t)},onDispose:e=>{e.get(y).dispose()}})}}]);